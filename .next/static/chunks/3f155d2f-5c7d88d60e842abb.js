"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[805],{8381:function(e,t,n){n.d(t,{$:function(){return tV},A:function(){return tr},B:function(){return t7},C:function(){return tQ},D:function(){return t6},E:function(){return t8},F:function(){return te},G:function(){return t3},H:function(){return n2},I:function(){return tk},J:function(){return e_},K:function(){return tw},L:function(){return tl},M:function(){return eU},N:function(){return eJ},O:function(){return ts},P:function(){return nk},Q:function(){return nw},R:function(){return tX},S:function(){return rI},T:function(){return rg},U:function(){return t5},V:function(){return rR},W:function(){return rj},X:function(){return rW},Y:function(){return eG},Z:function(){return tx},_:function(){return nF},a:function(){return nj},a0:function(){return tm},a1:function(){return tf},a2:function(){return t$},a3:function(){return nl},a4:function(){return ty},a5:function(){return na},a6:function(){return nr},a7:function(){return tz},a8:function(){return np},a9:function(){return nu},aA:function(){return re},aB:function(){return rn},aC:function(){return n7},aD:function(){return rL},aE:function(){return ru},aF:function(){return rE},aG:function(){return rp},aH:function(){return rf},aI:function(){return rT},aJ:function(){return ra},aK:function(){return oN},aM:function(){return tb},aa:function(){return nd},ab:function(){return ny},ac:function(){return ng},ad:function(){return tW},ae:function(){return ni},af:function(){return no},ag:function(){return nm},ah:function(){return tD},ai:function(){return tB},aj:function(){return eH},ak:function(){return eX},al:function(){return tO},am:function(){return ez},an:function(){return tI},ao:function(){return nR},ap:function(){return nN},aq:function(){return nS},au:function(){return ln},av:function(){return n1},aw:function(){return eA},ax:function(){return of},ay:function(){return lt},az:function(){return i5},b:function(){return tJ},c:function(){return tj},d:function(){return tZ},e:function(){return tP},f:function(){return tc},g:function(){return eq},h:function(){return tu},i:function(){return tv},j:function(){return ta},k:function(){return e2},l:function(){return eV},m:function(){return tg},n:function(){return function e(t,n,r,i,l,a){let s=rb(n);if("form"===t.kind)try{return l(t,s,r,i)}catch(e){throw new ry(e,r,t)}if("child"===t.kind)return null;if("conditional"===t.kind){if(void 0===s)return nF(t);try{if("object"!=typeof s||null===s||rx(s))throw new nN("Must be an object");for(let e of Object.keys(s))if("discriminant"!==e&&"value"!==e)throw new nN(`Must only contain keys "discriminant" and "value", not "${e}"`)}catch(e){throw new ry(e,r,t)}let n=e(t.discriminant,s.discriminant,r.concat("discriminant"),i.concat("discriminant"),l,a);return{discriminant:n,value:e(t.values[n],s.value,r.concat("value"),i.concat("value"),l,a)}}if("object"===t.kind){void 0===s&&(s={});try{if("object"!=typeof s||null===s||rx(s))throw new nN("Must be an object");let e=new Set(Object.keys(t.fields));for(let t of Object.keys(s))if(!e.has(t))throw new nN(`Key on object value "${t}" is not allowed`)}catch(e){throw new ry(e,r,t)}let n={},o=[];for(let d of Object.keys(t.fields)){let c=s[d];try{let o=e(t.fields[d],c,r.concat(d),i.concat(d),l,a);n[d]=o}catch(e){o.push(e)}}if(o.length)throw AggregateError(o);return n}if("array"===t.kind){if(void 0===s)return[];try{if(!rx(s))throw new nN("Must be an array")}catch(e){throw new ry(e,r,t)}let n=[];try{if(a){let e=rv(t,s,r);void 0!==e&&n.push(e)}return s.map((o,s)=>{try{let n=s.toString();if(t.slugField&&"object"==typeof o&&null!==o&&!rx(o)){let e;if("object"!==t.element.kind)throw Error("slugField on array fields requires the an object field element");let r=t.element.fields[t.slugField];if(!r)throw Error(`slugField "${t.slugField}" does not exist on object field`);if("form"!==r.kind)throw Error(`slugField "${t.slugField}" is not a form field`);if("slug"!==r.formKind)throw Error(`slugField "${t.slugField}" is not a slug field`);try{e=r.parse(rb(o[t.slugField]),void 0)}catch(e){throw AggregateError([e])}n=r.serializeWithSlug(e).slug}return e(t.element,o,r.concat(s),i.concat(n),l,a)}catch(e){n.push(e)}})}finally{if(n.length)throw AggregateError(n)}}(0,o.vE)(t)}},o:function(){return tp},p:function(){return tF},q:function(){return e3},r:function(){return tM},s:function(){return tY},t:function(){return rk},u:function(){return eI},v:function(){return tC},w:function(){return tS},x:function(){return tU},y:function(){return tK},z:function(){return t9}});var r=n(4689),i=n(7911),l=n(9538),o=n(3276),a=n(9606),s=n(2265),d=n(1926),c=n(7437),u=n(248),h=n(9050),p=n(8624),f=n(1706),m=n(7981),g=n(7185),v=n(1163),y=n(4291),b=n(246),x=n(3374),k=n(372),j=n(9490),w=n(8868),M=n(7659),N=n(9591),S=n(4043),R=n(1468),C=n(2888),P=n(902),E=n(4483),L=n(6125),$=n(5479),F=n(5705),Y=n(7237),O=n(9986),K=n(5148),T=n(3674),B=n(8955),z=n(6728),I=n(3444),A=n(1338),D=n(4578),W=n(6566),q=n(2218),_=n(9028),H=n(8250),J=n(3050),V=n(3413),U=n(4663),Z=n(5893),X=n(3230),G=n(9019),Q=n(6646),ee=n(3676),et=n(318),en=n(3726),er=n(4551),ei=n(7081),el=n(2668),eo=n(6473),ea=n(6356),es=n(2717),ed=n(7176),ec=n(4360),eu=n(7463),eh=n(3438),ep=n(1489),ef=n(464),em=n(7775),eg=n(3306),ev=n(4280),ey=n(4851),eb=n(7416),ex=n(3881),ek=n(8733),ej=n(8229),ew=n(4575),eM=n(2758);n(424),n(3854),n(9109),n(5836),n(1417),n(3025),n(3023),n(9003),n(8171),n(7263),n(8401);var eN=n(3178),eS=n(5522),eR=n(5712),eC=n(9758),eP=n(2186),eE=n(5874),eL=n(5986),e$=n.n(eL),eF=n(6049),eY=n(7415),eO=n(8796),eK=n(6933),eT=n.n(eK);let eB=(0,s.createContext)(null);function ez(e){return(0,c.jsx)(eB.Provider,{value:e.router,children:e.children})}function eI(){let e=(0,s.useContext)(eB);if(null==e)throw Error("useRouter must be used within a RouterProvider");return e}function eA(e){return e.replace(/^\.?\/+/,"").replace(/\/*$/,"")}let eD=/\/\*\*?(?:$|\/)/;function eW(e,t){var n;let r=e.collections[t],i=null!==(n=r.path)&&void 0!==n?n:`${t}/*/`;if(!eD.test(i))throw Error(`Collection path must end with /* or /** or include /*/ or /**/ but ${t} has ${i}`);return i}function eq(e,t){let n=eW(e,t),r=eA(n.replace(/\*\*?.*$/,""));return r}function e_(e,t){var n;let r=e.collections[t];return eQ(null!==(n=r.format)&&void 0!==n?n:"yaml",r.schema,eW(e,t))}function eH(e,t){var n,r;let i=e.singletons[t];return eQ(null!==(n=i.format)&&void 0!==n?n:"yaml",i.schema,null!==(r=i.path)&&void 0!==r?r:`${t}/`)}function eJ(e,t,n){let r=eq(e,t),i=eZ(e,t);return`${r}/${n}${i}`}function eV(e,t){return`${e}${"index"===t.dataLocation?"/index":""}${eG(t)}`}function eU(e,t){let n=eW(e,t);return n.includes("**")?"**":"*"}function eZ(e,t){let n=eW(e,t),r=eA(n.replace(/^[^*]+\*\*?/,""));return r?`/${r}`:""}function eX(e,t){var n,r;if(null!==(n=e.singletons[t].path)&&void 0!==n&&n.includes("*"))throw Error(`Singleton paths cannot include * but ${t} has ${e.singletons[t].path}`);return eA(null!==(r=e.singletons[t].path)&&void 0!==r?r:t)}function eG(e){return e.contentField?e.contentField.config.contentExtension:"."+e.data}function eQ(e,t,n){var r;let i;let l=n.endsWith("/")?"index":"outer";if("string"==typeof e)return{dataLocation:l,contentField:void 0,data:e};if(e.contentField){let n=t[e.contentField];(0,o.hu)((null==n?void 0:n.kind)==="form",`${e.contentField} is not a form field`),(0,o.hu)("content"===n.formKind,`${e.contentField} is not a content field`),i={key:e.contentField,config:n}}return{data:null!==(r=e.data)&&void 0!==r?r:"yaml",contentField:i,dataLocation:l}}async function e0(e){let t=await crypto.subtle.digest("SHA-1",e),n="";for(let e of new Uint8Array(t))n+=e.toString(16).padStart(2,"0");return n}let e1=new TextEncoder;function e3(e){let t=e1.encode("blob "+e.length+"\x00"),n=new Uint8Array(t.byteLength+e.byteLength);return n.set(t,0),n.set(e,t.byteLength),e0(n)}function e2(e,t){let n=t.split("/"),r=e.get(n[0]);for(let e of n.slice(1)){if(!r||!r.children)return;r=r.children.get(e)}return r}function e6(e,t){let n=e;for(let e of t.split("/")){n.has(e)||n.set(e,new Map);let t=n.get(e);(0,o.hu)(t instanceof Map,"expected tree"),n=t}return n}function e8(e){return e.replace(/.*\//,"")}function e4(e){return e.replace(/\/[^/]+$/,"")}let e9=new Uint8Array([32]),e7=new Uint8Array([0]),e5=e1.encode("tree ");function te(e){let t=[...e].map(([e,t])=>({name:e,sha:t.entry.sha,mode:t.entry.mode}));t.sort((e,t)=>{let n="040000"===e.mode?e.name+"/":e.name,r="040000"===t.mode?t.name+"/":t.name;return n===r?0:n<r?-1:1});let n=t.flatMap(e=>{let t=e1.encode(e.mode.replace(/^0/,"")),n=e1.encode(e.name),r=function(e){let t=new Uint8Array(e.length/2);for(var n=0;n<t.byteLength;n+=1){let r=2*n;t[n]=parseInt(e.slice(r,r+2),16)}return t}(e.sha);return[t,e9,n,e7,r]});return e0(function(e){let t=e.reduce((e,t)=>e+t.byteLength,0),n=new Uint8Array(t),r=0;for(let t of e)n.set(t,r),r+=t.byteLength;return n}([e5,e1.encode(n.reduce((e,t)=>e+t.byteLength,0).toString()),e7,...n]))}async function tt(e,t){let n=await te(t);return{path:e,mode:"040000",type:"tree",sha:n}}async function tn(e,t){let n="sha"in t?t.sha:await e3(t);return{path:e,mode:"100644",type:"blob",sha:n,size:t.byteLength}}async function tr(e,t){var n;let r=null!==(n=await ti(e,function(e){let t=new Map;for(let n of e.deletions){let e=e6(t,e4(n));e.set(e8(n),"delete")}for(let n of e.additions){let e=e6(t,e4(n.path));e.set(e8(n.path),n.contents)}return t}(t),[]))&&void 0!==n?n:new Map;return{entries:function e(t){return[...t.values()].flatMap(t=>t.children?[t.entry,...e(t.children)]:[t.entry])}(r),sha:await te(null!=r?r:new Map)}}async function ti(e,t,n){let r=new Map(e);for(let[e,o]of t){if("delete"===o&&r.delete(e),o instanceof Map){var i,l;let t=null!==(i=null===(l=r.get(e))||void 0===l?void 0:l.children)&&void 0!==i?i:new Map,a=await ti(t,o,n.concat(e));if(void 0===a){r.delete(e);continue}let s=await tt(n.concat(e).join("/"),a);r.set(e,{entry:s,children:a})}if(o instanceof Uint8Array||"object"==typeof o&&"sha"in o){let t=await tn(n.concat(e).join("/"),o);r.set(e,{entry:t})}}if(0!==r.size)return r}let tl=Symbol("loading");function to(e){return e&&"function"==typeof e.then}function ta(e){let[t,n]=(0,s.useState)({kind:"loading"}),r=t,i=(0,s.useMemo)(()=>{try{let t=e();return{kind:"result",result:t}}catch(e){return{kind:"error",error:e}}},[e]),l=(0,s.useMemo)(()=>"error"===i.kind&&("error"!==t.kind||t.error!==i.error)?{kind:"error",error:i.error}:"result"!==i.kind||to(i.result)||i.result===tl||"loaded"===t.kind&&t.data===i.result?void 0:{kind:"loaded",data:i.result},[i,t]);return l&&l!==t&&(r=l,n(l)),(0,s.useEffect)(()=>{if("result"===i.kind&&to(i.result)){n({kind:"loading"});let e=!0;return i.result.then(t=>{t!==tl&&e&&n({kind:"loaded",data:t})},t=>{e&&n({kind:"error",error:t})}),()=>{e=!1}}},[i]),r}function ts(e){let t=Object.entries(e);for(let[,e]of t)if("error"===e.kind)return{kind:"error",error:e.error};for(let[,e]of t)if("loading"===e.kind)return{kind:"loading"};return{kind:"loaded",data:Object.fromEntries(t.map(([e,t])=>[e,t.data]))}}function td(e){let t=new Set;return!function e(t,n,r){if(!r.has(t)){if(r.add(t),"array"===t.kind)return e(t.element,n,r);if("child"!==t.kind){if("form"===t.kind){if("asset"===t.formKind&&void 0!==t.directory&&n.add(eA(t.directory)),"content"===t.formKind&&void 0!==t.directories)for(let e of t.directories)n.add(eA(e));return}if("object"===t.kind){for(let i of Object.values(t.fields))e(i,n,r);return}if("conditional"===t.kind){for(let i of Object.values(t.values))e(i,n,r);return}(0,o.vE)(t)}}}(e,t,new Set),t}function tc(e,t,n,r){let i=[eA(t)];"outer"===r.dataLocation&&i.push(eA(t)+eG(r));let l=void 0===n?"":`/${n}`;for(let t of td(e))i.push(t+l);return i}function tu(e,t){return e.map(e=>{var n;return null===(n=e2(t,e))||void 0===n?void 0:n.entry.sha}).join("-")}var th={version:"0.1.4"};function tp(e,t){return{...t,kind:"object",fields:e}}function tf(e,t){let{singular:n,plural:r=n+"s",inclusive:i=!0}=t,l=1===e?n:r;return i?`${e} ${l}`:l}function tm(e){return Object.entries(e).map(([e,t])=>({key:e,...t}))}function tg(e){return"github"===e.storage.kind}function tv(e){return"local"===e.storage.kind}function ty(e){var t;if("cloud"!==e.storage.kind)return!1;if(!(null!==(t=e.cloud)&&void 0!==t&&t.project)||!e.cloud.project.includes("/"))throw Error(`Keystatic is set to \`storage: { kind: 'cloud' }\` but \`cloud.project\` isn't set.
config({
  storage: { kind: 'cloud' },
  cloud: { project: 'team/project' },
})`);return!0}function tb(e){let[t,n]=e.cloud.project.split("/");return{team:t,project:n}}function tx(e){return`https://github.com/${e.mainOwner}/${e.mainRepo}`}function tk(e,t){let n=t[e.slugField],r=e.schema[e.slugField];if("form"!==r.kind||"slug"!==r.formKind)throw Error("slugField is not a slug field");return r.serializeWithSlug(n).slug}function tj(e,t,n){var r,i,l;let o=e.collections[t],a=tp(o.schema),s=e_(e,t),d=eG(s),c=eU(e,t),u=eq(e,t),h=null!==(r=null===(i=e2(n,u))||void 0===i?void 0:i.children)&&void 0!==r?r:new Map,p=[],f=[...td(a)],m=eZ(e,t),g=new Map(h);if("**"===c){let e=(t,n)=>{for(let[r,i]of t)i.children?(g.set(`${n}${r}`,i),e(i.children,`${n}${r}/`)):g.set(`${n}${r}`,i)};e(h,"")}for(let[r,i]of g)if("index"===s.dataLocation){let i=e2(n,eJ(e,t,r));if(!(null!=i&&null!==(l=i.children)&&void 0!==l&&l.has("index"+d)))continue;p.push({key:tu([i.entry.path,...f.map(e=>`${e}/${r}`)],n),slug:r})}else{if(m){let l=e2(n,eJ(e,t,r)+d);if(!l||l.children)continue;p.push({key:tu([i.entry.path,eJ(e,t,r),...f.map(e=>`${e}/${r}`)],n),slug:r})}if(i.children||!r.endsWith(d))continue;let l=r.slice(0,-d.length);p.push({key:tu([i.entry.path,eJ(e,t,l),...f.map(e=>`${e}/${l}`)],n),slug:l})}return p}let tw="https://api.keystatic.cloud",tM={"x-keystatic-version":th.version},tN=new TextEncoder;async function tS(e,t){if(!ty(t))throw Error("Not a cloud config");let n=(0,a.kZ)(crypto.getRandomValues(new Uint8Array(32)),!0),r=(0,a.kZ)(new Uint8Array(await crypto.subtle.digest("SHA-256",tN.encode(n))),!0),i=(0,a.kZ)(crypto.getRandomValues(new Uint8Array(32)),!0);localStorage.setItem("keystatic-cloud-state",JSON.stringify({state:i,from:e,code_verifier:n}));let l=new URL(`${tw}/oauth/authorize`);l.searchParams.set("state",i),l.searchParams.set("client_id",t.cloud.project),l.searchParams.set("redirect_uri",`${window.location.origin}/keystatic/cloud/oauth/callback`),l.searchParams.set("response_type","code"),l.searchParams.set("code_challenge_method","S256"),l.searchParams.set("code_challenge",r),l.searchParams.set("keystatic_version",th.version),window.location.href=l.toString()}let tR=D.z.object({token:D.z.string(),validUntil:D.z.number().transform(e=>new Date(e))});function tC(e){if("undefined"==typeof document)return null;if("github"===e.storage.kind){let e=(0,A.parse)(document.cookie),t=e["keystatic-gh-access-token"];return t?{accessToken:t}:null}if("cloud"===e.storage.kind){let e;let t=localStorage.getItem("keystatic-cloud-access-token");try{e=tR.parse(JSON.parse(t))}catch(e){return null}return!e||e.validUntil<new Date?null:{accessToken:e.token}}return null}async function tP(e){let t=tC(e);if("github"===e.storage.kind&&!t){try{let e=await fetch("/api/keystatic/github/refresh-token",{method:"POST"});if(200===e.status){let e=(0,A.parse)(document.cookie),t=e["keystatic-gh-access-token"];if(t)return{accessToken:t}}}catch{}return null}return t}let tE=B.ZP`
  fragment SidebarFooter_viewer on User {
    id
    name
    login
    avatarUrl
    databaseId
  }
`,tL=(0,s.createContext)(void 0);function t$(){return(0,s.useContext)(tL)}function tF(e){if("string"==typeof e){let[t,n]=e.split("/");return{owner:t,name:n}}return e}function tY(e){return"string"==typeof e?e:`${e.owner}/${e.name}`}function tO(e){if("string"==typeof e&&!e.includes("/"))throw Error(`Invalid repo config: ${e}. It must be in the form owner/name`);if("object"==typeof e){if(!e.owner&&!e.name)throw Error("Invalid repo config: owner and name are missing");if(!e.owner)throw Error("Invalid repo config: owner is missing");if(!e.name)throw Error("Invalid repo config: name is missing")}}function tK(){return(0,s.useContext)(tT)}let tT=(0,s.createContext)(()=>{throw Error("SetTreeShaContext not set")});function tB(e){let[t,n]=(0,s.useState)("initial"),r=ta((0,s.useCallback)(()=>(function(e){if(t2.has(e))return t2.get(e);let t=fetch("/api/keystatic/tree",{headers:{"no-cors":"1"}}).then(e=>e.json()).then(async e=>t6(e));return t2.set(e,t),t})(t),[t])),i=(0,s.useMemo)(()=>({default:r,current:r,merged:ts({default:r,current:r})}),[r]),l=(0,s.useMemo)(()=>"loaded"!==i.merged.kind?{collections:new Map,singletons:new Set}:ne(e.config,i.merged.data),[i,e.config]);return(0,c.jsx)(tT.Provider,{value:n,children:(0,c.jsx)(t_.Provider,{value:l,children:(0,c.jsx)(tH.Provider,{value:i,children:e.children})})})}let tz=(0,s.createContext)(null);function tI(e){let[t]=(0,z.aM)({query:"github"===e.config.storage.kind?t3:tQ,variables:"github"===e.config.storage.kind?tF(e.config.storage.repo):{name:"repo-name",owner:"repo-owner"}});return(0,c.jsx)(tz.Provider,{value:t,children:(0,c.jsx)(tL.Provider,{value:t.data&&"viewer"in t.data?t.data.viewer:void 0,children:e.children})})}let tA=new Set(["WRITE","ADMIN","MAINTAIN"]);function tD(e){var t,n,r,i,l,a,d,u,h,p,f,m,g,v,y,b;let x=eI(),{data:k,error:j}=(0,s.useContext)(tz),w=null==k?void 0:k.repository;w&&"viewerPermission"in w&&w.viewerPermission&&!tA.has(w.viewerPermission)&&"forks"in w&&(w=null!==(y=null===(b=w.forks)||void 0===b||null===(b=b.nodes)||void 0===b?void 0:b[0])&&void 0!==y?y:w);let M=null===(t=w)||void 0===t||null===(t=t.refs)||void 0===t||null===(t=t.nodes)||void 0===t?void 0:t.find(e=>{var t;return(null==e?void 0:e.name)===(null===(t=w)||void 0===t||null===(t=t.defaultBranchRef)||void 0===t?void 0:t.name)}),N=null===(n=w)||void 0===n||null===(n=n.refs)||void 0===n||null===(n=n.nodes)||void 0===n?void 0:n.find(t=>(null==t?void 0:t.name)===e.currentBranch),S=null!==(r=null==M?void 0:M.target.tree.oid)&&void 0!==r?r:null,R=null!==(i=null==N?void 0:N.target.tree.oid)&&void 0!==i?i:null,C=null!==(l=null==N||null===(a=N.target)||void 0===a?void 0:a.oid)&&void 0!==l?l:null,P=t4(S,e.config),E=t4(R,e.config),L=(0,s.useMemo)(()=>({default:P,current:E,merged:ts({default:P,current:E})}),[E,P]),$=(0,s.useMemo)(()=>"loaded"!==L.merged.kind?{collections:new Map,singletons:new Set}:ne(e.config,L.merged.data),[L,e.config]);(0,s.useEffect)(()=>{var t,n;(null==j||null===(t=j.response)||void 0===t?void 0:t.status)===401&&(tg(e.config)?window.location.href=`/api/keystatic/github/login?from=${x.params.join("/")}`:tS(x.params.join("/"),e.config)),!(null!==(n=w)&&void 0!==n&&n.id)&&null!=j&&j.graphQLErrors.some(e=>{var t,n;return(null==e||null===(t=e.originalError)||void 0===t?void 0:t.type)==="NOT_FOUND"||(null==e||null===(n=e.originalError)||void 0===n?void 0:n.type)==="FORBIDDEN"})&&(window.location.href=`/api/keystatic/github/repo-not-found?from=${x.params.join("/")}`)},[j,x,null===(d=w)||void 0===d?void 0:d.id,e.config]);let F=(0,s.useMemo)(()=>{var e,t;return{baseCommit:C||"",repositoryId:null!==(e=null===(t=w)||void 0===t?void 0:t.id)&&void 0!==e?e:""}},[C,null===(u=w)||void 0===u?void 0:u.id]),Y=(0,s.useMemo)(()=>{var t,n,r,i,l,a,s,d,c,u,h,p;return{defaultBranch:null!==(t=null===(n=w)||void 0===n||null===(n=n.defaultBranchRef)||void 0===n?void 0:n.name)&&void 0!==t?t:"",currentBranch:e.currentBranch,baseCommit:C||"",repositoryId:null!==(r=null===(i=w)||void 0===i?void 0:i.id)&&void 0!==r?r:"",allBranches:null!==(l=null===(a=w)||void 0===a||null===(a=a.refs)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.map(e=>null==e?void 0:e.name).filter(o.$K))&&void 0!==l?l:[],hasPullRequests:!!(null!=N&&N.associatedPullRequests.totalCount),branchNameToId:new Map(null===(s=w)||void 0===s||null===(s=s.refs)||void 0===s||null===(s=s.nodes)||void 0===s?void 0:s.filter(o.$K).map(e=>[e.name,e.id])),branchNameToBaseCommit:new Map(null===(d=w)||void 0===d||null===(d=d.refs)||void 0===d||null===(d=d.nodes)||void 0===d?void 0:d.flatMap(e=>null!=e&&e.target?[[e.name,e.target.oid]]:[])),mainOwner:null!==(c=null==k||null===(u=k.repository)||void 0===u?void 0:u.owner.login)&&void 0!==c?c:"",mainRepo:null!==(h=null==k||null===(p=k.repository)||void 0===p?void 0:p.name)&&void 0!==h?h:""}},[null===(h=w)||void 0===h||null===(h=h.defaultBranchRef)||void 0===h?void 0:h.name,null===(p=w)||void 0===p?void 0:p.id,null===(f=w)||void 0===f||null===(f=f.refs)||void 0===f?void 0:f.nodes,e.currentBranch,C,null==N?void 0:N.associatedPullRequests.totalCount,null==k||null===(m=k.repository)||void 0===m?void 0:m.owner.login,null==k||null===(g=k.repository)||void 0===g?void 0:g.name]);return(0,c.jsx)(t9.Provider,{value:w&&("cloud"===e.config.storage.kind||"viewerPermission"in w&&null!==(v=w)&&void 0!==v&&v.viewerPermission&&tA.has(w.viewerPermission))?{name:w.name,owner:w.owner.login}:null,children:(0,c.jsx)(tW.Provider,{value:j,children:(0,c.jsx)(t7.Provider,{value:Y,children:(0,c.jsx)(tq.Provider,{value:F,children:(0,c.jsx)(t_.Provider,{value:$,children:(0,c.jsx)(tH.Provider,{value:L,children:e.children})})})})})})}let tW=(0,s.createContext)(void 0),tq=(0,s.createContext)({baseCommit:"",repositoryId:""}),t_=(0,s.createContext)({collections:new Map,singletons:new Set}),tH=(0,s.createContext)({current:{kind:"loading"},default:{kind:"loading"},merged:{kind:"loading"}});function tJ(){return(0,s.useContext)(tH)}function tV(){return(0,s.useContext)(t_)}function tU(){return(0,s.useContext)(tq).baseCommit}function tZ(){return(0,s.useContext)(tq).repositoryId}let tX=B.ZP`
  fragment Ref_base on Ref {
    id
    name
    target {
      __typename
      id
      oid
      ... on Commit {
        tree {
          id
          oid
        }
      }
    }
    associatedPullRequests(states: [OPEN]) {
      totalCount
    }
  }
`,tG=B.ZP`
  fragment Repo_base on Repository {
    id
    owner {
      id
      login
    }
    name
    defaultBranchRef {
      id
      name
    }
    refs(refPrefix: "refs/heads/", first: 100) {
      nodes {
        ...Ref_base
      }
    }
  }
  ${tX}
`,tQ=B.ZP`
  query CloudAppShell($name: String!, $owner: String!) {
    repository(owner: $owner, name: $name) {
      id
      ...Repo_base
    }
  }
  ${tG}
`,t0=B.ZP`
  fragment Repo_ghDirect on Repository {
    id
    ...Repo_base
    viewerPermission
  }
  ${tG}
`,t1=B.ZP`
  fragment Repo_primary on Repository {
    id
    ...Repo_ghDirect
    forks(affiliations: [OWNER], first: 1) {
      nodes {
        ...Repo_ghDirect
      }
    }
  }
  ${t0}
`,t3=B.ZP`
  query GitHubAppShell($name: String!, $owner: String!) {
    repository(owner: $owner, name: $name) {
      id
      ...Repo_primary
    }
    viewer {
      ...SidebarFooter_viewer
    }
  }
  ${t1}
  ${tE}
`,t2=new I.Z({max:40});async function t6(e){let t={entries:new Map(e.map(e=>[e.path,e])),tree:function(e){let t=new Map,n=e=>{var n;if(0===e.length)return t;let r=t.get(e[0]);for(let t of e.slice(1)){if(!r||!r.children)return;r=r.children.get(t)}return null===(n=r)||void 0===n?void 0:n.children};for(let t of e){let e=t.path.split("/"),r=n(e.slice(0,-1));r&&r.set(e[e.length-1],{entry:t,children:"tree"===t.type?new Map:void 0})}return t}(e)},n=await te(t.tree);return t2.set(n,t),t}function t8(e,t){let n=t2.get(e);if(n)return n;let r=tP(t).then(n=>{if(!n)throw Error("Not authorized");return fetch("github"===t.storage.kind?`https://api.github.com/repos/${tY(t.storage.repo)}/git/trees/${e}?recursive=1`:`${tw}/v1/github/trees/${e}`,{headers:{Authorization:`Bearer ${n.accessToken}`,..."cloud"===t.storage.kind?tM:{}}}).then(e=>e.json())}).then(e=>t6(e.tree.map(({url:e,...t})=>t)));return t2.set(e,r),r}function t4(e,t){return ta((0,s.useCallback)(()=>e?t8(e,t):tl,[e,t]))}let t9=(0,s.createContext)(null),t7=(0,s.createContext)({currentBranch:"",allBranches:[],defaultBranch:"",hasPullRequests:!1,branchNameToId:new Map,branchNameToBaseCommit:new Map,mainOwner:"",mainRepo:""});function t5(){return(0,s.useContext)(t7)}function ne(e,t){var n,r;return{collections:new Map(Object.keys(null!==(n=e.collections)&&void 0!==n?n:{}).map(n=>{let r=new Map(tj(e,n,t.current.tree).map(e=>[e.slug,e.key])),i=new Map(tj(e,n,t.default.tree).map(e=>[e.slug,e.key])),l=new Set,o=new Set;for(let[e,t]of r){let n=i.get(e);if(void 0===n){o.add(e);continue}t!==n&&l.add(e)}let a=new Set([...i.keys()].filter(e=>!r.has(e)));return[n,{removed:a,added:o,changed:l,totalCount:r.size}]})),singletons:new Set(Object.keys(null!==(r=e.singletons)&&void 0!==r?r:{}).filter(n=>{var r,i;let l=eX(e,n);return(null===(r=e2(t.current.tree,l))||void 0===r?void 0:r.entry.sha)!==(null===(i=e2(t.default.tree,l))||void 0===i?void 0:i.entry.sha)}))}}let nt=e=>(0,c.jsx)(h.xu,{height:"100%",minHeight:0,minWidth:0,...e}),nn=e=>{let{isDisabled:t,...n}=e;return(0,c.jsx)(nt,{"data-scrollable":!t||void 0,UNSAFE_className:(0,N.iv)({"&[data-scrollable]":{overflowY:"auto",WebkitOverflowScrolling:"touch"}}),...n})};function nr(){return(0,c.jsx)("svg",{viewBox:"0 0 24 24",fill:N.iK.color.foreground.neutral,className:(0,N.iv)({flexShrink:0,height:N.iK.size.scale[250],width:N.iK.size.scale[250],[N.l0.below.tablet]:{height:N.iK.size.icon.regular,width:N.iK.size.icon.regular}}),children:(0,c.jsx)("path",{d:"M13.3982 1.08274C13.8054 1.25951 14.0473 1.68358 13.9923 2.12407L13.1328 9.00003H21C21.388 9.00003 21.741 9.22449 21.9056 9.57588C22.0702 9.92726 22.0166 10.3421 21.7682 10.6402L11.7682 22.6402C11.484 22.9812 11.009 23.0941 10.6018 22.9173C10.1946 22.7405 9.95267 22.3165 10.0077 21.876L10.8672 15H3.00002C2.612 15 2.25901 14.7756 2.09443 14.4242C1.92985 14.0728 1.9834 13.6579 2.2318 13.3598L12.2318 1.35986C12.516 1.01882 12.991 0.905971 13.3982 1.08274Z"})})}let ni=(0,s.createContext)(null);function nl(){let e=(0,s.useContext)(ni);if(!e)throw Error("ConfigContext.Provider not found");return e}let no=(0,s.createContext)({basePath:"/keystatic"});function na(){let e=(0,s.useContext)(no);if(!e)throw Error("AppStateContext.Provider not found");return e}let ns=(0,s.createContext)("mobile"),nd=ns.Provider;function nc(){return(0,s.useContext)(ns)}function nu(e){let[t,n]=(0,s.useState)("mobile");return(0,$.yU)({ref:e,onResize:()=>{n(t=>{let n=e.current;return n?n.offsetWidth>=N.AV.wide?"wide":n.offsetWidth>=N.AV.desktop?"desktop":n.offsetWidth>=N.AV.tablet?"tablet":"mobile":t})}}),t}let nh=(0,s.createContext)(null);function np(){let e=(0,s.useContext)(nh);if(!e)throw Error("useSidebar must be within a SidebarProvider");return e}let nf=(0,o.Nw)(N.AV);function nm(e){let t=(0,N.Gc)(),n=(0,F.d)({defaultOpen:t.includes("desktop")}),r=nf.indexOf(t[0]),i=(0,T.D9)(r)||0;return(0,$.rf)(()=>{i<r&&r>=2?n.open():r<2&&n.close()},[t]),(0,c.jsx)(nh.Provider,{value:n,children:e.children})}function ng(e){return(0,c.jsx)(h.kC,{backgroundColor:"surface",direction:"column",height:"100%",children:(0,c.jsx)(nb,{...e})})}function nv(){let e=nl(),t="Keystatic";return ty(e)&&(t=e.cloud.project),tg(e)&&(t=tY(e.storage.repo)),(0,c.jsxs)(h.kC,{alignItems:"center",borderBottom:"muted",gap:"regular",height:"element.large",paddingX:"xlarge",children:[(0,c.jsx)(nr,{}),(0,c.jsx)(f.xv,{color:"neutralEmphasis",weight:"semibold",children:t})]})}function ny(e){let t=np(),n=eI();(0,$.rf)(()=>{t.close()},[n.href]);let r=(0,s.useRef)(null),{modalProps:i,underlayProps:l}=(0,L.NE)({isDismissable:!0},t,r);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(O.Sm,{...l,isOpen:t.isOpen,zIndex:10}),(0,c.jsxs)("div",{"data-visible":t.isOpen,id:"keystatic-side-panel",ref:r,...i,className:(0,N.iv)({backgroundColor:N.iK.color.background.surface,boxShadow:`${N.iK.size.shadow.large} ${N.iK.color.shadow.regular}`,display:"flex",flexDirection:"column",inset:0,insetInlineEnd:"auto",maxWidth:`calc(100% - ${N.iK.size.element.medium})`,minWidth:N.iK.size.scale[3e3],outline:0,pointerEvents:"none",position:"fixed",transform:"translateX(-100%)",visibility:"hidden",zIndex:10,transition:[(0,N.eR)("transform",{easing:"easeIn",duration:"short"}),(0,N.eR)("visibility",{delay:"regular",duration:0,easing:"linear"})].join(", "),"&[data-visible=true]":{transform:"translateX(0)",transition:(0,N.eR)("transform",{easing:"easeOut"}),pointerEvents:"auto",visibility:"visible"}}),children:[(0,c.jsx)(nv,{}),(0,c.jsx)(nb,{...e}),(0,c.jsx)(L.U4,{onDismiss:t.close})]})]})}function nb(e){let t=nl(),n=(0,w.qb)(M.l),r=eI(),i=(e,{exact:t=!1}={})=>t?e===r.href?"page":void 0:e===r.href||r.href.startsWith(`${e}/`)?"page":void 0,l=Object.entries(t.collections||{}),o=Object.entries(t.singletons||{}),a=tV();return(0,c.jsx)("div",{className:(0,N.iv)({flex:1,overflowY:"auto",paddingBlock:N.iK.size.space.large,paddingInlineEnd:N.iK.size.space.large,WebkitOverflowScrolling:"touch"}),children:(0,c.jsxs)(K.$6,{children:[(0,c.jsx)(K.LY,{href:e.hrefBase,"aria-current":i(e.hrefBase,{exact:!0}),children:n.format("dashboard")}),0!==l.length&&(0,c.jsx)(K.w5,{title:n.format("collections"),children:l.map(([t,n])=>{let r=`${e.hrefBase}/collection/${encodeURIComponent(t)}`,l=a.collections.get(t),o=l?l.changed.size+l.added.size+l.removed.size:0;return(0,c.jsxs)(K.LY,{href:r,"aria-current":i(r),children:[(0,c.jsx)(f.xv,{truncate:!0,title:n.label,children:n.label}),!!o&&(0,c.jsxs)(Y.C,{tone:"accent",marginStart:"auto",children:[(0,c.jsx)(f.xv,{children:o}),(0,c.jsx)(f.xv,{visuallyHidden:!0,children:tf(o,{singular:"change",plural:"changes",inclusive:!1})})]})]},t)})}),0!==o.length&&(0,c.jsx)(K.w5,{title:n.format("singletons"),children:o.map(([t,n])=>{let r=`${e.hrefBase}/singleton/${t}`;return(0,c.jsxs)(K.LY,{href:r,"aria-current":i(r),children:[(0,c.jsx)(f.xv,{truncate:!0,title:n.label,children:n.label}),a.singletons.has(t)&&(0,c.jsx)(h.xu,{backgroundColor:"accentEmphasis",height:"scale.75",width:"scale.75",borderRadius:"full",marginStart:"auto",children:(0,c.jsx)(f.xv,{visuallyHidden:!0,children:"Changed"})})]},t)})})]})})}let nx=(0,s.createContext)({containerWidth:"medium"}),nk=({children:e,containerWidth:t="medium"})=>(0,c.jsx)(nx.Provider,{value:{containerWidth:t},children:(0,c.jsx)(h.kC,{elementType:"main",direction:"column",id:"keystatic-main-panel",flex:!0,height:"100%",minHeight:0,minWidth:0,children:e})}),nj=({children:e})=>{let t=np(),n=(0,s.useRef)(null),{direction:r}=(0,w.bU)(),i=t.isOpen?C.t:R.i;return"rtl"===r&&(i=t.isOpen?E.q:P.q),(0,c.jsx)(h.xu,{borderBottom:"muted",elementType:"header",height:{mobile:"element.large",tablet:"element.xlarge"},flexShrink:0,children:(0,c.jsx)(h.xu,{minHeight:0,minWidth:0,paddingX:{mobile:"medium",tablet:"xlarge",desktop:"xxlarge"},children:(0,c.jsxs)(h.kC,{alignItems:"center",gap:{mobile:"small",tablet:"regular"},height:{mobile:"element.large",tablet:"element.xlarge"},children:[(0,c.jsx)(m.Kk,{prominence:"low","aria-label":"Open app navigation","aria-pressed":t.isOpen,isHidden:t.isOpen?{above:"tablet"}:void 0,onPress:t.toggle,ref:n,UNSAFE_className:(0,N.iv)({marginInlineStart:`calc(${N.iK.size.space.regular} * -1)`}),children:(0,c.jsx)(y.J,{src:i})}),e]})})})},nw=({children:e,isScrollable:t})=>(0,c.jsx)(nn,{isDisabled:!t,children:(0,c.jsx)(nM,{paddingY:"xxlarge",children:e})}),nM=e=>{let{containerWidth:t}=(0,s.useContext)(nx),n="none"===t?void 0:`container.${t}`;return(0,c.jsx)(h.xu,{minHeight:0,minWidth:0,maxWidth:n,paddingX:{mobile:"medium",tablet:"xlarge",desktop:"xxlarge"},...e})};class nN extends Error{constructor(e){super(e),this.name="FieldDataError"}}function nS(e,t,n){if(null===e&&null!=t&&t.isRequired)throw new nN(`${n} is required`)}function nR(e){return{kind:"form",Input:e.Input,defaultValue:e.defaultValue,parse:e.parse,serialize:e.serialize,validate:e.validate,reader:{parse:t=>e.validate(e.parse(t))}}}let nC=new WeakMap,nP=0;function nE(e){return nC.has(e)||nC.set(e,Array.from({length:e.length},n$)),nC.get(e)}function nL(e,t){nC.set(e,t)}function n$(){return(nP++).toString()}let nF=function(e){switch(e.kind){case"form":return e.defaultValue();case"child":return null;case"conditional":{let t=e.discriminant.defaultValue();return{discriminant:t,value:nF(e.values[t.toString()])}}case"object":{let t={};for(let n of Object.keys(e.fields))t[n]=nF(e.fields[n]);return t}case"array":return[]}(0,o.vE)(e)};function nY(e,t){switch(e.kind){case"form":return void 0===t?e.defaultValue():t;case"child":return null;case"conditional":{let n=void 0===t?e.discriminant.defaultValue():t.discriminant;return{discriminant:n,value:nY(e.values[n.toString()],void 0===t?void 0:t.value)}}case"object":{let n={};for(let r of Object.keys(e.fields))n[r]=nY(e.fields[r],void 0===t?void 0:t[r]);return n}case"array":return(null!=t?t:[]).map(t=>nY(e.element,t.value))}(0,o.vE)(e)}function nO(e,t,n){if(void 0===n)return t;switch(e.kind){case"form":return n;case"child":return null;case"conditional":return{discriminant:n.discriminant,value:n.discriminant===t.discriminant?nO(e.values[n.discriminant.toString()],t.value,n.value):nY(e.values[n.discriminant.toString()],n.value)};case"object":{let r={};for(let i of Object.keys(e.fields))r[i]=nO(e.fields[i],t[i],n[i]);return r}case"array":{let r=new Set;for(let e of n)if(void 0!==e.key){if(r.has(e.key))throw Error("Array elements must have unique keys");r.add(e.key)}let i=n.map(e=>{if(void 0!==e.key)return e.key;let t=n$();for(;r.has(t);)t=n$();return r.add(t),t}),l=nE(t),o=new Map(t.map((e,t)=>[l[t],e])),a=n.map((t,n)=>{let r=i[n];return o.has(r)?nO(e.element,o.get(r),t.value):nY(e.element,t.value)});return nL(a,i),a}}(0,o.vE)(e)}function nK(e,t){let n=[...t];for(;n.length;){let t=n.shift();e=e[t]}return e}function nT(e,t,n,r=[]){if("form"===e.kind||"child"===e.kind)return n[e.kind]?n[e.kind](e,t,r):t;if("object"===e.kind){let i=Object.fromEntries(Object.entries(e.fields).map(([e,i])=>[e,nT(i,t[e],n,[...r,e])]));return n.object?n[e.kind](e,i,r):i}if("array"===e.kind){let i=t.map((t,i)=>nT(e.element,t,n,r.concat(i)));return n.array?n[e.kind](e,i,r):i}if("conditional"===e.kind){let i=nT(e.discriminant,t.discriminant,n,r.concat("discriminant")),l=nT(e.values[i.toString()],t.value,n,r.concat("value")),o={discriminant:i,value:l};return n.conditional?n[e.kind](e,o,r):o}(0,l.vE)(e)}let nB=new Set,nz=new Set,nI=null;function nA(e,t){let n=nB.has(e);nB.add(e);try{return t()}finally{n||nB.delete(e)}}function nD(e,t){if(null!==nI)return t();nI=e;try{return t()}finally{nI=null}}function nW(e,t){let n=new Set;for(let t of e)nB.has(t)||n.add(t),nB.add(t);try{return t()}finally{for(let e of n)nB.delete(e)}}function nq(e){let t={text:e};for(let e of nB)nz.has(e)||(t[e]=!0);return null!==nI?[{text:""},{type:"link",href:nI,children:[t]},{text:""}]:[t]}class n_ extends Error{constructor(){super("There are a variable number of child fields")}}function nH(e){try{let t=function e(t,n,r){if(r.has(t))return[];switch(r.add(t),t.kind){case"form":return[];case"child":return[{relativePath:n,options:t.options,kind:"child"}];case"conditional":if(nJ(t))throw new n_;return[];case"array":if(t.asChildTag){let i=e(t.element,[],r);if(i.length>1)return[];return[{kind:"array",asChildTag:t.asChildTag,field:t,relativePath:n,child:i[0]}]}if(nJ(t))throw new n_;return[];case"object":{let i=[];for(let[l,o]of Object.entries(t.fields))i.push(...e(o,n.concat(l),r));return i}}}(e,[],new Set);if(1===t.length)return t[0];return}catch(e){if(e instanceof n_)return;throw e}}function nJ(e,t=new Set){if(t.has(e))return!1;switch(t.add(e),e.kind){case"form":return!1;case"child":return!0;case"conditional":return Object.values(e.values).some(e=>nJ(e,t));case"object":return Object.keys(e.fields).some(n=>nJ(e.fields[n],t));case"array":return nJ(e.element,t)}}function nV(e){if("inline"===e.type)return nU(e.children);if("link"===e.type)return nD(e.attributes.href,()=>nU(e.children));if("text"===e.type)return nq(e.attributes.content);if("strong"===e.type)return nA("bold",()=>nU(e.children));if("code"===e.type)return nA("code",()=>[{text:e.attributes.content,code:!0}]);if("em"===e.type)return nA("italic",()=>nU(e.children));if("s"===e.type)return nA("strikethrough",()=>nU(e.children));if("tag"===e.type){if("u"===e.tag)return nA("underline",()=>nU(e.children));if("kbd"===e.tag)return nA("keyboard",()=>nU(e.children));if("sub"===e.tag)return nA("subscript",()=>nU(e.children));if("sup"===e.tag)return nA("superscript",()=>nU(e.children))}if("softbreak"===e.type)return nq(" ");if("hardbreak"===e.type)return nq("\n");if("component-inline-prop"===e.tag&&Array.isArray(e.attributes.propPath)&&e.attributes.propPath.every(e=>"string"==typeof e||"number"==typeof e))return{type:"component-inline-prop",children:nZ(e.children),propPath:e.attributes.propPath};throw Error(`Unknown inline node type: ${e.type}`)}function nU(e){return e.flatMap(nV)}function nZ(e){let t;let n=e.flatMap(nV),r=[];for(let[e,l]of n.entries()){var i;(void 0!==l.type||""!==l.text||(null===(i=t)||void 0===i?void 0:i.type)!==void 0||e===n.length-1)&&(r.push(l),t=l)}return r.length||r.push({text:""}),r}function nX(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}function nG([e,t],n,r,l){let o=Object.keys(e).filter(e=>"text"!==e&&"insertMenu"!==e&&!0!==r[e]);if(o.length)return i.YR.unsetNodes(n,o,{at:t}),!0;if(!l){let r=e.text.includes("\n");if(r){let[e]=i.ML.parent(n,t);if("code"!==e.type)for(let e of i.ML.positions(n,{at:t})){let t=i.NB.get(n,e.path).text[e.offset];if("\n"===t)return i.YR.delete(n,{at:e}),!0}}}return!1}function nQ([e,t],n,r){return"link"===e.type&&!r&&(i.YR.insertText(n,` (${e.href})`,{at:i.ML.end(n,t)}),i.YR.unwrapNodes(n,{at:t}),!0)}function n0([e,t],n,{formatting:r,dividers:l,layouts:o,links:a,images:s,tables:d}){return("heading"!==e.type||r.headings.levels.length&&r.headings.levels.includes(e.level))&&("ordered-list"!==e.type||r.listTypes.ordered)&&("unordered-list"!==e.type||r.listTypes.unordered)&&("code"!==e.type||r.blockTypes.code)&&("blockquote"!==e.type||r.blockTypes.blockquote)&&("image"!==e.type||s)&&("table"!==e.type||d)&&("layout"!==e.type||0!==o.length&&o.some(t=>nX(t,e.layout)))?("paragraph"===e.type||"heading"===e.type)&&(!r.alignment.center&&"center"===e.textAlign||!r.alignment.end&&"end"===e.textAlign||"textAlign"in e&&"center"!==e.textAlign&&"end"!==e.textAlign)?(i.YR.unsetNodes(n,"textAlign",{at:t}),!0):"divider"!==e.type||l?nQ([e,t],n,a):(i.YR.removeNodes(n,{at:t}),!0):(i.YR.unwrapNodes(n,{at:t}),!0)}function n1(e,t){return"string"==typeof e?`${e.replace(/\/*$/,"")}/${void 0===t?"":t+"/"}`:""}function n3(e,t){return n1("object"==typeof e.images?e.images.publicPath:void 0,t)}function n2(e,t,n,r,i){let l=[];return{value:nT(t,e,{form(o,a,s){if(1===s.length&&n===s[0]){if("slug"!==o.formKind)throw Error("slugField is a not a slug field");return o.serializeWithSlug(a).value}if("asset"===o.formKind){let{asset:n,value:d}=o.serialize(a,{suggestedFilenamePrefix:i?n6(s,t,e):void 0,slug:r});return n&&l.push({path:n.filename,contents:n.content,parent:o.directory}),d}if("content"===o.formKind){let{other:n,external:i,content:d,value:c}=o.serialize(a,{slug:r});for(let[r,i]of(d&&l.push({path:n6(s,t,e)+o.contentExtension,contents:d,parent:void 0}),n))l.push({path:n6(s,t,e)+"/"+r,contents:i,parent:void 0});let u=new Set(o.directories);for(let[e,t]of i){if(!u.has(e))throw Error(`Invalid directory ${e} in content field serialization`);for(let[n,r]of t)l.push({path:n,contents:r,parent:e})}return c}return o.serialize(a).value},object:(e,t)=>Object.fromEntries(Object.entries(t).filter(([e,t])=>void 0!==t)),array:(e,t)=>t.map(e=>void 0===e?null:e),child(){}}),extraFiles:l}}function n6(e,t,n){let r=[];for(let i of e){if("array"===t.kind){if(n=n[i],t.slugField&&"object"===t.element.kind){let e=tk({schema:t.element.fields,slugField:t.slugField},n);r.push(e)}else r.push(i);t=t.element;continue}if(r.push(i),"object"===t.kind){n=n[i],t=t.fields[i];continue}if("conditional"===t.kind){"discriminant"===i?t=t.discriminant:"value"===i&&(t=t.values[n.discriminant]),n=n[i];continue}throw Error(`unexpected ${t.kind}`)}return r.join("/")}function n8(e){return new r.wS.Node("inline",{},e.flatMap(n9))}let n4={bold:{type:"strong"},code:{type:"code"},italic:{type:"em"},underline:{type:"tag",tag:"u"},keyboard:{type:"tag",tag:"kbd"},strikethrough:{type:"s"},subscript:{type:"tag",tag:"sub"},superscript:{type:"tag",tag:"sup"}};function n9(e){if("link"===e.type)return new r.wS.Node("link",{href:e.href},e.children.flatMap(n9));if(void 0!==e.type)throw Error(`unexpected inline node type: ${e.type}`);if(e.code)return new r.wS.Node("code",{content:e.text},[]);let t=Object.keys(e).filter(e=>"text"!==e).sort(),n=new r.wS.Node("text",{content:e.text});for(let e of t){let t=n4[e];t&&(n=new r.wS.Node(t.type,{},[n],t.tag))}return n}function n7(e,t,n,r,i){if(e.length<t)return 1===t?`${r} must not be empty`:`${r} must be at least ${t} characters long`;if(e.length>n)return`${r} must be no longer than ${n} characters`;if(i){if(""===e)return`${r} must not be empty`;if(".."===e)return`${r} must not be ..`;if("."===e)return`${r} must not be .`;if("**"===i.glob){let t=e.split("/");if(t.some(e=>".."===e))return`${r} must not contain ..`;if(t.some(e=>"."===e))return`${r} must not be .`}if(("*"===i.glob?/[\\/]/:/[\\]/).test(e))return`${r} must not contain slashes`;if(/^\s|\s$/.test(e))return`${r} must not start or end with spaces`;if(i.slugs.has(e))return`${r} must be unique`}}function n5(e){let t=(0,s.useContext)(rn);return(0,c.jsx)(rn.Provider,{value:(0,s.useMemo)(()=>t.concat(e.part),[t,e.part]),children:e.children})}let re=(0,s.createContext)(void 0),rt=re.Provider,rn=(0,s.createContext)([]),rr=rn.Provider;function ri(e){let t=e.multiline?d.Kx:d.nv,[n,r]=(0,s.useState)(!1),i=(0,s.useContext)(re),l=(0,s.useContext)(rn);return(0,c.jsx)(t,{label:e.label,description:e.description,autoFocus:e.autoFocus,value:e.value,onChange:e.onChange,onBlur:()=>r(!0),errorMessage:e.forceValidation||n?n7(e.value,e.min,e.max,e.label,1===l.length&&(null==i?void 0:i.field)===l[0]?i:void 0):void 0})}function rl(e){if(void 0===e)return"";if("string"!=typeof e)throw new nN("Must be a string");return e}let ro=new Set;function ra({label:e,defaultValue:t="",validation:{length:{max:n=1/0,min:r=0}={}}={},description:i,multiline:l=!1}){function o(t,i){let l=n7(t,r,n,e,i);if(void 0!==l)throw new nN(l);return t}return{kind:"form",formKind:"slug",Input:t=>(0,c.jsx)(ri,{label:e,description:i,min:r,max:n,multiline:l,...t}),defaultValue:()=>"string"==typeof t?t:t(),parse:(e,t)=>(null==t?void 0:t.slug)!==void 0?t.slug:rl(e),serialize:e=>({value:""===e?void 0:e}),serializeWithSlug:e=>({slug:e,value:void 0}),reader:{parse(e){let t=rl(e);return o(t,void 0)},parseWithSlug:(e,t)=>(o(rl(t.slug),{glob:t.glob,slugs:ro}),null)},validate:(e,t)=>o(e,null==t?void 0:t.slugField)}}function rs({schema:e,autoFocus:t,fields:n,forceValidation:r}){let i=t?function(e){for(let[t,n]of Object.entries(e.fields)){let e=function e(t){if("array"===t.kind||"conditional"===t.kind||"form"===t.kind)return!0;if("child"===t.kind)return!1;if("object"===t.kind){for(let n of Object.values(t.fields))if(e(n))return!0;return!1}(0,o.vE)(t)}(n);if(e)return t}}(e):void 0,l=(0,c.jsx)(h.kC,{gap:"xlarge",direction:"column",children:Object.entries(n).map(([e,t])=>rF(t)&&(0,c.jsx)(n5,{part:e,children:(0,c.jsx)(rO,{forceValidation:r,autoFocus:e===i,...t})},e))}),a=(0,s.useId)();if(!e.label)return l;let d=`${a}-label`,u=`${a}-description`;return(0,c.jsxs)(h.kC,{role:"group",gap:"medium",marginY:"large","aria-labelledby":d,"aria-describedby":e.description?u:void 0,direction:"column",children:[(0,c.jsx)(f.xv,{color:"neutral",size:"medium",weight:"medium",id:d,children:e.label}),!!e.description&&(0,c.jsx)(f.xv,{id:u,size:"regular",color:"neutralSecondary",children:e.description}),l]})}function rd({schema:e,autoFocus:t,discriminant:n,onChange:r,value:i,forceValidation:l}){let o=e.discriminant;return(0,c.jsxs)(h.kC,{gap:"xlarge",direction:"column",children:[(0,s.useMemo)(()=>(0,c.jsx)(n5,{part:"discriminant",children:(0,c.jsx)(o.Input,{autoFocus:!!t,value:n,onChange:r,forceValidation:l})}),[t,o,n,r,l]),rF(i)&&(0,c.jsx)(n5,{part:"value",children:(0,c.jsx)(rO,{forceValidation:l,...i})})]})}let rc={child:()=>null,form:e=>e.value,array(e){let t=e.elements.map(e=>ru(e));return nL(t,e.elements.map(e=>e.key)),t},conditional:e=>({discriminant:e.discriminant,value:ru(e.value)}),object:e=>Object.fromEntries(Object.entries(e.fields).map(([e,t])=>[e,ru(t)]))};function ru(e){return rc[e.schema.kind](e)}let rh={child(){},form:e=>e,array(e,t){let n=nE(e);return e.map((e,r)=>({key:n[r],value:rp(e,t.element)}))},conditional:(e,t)=>({discriminant:e.discriminant,value:rp(e.value,t.values[e.discriminant.toString()])}),object:(e,t)=>Object.fromEntries(Object.entries(t.fields).map(([t,n])=>[t,rp(e[t],n)]))};function rp(e,t){return rh[t.kind](e,t)}function rf(e,t){if(!rm(t,"child")){if(rm(t,"form")||rm(t,"object")||rm(t,"array")){t.onChange(rp(e,t.schema));return}if(rm(t,"conditional")){let n=rp(e,t.schema);t.onChange(n.discriminant,n.value);return}(0,o.vE)(t)}}function rm(e,t){return e.schema.kind===t}function rg(e,t,n){let r;let i={form:(e,t)=>e=>t(()=>e),array:(e,t)=>({rawOnChange:t,inner:new Map,onChange(n){t(t=>nO(e,t,n))}}),child(){},conditional:(e,t)=>({onChange:(n,r)=>t(t=>nO(e,t,{discriminant:n,value:r})),onChangeForValue:e=>t(t=>({discriminant:t.discriminant,value:e(t.value)}))}),object:(e,t)=>({onChange:n=>{t(t=>nO(e,t,n))},innerOnChanges:Object.fromEntries(Object.keys(e.fields).map(e=>[e,n=>{t(t=>({...t,[e]:n(t[e])}))}]))})},l={form:(e,t,n)=>({value:t,onChange:n,schema:e}),child:(e,t,r,i)=>({element:n(i),schema:e}),object(e,t,n,r,i){let l={};for(let r of Object.keys(e.fields))l[r]=i(e.fields[r],t[r],n.innerOnChanges[r],r);let o={fields:l,onChange:n.onChange,schema:e};return o},array(e,t,n,r,i){let l=nE(t),o=new Set(nE(t)),a={elements:t.map((t,r)=>{var a;let s=l[r];o.delete(s);let d=((a=n.inner).has(s)||a.set(s,(()=>{let r=e=>{n.rawOnChange(t=>{let n=nE(t),r=n.indexOf(s),i=[...t];return i[r]=e(i[r]),nL(i,n),i})},l=i(e.element,t,r,s);return{element:l,elementWithKey:{...l,key:s},onChange:r}})(s)),a.get(s)),c=i(e.element,t,d.onChange,s);return d.element!==c&&(d.element=c,d.elementWithKey={...c,key:s}),d.elementWithKey}),schema:e,onChange:n.onChange};for(let e of o)n.inner.delete(e);return a},conditional(e,t,n,r,i){let l={discriminant:t.discriminant,onChange:n.onChange,value:i(e.values[t.discriminant.toString()],t.value,n.onChangeForValue,"value"),schema:e};return l}};function o(e,t,n,r,i){return l[e.kind](e,t,n,r,i)}function a(e,t,n,r){let l=new Map,s=i[e.kind](e,n),d={value:t,inner:l,props:o(e,t,s,r,(e,t,n,i)=>{let o=a(e,t,n,r.concat(i));return l.set(i,o),o.props}),schema:e,cached:s};return d}return n=>void 0===r?(r=a(e,n,t,[])).props:function e(t,n,r,i,l){if(i.schema!==t)return Object.assign(i,a(t,n,r,l)),i.props;if(i.value===n)return i.props;i.value=n;let s=new Set(i.inner.keys());for(let r of(i.props=o(t,n,i.cached,l,(t,n,r,o)=>{if(s.delete(o),!i.inner.has(o)){let e=a(t,n,r,l.concat(o));return i.inner.set(o,e),e.props}return e(t,n,r,i.inner.get(o),l.concat(o))}),s))i.inner.delete(r);return i.props}(e,n,t,r,[])}function rv(e,t,n){var r,i;return(null===(r=e.validation)||void 0===r||null===(r=r.length)||void 0===r?void 0:r.min)!==void 0&&t.length<e.validation.length.min?new ry(new nN(`Must have at least ${e.validation.length.min} element${1===e.validation.length.min?"":"s"}`),n,e):(null===(i=e.validation)||void 0===i||null===(i=i.length)||void 0===i?void 0:i.max)!==void 0&&t.length>e.validation.length.max?new ry(new nN(`Must have at most ${e.validation.length.max} element${1===e.validation.length.max?"":"s"}}`),n,e):void 0}class ry extends Error{constructor(e,t,n){super(`field error at ${t.join(".")}`,{cause:e}),this.path=t,this.schema=n,this.cause=e}}function rb(e){if(null!==e)return e}let rx=Array.isArray;function rk(e){let t=function(e){let t=function e(t){return t instanceof AggregateError?t.errors.flatMap(e):[t]}(e);return t.map(e=>{if(e instanceof ry){let t=e.path.join(".");return`${t}: ${e.cause instanceof nN?e.cause.message:`Unexpected error: ${e.cause}`}`}return`Unexpected error: ${e}`}).join("\n")}(e);return Error(`Field validation failed:
`+t)}function rj(e,t,n){try{return function e(t,n,r,i=[]){switch(t.kind){case"child":return;case"form":try{if(r&&i[i.length-1]===(null==r?void 0:r.field)){t.validate(n,{slugField:{slugs:r.slugs,glob:r.glob}});return}t.validate(n,void 0)}catch(e){throw new ry(e,i,t)}return;case"conditional":t.discriminant.validate(n.discriminant),e(t.values[n.discriminant],n.value,void 0,i.concat("value"));return;case"object":{let l=[];for(let[o,a]of Object.entries(t.fields))try{e(a,n[o],o===(null==r?void 0:r.field)?r:void 0,i.concat(o))}catch(e){l.push(e)}if(l.length>0)throw AggregateError(l);return}case"array":{let r;if(void 0!==t.slugField&&"object"===t.element.kind){let e=t.element.fields,{slugField:i}=t;r={slugField:i,slugs:n.map(t=>tk({schema:e,slugField:i},t))}}let l=[],o=rv(t,n,i);for(let[a,s]of(void 0!==o&&l.push(o),n.entries()))try{e(t.element,s,void 0===r?void 0:{field:r.slugField,slugs:new Set(r.slugs.filter((e,t)=>a!==t)),glob:"*"},i.concat(a))}catch(e){l.push(e)}if(l.length>0)throw AggregateError(l);return}}}(e,t,n),!0}catch(e){return console.warn(rk(e)),!1}}function rw(e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(S.F3.toDOMRange(e,e.selection))),S.F3.focus(e)}let rM=(0,N.iv)({marginBlock:"0.75em","&:first-child":{marginBlockStart:0},"&:last-child":{marginBlockEnd:0}}),rN=s.createContext(!1);function rS(e,t){let[n,r]=(0,s.useState)({element:t,elementWithChanges:t});n.element!==t&&r({element:t,elementWithChanges:t});let l=(0,s.useRef)(t);(0,s.useEffect)(()=>{l.current=t});let o=(0,s.useCallback)(t=>{let n=l.current,o="function"==typeof t?t(n):t;i.YR.setNodes(e,o,{at:S.F3.findPath(e,n)}),r({element:n,elementWithChanges:{...n,...o}})},[e]);return[n.elementWithChanges,o]}function rR(e){let t=(0,s.useRef)(e),n=(0,s.useCallback)((...e)=>t.current(...e),[]);return(0,s.useEffect)(()=>{t.current=e}),n}function rC(e,t){var n;let r;let l=i.ML.above(e,{match:e=>"heading"===e.type||"paragraph"===e.type});l&&""===i.NB.string(l[0])&&(r=i.ML.pathRef(e,l[1])),i.YR.insertNodes(e,t);let o=null===(n=r)||void 0===n?void 0:n.unref();o&&(i.YR.removeNodes(e,{at:o}),S.F3.focus(e))}function rP(e){let t=(0,s.useId)(),n=(0,s.useId)(),r=(0,w.qb)(M.l),[i,l]=(0,s.useState)({state:"closed"}),o=(0,s.useCallback)(e=>{l(t=>"open"===t.state?{state:"open",forceValidation:t.forceValidation,value:e(t.value),index:t.index}:t)},[l]),a=(0,s.useId)(),d="open"===i.state?i.index:void 0,p=(0,s.useMemo)(()=>{if(void 0===e.schema.slugField||"open"!==i.state||"object"!==e.schema.element.kind)return;let t=ru(e),n=e.schema.element.fields,r=e.schema.slugField,l=new Set(t.filter((e,t)=>t!==d).map(e=>tk({schema:n,slugField:r},e)));return{slugs:l,field:r,glob:"*"}},[d,e,i.state]);return(0,c.jsxs)(h.kC,{elementType:"section",gap:"medium",role:"group","aria-labelledby":t,"aria-describedby":e.schema.description?n:void 0,direction:"column",children:[(0,c.jsx)(u.Qy,{elementType:"h3",id:t,children:e.schema.label}),e.schema.description&&(0,c.jsx)(f.xv,{id:n,size:"small",color:"neutralSecondary",children:e.schema.description}),(0,c.jsx)(m.Kk,{autoFocus:e.autoFocus,onPress:()=>{l({state:"open",value:nF(e.schema.element),forceValidation:!1,index:void 0})},alignSelf:"start",children:r.format("add")}),(0,c.jsx)(rL,{...e,labelId:t,onOpenItem:t=>{l({state:"open",value:ru(e.elements[t]),forceValidation:!1,index:t})}}),(0,c.jsx)(rE,{...e}),(0,c.jsx)(g.TW,{onDismiss:()=>{l({state:"closed"})},children:(()=>{if("open"===i.state&&"child"!==e.schema.element.kind)return(0,c.jsxs)(g.Vq,{children:[(0,c.jsx)(f.X6,{children:"Edit item"}),(0,c.jsx)(k.VY,{children:(0,c.jsx)(h.kC,{id:a,elementType:"form",onSubmit:t=>{if(t.target===t.currentTarget&&(t.preventDefault(),"open"===i.state)){if(!rj(e.schema.element,i.value,void 0)){l(e=>({...e,forceValidation:!0}));return}void 0===i.index?e.onChange([...e.elements.map(e=>({key:e.key})),{key:void 0,value:rp(i.value,e.schema.element)}]):rf(i.value,e.elements[i.index]),l({state:"closed"})}},direction:"column",gap:"xxlarge",children:(0,c.jsx)(r$,{onChange:o,schema:e.schema.element,value:i.value,slugField:p})})}),(0,c.jsxs)(m.hE,{children:[(0,c.jsx)(m.zx,{onPress:()=>{l({state:"closed"})},children:r.format("cancel")}),(0,c.jsx)(m.zx,{form:a,prominence:"high",type:"submit",children:void 0===i.index?r.format("add"):"Done"})]})]})})()})]})}function rE(e){var t,n;return(0,c.jsx)(c.Fragment,{children:e.forceValidation&&((null===(t=e.schema.validation)||void 0===t||null===(t=t.length)||void 0===t?void 0:t.min)!==void 0&&e.elements.length<e.schema.validation.length.min?(0,c.jsxs)(u.nd,{children:["Must have at least ",e.schema.validation.length.min," item",1===e.schema.validation.length.min?"":"s"]}):(null===(n=e.schema.validation)||void 0===n||null===(n=n.length)||void 0===n?void 0:n.max)!==void 0&&e.elements.length>e.schema.validation.length.max?(0,c.jsxs)(u.nd,{children:["Must have at most ",e.schema.validation.length.max," item",1===e.schema.validation.length.max?"":"s"]}):void 0)})}function rL(e){let t=(t,n)=>{let r=e.elements.findIndex(e=>e.key===n.key);if(-1===r)return;let i=e.elements.map(e=>({key:e.key})),l="before"===n.dropPosition?r:r+1,o=t.map(e=>i.findIndex(t=>t.key===e));e.onChange(function(e,t,n){n-=t.filter(e=>e<n).length;let r=t.map(e=>({from:e,to:n++}));for(let e=0;e<r.length;e++){let t=r[e].from;for(let n=e;n<r.length;n++)r[n].from>t&&r[n].from--}for(let e=0;e<r.length;e++){let t=r[e];for(let n=r.length-1;n>e;n--){let e=r[n];e.from<t.to?t.to++:e.from++}}let i=e.slice();for(let e of r){let[t]=i.splice(e.from,1);i.splice(e.to,0,t)}return i}(i,o,l))},n=(0,s.useMemo)(()=>Math.random().toString(36),[]),{dragAndDropHooks:r}=(0,v.Y)({getItems:e=>[...e].map(e=>({[n]:e=JSON.stringify(e),"text/plain":e})),getAllowedDropOperations:()=>["move","cancel"],async onDrop(e){if("root"!==e.target.type&&"on"!==e.target.dropPosition){let r=[];for(let t of e.items)if("text"===t.kind){let e;t.types.has(n)?(e=JSON.parse(await t.getText(n)),r.push(e)):t.types.has("text/plain")&&(r=(e=await t.getText("text/plain")).split("\n").map(e=>e.replaceAll('"',"")))}t(r,e.target)}},getDropOperation:e=>"root"===e.type||"on"===e.dropPosition?"cancel":"move"}),i=rR(t=>{e.onChange(e.elements.map(e=>({key:e.key})).filter(e=>e.key!==t))}),l=(0,w.qb)(M.l);return(0,c.jsx)(x.B,{"aria-labelledby":e.labelId,items:e.elements,dragAndDropHooks:r,height:e.elements.length?void 0:"scale.2000",renderEmptyState:()=>(0,c.jsxs)(h.kC,{direction:"column",gap:"large",alignItems:"center",justifyContent:"center",height:"100%",padding:"regular",children:[(0,c.jsx)(f.xv,{elementType:"h3",align:"center",color:"neutralSecondary",size:"large",weight:"medium",children:"Empty list"}),(0,c.jsx)(f.xv,{align:"center",color:"neutralTertiary",children:"Add the first item to see it here."})]}),onAction:t=>{let n=e.elements.findIndex(e=>e.key===t);-1!==n&&e.onOpenItem(n)},children:t=>{var n,r;let o=(null===(n=(r=e.schema).itemLabel)||void 0===n?void 0:n.call(r,t))||`Item ${e.elements.indexOf(t)+1}`;return(0,c.jsxs)(x.c,{textValue:o,children:[(0,c.jsx)(f.xv,{children:o}),(0,c.jsxs)(j.a,{placement:"start",children:[(0,c.jsx)(m.Kk,{onPress:()=>{i(t.key)},children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:l.format("delete")})]})]},t.key)}})}function r$(e){let t=(0,s.useMemo)(()=>rg(e.schema,e.onChange,()=>void 0),[e.schema,e.onChange])(e.value);return(0,c.jsx)(rT,{slugField:e.slugField,autoFocus:!0,...t})}function rF(e){return"child"!==e.schema.kind}function rY(e){var t,n,r;return"object"===e.kind?null!==(t=e.Input)&&void 0!==t?t:rs:"conditional"===e.kind?null!==(n=e.Input)&&void 0!==n?n:rd:"array"===e.kind?null!==(r=e.Input)&&void 0!==r?r:rP:e.Input}rN.Provider;let rO=(0,s.memo)(function(e){let t=rY(e.schema);return(0,c.jsx)(t,{...e,autoFocus:!!e.autoFocus,forceValidation:!!e.forceValidation})}),rK=[],rT=(0,s.memo)(function({slugField:e,...t}){let n=rY(t.schema);return(0,c.jsx)(rr,{value:rK,children:(0,c.jsx)(rt,{value:e,children:(0,c.jsx)(n,{...t,autoFocus:!!t.autoFocus,forceValidation:!!t.forceValidation})})})}),rB=[],rz={mobile:"medium",tablet:"xlarge",desktop:"xxlarge"};function rI(e){return"content"===e.entryLayout?"none":"medium"}let rA=(0,s.createContext)(null);function rD(){return(0,s.useContext)(rA)}function rW({formatInfo:e,forceValidation:t,slugField:n,entryLayout:r,previewProps:i}){let l=function(e){let t=["mobile","tablet","desktop","wide"],n=nc(),r="above"in e?t.indexOf(e.above)+1:0,i="below"in e?t.indexOf(e.below)-1:t.length-1,l=t.slice(r,i+1);return l.includes(n)}({above:"mobile"});if("content"===r&&e.contentField&&l){let{contentField:r}=e;return(0,c.jsx)(rr,{value:rB,children:(0,c.jsx)(rt,{value:n,children:(0,c.jsxs)(p.z3,{autoSaveId:"keystatic-content-split-view",defaultSize:320,minSize:240,maxSize:480,flex:!0,children:[(0,c.jsx)(p.SI,{children:(0,c.jsx)(rA.Provider,{value:"main",children:(0,c.jsx)(nn,{children:(0,c.jsx)(n5,{part:r.key,children:(0,c.jsx)(rO,{forceValidation:t,...i.fields[r.key]})})})})}),(0,c.jsx)(p.ok,{children:(0,c.jsx)(rA.Provider,{value:"side",children:(0,c.jsx)(nn,{children:(0,c.jsx)(h.rj,{gap:"xlarge",padding:rz,children:Object.entries(i.fields).map(([e,n])=>e===r.key?null:(0,c.jsx)(n5,{part:e,children:(0,c.jsx)(rO,{forceValidation:t,...n})},e))})})})})]})})})}return(0,c.jsx)(nn,{children:(0,c.jsx)(nM,{paddingY:rz,children:(0,c.jsx)(rT,{forceValidation:t,slugField:n,...i})})})}let rq=["paragraph","code","heading","ordered-list","unordered-list","divider","image"],r_=[...rq,"table"],rH=[...r_,"blockquote"],rJ=[...rH,"component-block"];function rV(e){return{kind:"blocks",allowedChildren:new Set(e.allowedChildren),blockToWrapInlinesIn:e.allowedChildren[0],invalidPositionHandleMode:e.invalidPositionHandleMode}}function rU(e){return{kind:"inlines",invalidPositionHandleMode:e.invalidPositionHandleMode}}let rZ={editor:rV({allowedChildren:[...rJ,"layout"],invalidPositionHandleMode:"move"}),layout:rV({allowedChildren:["layout-area"],invalidPositionHandleMode:"move"}),"layout-area":rV({allowedChildren:rJ,invalidPositionHandleMode:"unwrap"}),blockquote:rV({allowedChildren:r_,invalidPositionHandleMode:"move"}),paragraph:rU({invalidPositionHandleMode:"unwrap"}),code:rU({invalidPositionHandleMode:"move"}),divider:rU({invalidPositionHandleMode:"move"}),heading:rU({invalidPositionHandleMode:"unwrap"}),"component-block":rV({allowedChildren:["component-block-prop","component-inline-prop"],invalidPositionHandleMode:"move"}),"component-inline-prop":rU({invalidPositionHandleMode:"unwrap"}),"component-block-prop":rV({allowedChildren:[...rH,"component-block"],invalidPositionHandleMode:"unwrap"}),"ordered-list":rV({allowedChildren:["list-item"],invalidPositionHandleMode:"move"}),"unordered-list":rV({allowedChildren:["list-item"],invalidPositionHandleMode:"move"}),"list-item":rV({allowedChildren:["list-item-content","ordered-list","unordered-list"],invalidPositionHandleMode:"unwrap"}),"list-item-content":rU({invalidPositionHandleMode:"unwrap"}),image:rU({invalidPositionHandleMode:"move"}),table:rV({invalidPositionHandleMode:"move",allowedChildren:["table-head","table-body"]}),"table-body":rV({invalidPositionHandleMode:"move",allowedChildren:["table-row"]}),"table-row":rV({invalidPositionHandleMode:"move",allowedChildren:["table-cell"]}),"table-cell":rV({invalidPositionHandleMode:"move",allowedChildren:rq}),"table-head":rV({invalidPositionHandleMode:"move",allowedChildren:["table-row"]})},rX=new Set(Object.entries(rZ).filter(([,e])=>"inlines"===e.kind).map(([e])=>e)),rG=new Set(Object.keys(rZ).filter(e=>"editor"!==e));function rQ(e){return rG.has(e.type)}function r0(e,t){var n,r,i,l,o,a,s;let d=null===(n=t.formatting)||void 0===n?void 0:n.inlineMarks,c="inherit"===d?"inherit":Object.fromEntries(Object.keys(e.formatting.inlineMarks).map(e=>[e,!!(d||{})[e]]));if("inline"===t.kind)return{kind:"inline",inlineMarks:c,documentFeatures:{links:"inherit"===t.links},softBreaks:(null===(s=t.formatting)||void 0===s?void 0:s.softBreaks)==="inherit"};let u=null===(r=t.formatting)||void 0===r?void 0:r.headingLevels;return{kind:"block",inlineMarks:c,softBreaks:(null===(i=t.formatting)||void 0===i?void 0:i.softBreaks)==="inherit",documentFeatures:{layouts:[],dividers:"inherit"===t.dividers&&e.dividers,formatting:{alignment:(null===(l=t.formatting)||void 0===l?void 0:l.alignment)==="inherit"?e.formatting.alignment:{center:!1,end:!1},blockTypes:(null===(o=t.formatting)||void 0===o?void 0:o.blockTypes)==="inherit"?e.formatting.blockTypes:{blockquote:!1,code:!1},headings:"inherit"===u?e.formatting.headings:{levels:u?e.formatting.headings.levels.filter(e=>u.includes(e)):[],schema:e.formatting.headings.schema},listTypes:(null===(a=t.formatting)||void 0===a?void 0:a.listTypes)==="inherit"?e.formatting.listTypes:{ordered:!1,unordered:!1}},links:"inherit"===t.links,images:"inherit"===t.images&&e.images,tables:"inherit"===t.tables},componentBlocks:"inherit"===t.componentBlocks}}function r1(e,t,n){return function e(t,n,r){if(0===t.length)return r;if("child"!==r.kind&&"form"!==r.kind){if("conditional"===r.kind){let i=t.shift();if("discriminant"===i)return e(t,n.discriminant,r.discriminant);if("value"===i){let i=r.values[n.discriminant];return e(t,n.value,i)}return}if("object"===r.kind){let i=t.shift();return e(t,n[i],r.fields[i])}if("array"===r.kind){let i=t.shift();return e(t,n[i],r.element)}(0,o.vE)(r)}}([...e],t,{kind:"object",fields:n})}let r3=["bold","italic","underline","strikethrough","code","superscript","subscript","keyboard"],r2=(e,t)=>{let[n]=i.ML.nodes(e,{match:e=>e.type===t});return!!n};function r6(e){i.YR.unwrapNodes(e,{match:e=>"heading"===e.type||"blockquote"===e.type||"code"===e.type}),i.YR.unsetNodes(e,r3,{match:i.xv.isText})}function r8(e,t,n,r=()=>!0){let l=i.y$.isPath(t)?t:t[1],o=i.y$.isPath(t)?i.NB.get(e,l):t[0];if(rQ(o)){for(let t=o.children.length-1;t>=0;t--)if(r(o.children[t],t)){let r=[...l,t];i.YR.moveNodes(e,{at:r,to:n})}}}function r4(e,t,{distance:n=1}={}){let r;let l=i.ML.point(e,t,{edge:"end"}),o=i.ML.end(e,[]),a=0;for(let t of i.ML.positions(e,{at:{anchor:l,focus:o}})){if(a>n)break;let l=i.NB.get(e,t.path);l.text.length!==t.offset&&(0!==a&&(r=t),a++)}return r}function r9(...e){if(1===e.length){let t=e[0];return e=>e.type===t}let t=new Set(e);return e=>"string"==typeof e.type&&t.has(e.type)}function r7(e,t,n){let r=i.ML.above(e,{match:r9("component-block-prop","component-inline-prop")});if(r){let l=r[0].propPath,o=i.ML.parent(e,r[1]);if("component-block"===o[0].type){let e=o[0].component,r=n[e];if(r&&l){let e=r1(l,o[0].props,r.schema);if((null==e?void 0:e.kind)==="child")return r0(t,e.options)}}}}let r5=(0,s.createContext)(null);function ie(){let e=(0,s.useContext)(r5);if(!e)throw Error("useBlockPopoverContext must be used within a BlockPopoverTrigger");return e}let it=r9("code","component-block","image","layout","link","table","heading"),ir=(0,s.createContext)(void 0);function ii(){return(0,s.useContext)(ir)}function il(e){let t=i.ML.above(e.editor,{match:it});return(0,c.jsx)(ir.Provider,{value:null==t?void 0:t[0],children:e.children})}let io=({children:e,element:t})=>{let[n,r]=e,i=ii(),l=(0,s.useRef)(null),o=(0,F.d)({isOpen:i===t}),a=(0,s.useMemo)(()=>({state:o,triggerRef:l}),[o,l]);return(0,c.jsxs)(r5.Provider,{value:a,children:[(0,s.cloneElement)(n,{ref:l}),r]})};function ia(e){let{state:t}=ie(),n=(0,s.useRef)(null);return(0,c.jsx)(O.aV,{isOpen:t.isOpen,nodeRef:n,children:(0,c.jsx)(is,{wrapperRef:n,...e})})}let is=({children:e,placement:t="bottom"})=>{let n=(0,s.useRef)(null),{state:r,triggerRef:i}=ie(),{placement:l,popoverProps:o}=function(e,t){var n;let{triggerRef:r,popoverRef:i,isNonModal:l,isKeyboardDismissDisabled:o,...a}=e,[d,c]=(0,s.useState)(!1),{overlayProps:u,underlayProps:h}=(0,L.Ir)({isOpen:t.isOpen,onClose:t.close,shouldCloseOnBlur:!0,isDismissable:!l,isKeyboardDismissDisabled:!1},i);(0,s.useEffect)(()=>{if(t.isOpen){let e=()=>{var e,t;let n=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),l=null===(e=i.current)||void 0===e?void 0:e.getBoundingClientRect(),o=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect();l&&o&&c(o.bottom+l.height+16>n&&o.top<n)};return e(),window.addEventListener("scroll",e),()=>{e(),window.removeEventListener("scroll",e)}}},[i,r,t.isOpen]);let{overlayProps:p,arrowProps:f,placement:m,updatePosition:g}=(0,L.tN)({...a,containerPadding:8,shouldFlip:!1,targetRef:r,overlayRef:i,isOpen:t.isOpen,onClose:void 0}),v=function(e){let t=(0,s.useRef)();return(0,s.useEffect)(()=>{t.current=e}),t.current}(null===(n=r.current)||void 0===n?void 0:n.getBoundingClientRect());return(0,$.bt)(()=>{if(v){var e;let t=null===(e=r.current)||void 0===e?void 0:e.getBoundingClientRect();if(t){let e=v.height!==t.height||v.width!==t.width||v.x!==t.x||v.y!==t.y;e&&g()}}},[v,r,g]),p.style&&(p.style.zIndex=1),d&&(p.style={...p.style,maxHeight:null,position:"fixed",top:null,bottom:8}),{arrowProps:f,placement:m,popoverProps:(0,$.dG)(u,p),underlayProps:h,updatePosition:g}}({isNonModal:!0,isKeyboardDismissDisabled:!1,placement:t,triggerRef:i,popoverRef:n},r);return(0,c.jsx)("div",{ref:n,...o,"data-open":r.isOpen,"data-placement":l,contentEditable:!1,className:(0,N.iv)({backgroundColor:N.iK.color.background.surface,borderRadius:N.iK.size.radius.medium,border:`${N.iK.size.border.regular} solid ${N.iK.color.border.emphasis}`,boxSizing:"content-box",minHeight:N.iK.size.element.regular,minWidth:N.iK.size.element.regular,opacity:0,outline:0,pointerEvents:"auto",position:"absolute",filter:`drop-shadow(0 1px 4px ${N.iK.color.shadow.regular})`,willChange:"filter",userSelect:"none",'&[data-placement="top"]':{marginBottom:N.iK.size.space.regular,transform:`translateY(${N.iK.size.space.regular})`},'&[data-placement="bottom"]':{marginTop:N.iK.size.space.regular,transform:`translateY(calc(${N.iK.size.space.regular} * -1))`},'&[data-open="true"]':{opacity:1,transform:"translateX(0) translateY(0)",transition:(0,N.eR)(["opacity","transform"],{easing:"easeOut"})}}),children:"function"==typeof e?e(r.close):e})},id=e=>{let{attributes:t,children:n,draggable:r=!1}=e;return(0,c.jsx)("div",{draggable:r,className:rM,...t,children:n})},ic=(0,s.forwardRef)(function({className:e,...t},n){return(0,c.jsx)("div",{...t,ref:n,className:[(0,N.iv)({userSelect:"none",whiteSpace:"initial"}),e].join(" "),contentEditable:!1})}),iu=()=>(0,c.jsx)(h.iz,{orientation:"vertical",flexShrink:0}),ih=e=>"ordered-list"===e||"unordered-list"===e,ip=e=>ih(e.type),im=s.createContext(null);function ig(){let e=(0,s.useContext)(im);if(!e)throw Error("ToolbarStateProvider must be used to use useToolbarState");return e}let iv=(e,t,n)=>{let r=r7(e,n,t)||{kind:"block",inlineMarks:"inherit",documentFeatures:{dividers:!0,formatting:{alignment:{center:!0,end:!0},blockTypes:{blockquote:!0,code:n.formatting.blockTypes.code},headings:n.formatting.headings,listTypes:{ordered:!0,unordered:!0}},layouts:n.layouts,links:!0,images:n.images,tables:!0},softBreaks:!0,componentBlocks:!0},[l]=i.ML.nodes(e,{match:e=>"code"!==e.type&&rQ(e)}),o=i.ML.marks(e)||{},a=Object.fromEntries(r3.map(e=>[e,{isDisabled:"inherit"!==r.inlineMarks&&!r.inlineMarks[e]||!l,isSelected:!!o[e]}]));if(e.selection&&i.e6.isExpanded(e.selection))for(let t of i.ML.nodes(e,{match:i.xv.isText}))for(let e of Object.keys(t[0]))"insertMenu"!==e&&"text"!==e&&e in a&&(a[e].isSelected=!0);let[s]=i.ML.nodes(e,{match:r9("heading")}),[d]=i.ML.nodes(e,{match:ip}),[c]=i.ML.nodes(e,{match:r9("paragraph","heading")}),u=iy(e);return{marks:a,textStyles:{selected:s?s[0].level:"normal",allowedHeadingLevels:"block"!==r.kind||d?[]:r.documentFeatures.formatting.headings.levels},code:{isSelected:r2(e,"code"),isDisabled:!("block"===r.kind&&r.documentFeatures.formatting.blockTypes.code)},lists:{ordered:{isSelected:r2(e,"ordered-list")&&("none"===u||"ordered-list"===u),isDisabled:!("block"===r.kind&&r.documentFeatures.formatting.listTypes.ordered&&!s)},unordered:{isSelected:r2(e,"unordered-list")&&("none"===u||"unordered-list"===u),isDisabled:!("block"===r.kind&&r.documentFeatures.formatting.listTypes.unordered&&!s)}},alignment:{isDisabled:!c&&!("block"===r.kind&&r.documentFeatures.formatting.alignment),selected:(null==c?void 0:c[0].textAlign)||"start"},blockquote:{isDisabled:!("block"===r.kind&&r.documentFeatures.formatting.blockTypes.blockquote),isSelected:r2(e,"blockquote")},layouts:{isSelected:r2(e,"layout")},links:{isDisabled:!e.selection||i.e6.isCollapsed(e.selection)||!r.documentFeatures.links,isSelected:r2(e,"link")},editor:e,dividers:{isDisabled:"inline"===r.kind||!r.documentFeatures.dividers},clearFormatting:{isDisabled:!(Object.values(a).some(e=>e.isSelected)||function(e){let[t]=i.ML.nodes(e,{match:e=>"heading"===e.type||"code"===e.type||"blockquote"===e.type});return!!t}(e))},editorDocumentFeatures:n}};function iy(e){let t=i.ML.above(e,{match:ip});return t?t[0].type:"none"}let ib=(0,s.createContext)(null);function ix(){let e=(0,s.useContext)(ib);if(!e)throw Error("useDocumentEditorConfig must be used within a DocumentEditorConfigContext.Provider");return e}let ik=({children:e,componentBlocks:t,editorDocumentFeatures:n})=>{let r=(0,S.ui)();return(0,c.jsx)(ib.Provider,{value:(0,s.useMemo)(()=>({componentBlocks:t,documentFeatures:n}),[t,n]),children:(0,c.jsx)(im.Provider,{value:iv(r,t,n),children:e})})},ij=e=>r2(e,"link"),iw=(e,t)=>{if(ij(e)){i.YR.unwrapNodes(e,{match:e=>"link"===e.type});return}let{selection:n}=e,r=n&&i.e6.isCollapsed(n);r?i.YR.insertNodes(e,{type:"link",href:t,children:[{text:t}]}):i.YR.wrapNodes(e,{type:"link",href:t,children:[{text:""}]},{split:!0})},iM=({attributes:e,children:t,element:n})=>{let r=(0,w.qb)(M.l),l=(0,S._7)(),[o,a]=rS(l,n),d=o.href,u=i.NB.string(o),[p,v]=(0,s.useState)(!1),b=ii(),x=b===n;(0,s.useEffect)(()=>{x&&!d&&v(!0)},[d,x]);let k=rR(()=>{i.YR.unwrapNodes(l,{at:S.F3.findPath(l,n)}),S.F3.focus(l)});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(io,{element:n,children:[(0,c.jsx)("a",{href:d,...e,children:t}),(0,c.jsx)(ia,{placement:"bottom start",children:(0,c.jsxs)(h.kC,{gap:"small",padding:"regular",children:[(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>v(!0),children:(0,c.jsx)(y.J,{src:q.g})}),(0,c.jsx)(j.u,{children:r.format("edit")})]}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{window.open(d,"_blank","noopener,noreferrer")},children:(0,c.jsx)(y.J,{src:_.K})}),(0,c.jsx)(j.u,{children:(0,c.jsx)(f.xv,{truncate:3,children:d})})]}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:k,children:(0,c.jsx)(y.J,{src:J.s})}),(0,c.jsx)(j.u,{children:"Unlink"})]})]})})]}),(0,c.jsx)(g.TW,{onDismiss:()=>{v(!1),rw(l)},children:p&&(0,c.jsx)(iN,{text:u,href:d,onSubmit:({href:e})=>{a({href:e})}})})]})};function iN({onSubmit:e,...t}){let[n,r]=(0,s.useState)(t.href||""),[i,l]=(0,s.useState)(!1),{dismiss:o}=(0,g.SN)(),a=(0,w.qb)(M.l),u=i&&!(0,M.i)(n);return(0,c.jsx)(g.Vq,{size:"small",children:(0,c.jsxs)("form",{style:{display:"contents"},onSubmit:t=>{t.target!==t.currentTarget||(t.preventDefault(),u||(o(),e({href:n})))},children:[(0,c.jsxs)(f.X6,{children:[t.href?"Edit":"Add"," link"]}),(0,c.jsx)(k.VY,{children:(0,c.jsxs)(h.kC,{gap:"large",direction:"column",children:[(0,c.jsx)(d.nv,{label:"Text",value:t.text,isReadOnly:!0}),(0,c.jsx)(d.nv,{autoFocus:!0,isRequired:!0,onBlur:()=>l(!0),label:"Link",onChange:r,value:n,errorMessage:u&&"Please provide a valid URL."})]})}),(0,c.jsxs)(m.hE,{children:[(0,c.jsx)(m.zx,{onPress:o,children:a.format("cancel")}),(0,c.jsx)(m.zx,{prominence:"high",type:"submit",children:a.format("save")})]})]})})}let iS=(0,c.jsx)(y.J,{src:H.N}),iR=(0,c.jsxs)(j.a,{children:[(0,c.jsx)(function(){let{editor:e,links:{isDisabled:t,isSelected:n}}=ig();return(0,s.useMemo)(()=>(0,c.jsx)(m.Kk,{prominence:"low",isDisabled:t,isSelected:n,onPress:()=>{iw(e,""),S.F3.focus(e)},children:iS}),[n,t,e])},{}),(0,c.jsx)(j.u,{children:(0,c.jsx)(f.xv,{children:"Link"})})]}),iC={start:{key:"start",label:"Align Start",icon:(0,c.jsx)(y.J,{src:ec.$})},center:{key:"center",label:"Align Center",icon:(0,c.jsx)(y.J,{src:eh.L})},end:{key:"end",label:"Align End",icon:(0,c.jsx)(y.J,{src:eu.g})}},iP=({alignment:e})=>{let t=ig(),n=(0,s.useMemo)(()=>[iC.start,...Object.keys(e).map(e=>iC[e])],[e]);return(0,s.useMemo)(()=>(0,c.jsxs)(es.bF,{children:[(0,c.jsxs)(j.a,{children:[(0,c.jsxs)(m.Kk,{prominence:"low",children:[iC[t.alignment.selected].icon,(0,c.jsx)(y.J,{src:Z.i})]}),(0,c.jsx)(j.u,{children:(0,c.jsx)(f.xv,{children:"Text Alignment"})})]}),(0,c.jsx)(es.v2,{selectionMode:"single",selectedKeys:[t.alignment.selected],items:n,onAction:e=>{"start"===e?i.YR.unsetNodes(t.editor,"textAlign",{match:e=>"paragraph"===e.type||"heading"===e.type}):i.YR.setNodes(t.editor,{textAlign:e},{match:e=>"paragraph"===e.type||"heading"===e.type}),S.F3.focus(t.editor)},children:e=>(0,c.jsxs)(V.c,{textValue:e.label,children:[(0,c.jsx)(f.xv,{children:e.label}),e.icon]},e.key)})]}),[n,t.alignment.selected,t.editor])},iE=e=>{let t=r2(e,"blockquote");t?i.YR.unwrapNodes(e,{match:e=>"blockquote"===e.type}):i.YR.wrapNodes(e,{type:"blockquote",children:[]})},iL=(0,c.jsxs)(j.a,{children:[(0,c.jsx)(()=>{let{editor:e,blockquote:{isDisabled:t,isSelected:n}}=ig();return(0,s.useMemo)(()=>(0,c.jsx)(m.Kk,{prominence:"low",isSelected:n,isDisabled:t,onPress:()=>{iE(e),S.F3.focus(e)},children:(0,c.jsx)(y.J,{src:ep.O})}),[e,t,n])},{}),(0,c.jsxs)(j.u,{children:[(0,c.jsx)(f.xv,{children:"Quote"}),(0,c.jsx)(f.Tz,{children:">"})]})]});function i$(e){let t=(0,S._7)(),[n,r]=(0,s.useState)(()=>nY(e.schema,Object.fromEntries(Object.keys(e.schema.fields).map(t=>[t,e.element[t]])))),[l,o]=(0,s.useState)(!1),a=(0,s.useMemo)(()=>rg(e.schema,r,()=>void 0),[e.schema])(n),{dismiss:d}=(0,g.SN)(),u=(0,w.qb)(M.l);return(0,c.jsx)(g.Vq,{size:"small",children:(0,c.jsxs)("form",{style:{display:"contents"},onSubmit:r=>{if(r.target===r.currentTarget&&(r.preventDefault(),o(!0),rj(e.schema,n,void 0))){d();let r=S.F3.findPath(t,e.element);console.log(n),i.YR.setNodes(t,n,{at:r})}},children:[(0,c.jsxs)(f.X6,{children:[e.nodeLabel," details"]}),(0,c.jsx)(k.VY,{children:(0,c.jsx)(rT,{forceValidation:l,autoFocus:!0,...a})}),(0,c.jsxs)(m.hE,{children:[(0,c.jsx)(m.zx,{onPress:d,children:u.format("cancel")}),(0,c.jsx)(m.zx,{prominence:"high",type:"submit",children:u.format("save")})]})]})})}function iF(e){let t=(0,w.qb)(M.l);return(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:e.onPress,children:(0,c.jsx)(y.J,{src:q.g})}),(0,c.jsx)(j.u,{children:t.format("edit")})]})}function iY(e){let t=(0,S._7)();return(0,c.jsx)(g.TW,{onDismiss:()=>{e.onDismiss(),rw(t)},children:e.isOpen&&(0,c.jsx)(i$,{element:e.element,nodeLabel:e.nodeLabel,schema:e.schema})})}let iO=(0,c.jsxs)(j.a,{children:[(0,c.jsx)(function(){let{editor:e,code:{isDisabled:t,isSelected:n}}=ig();return(0,s.useMemo)(()=>(0,c.jsx)(m.Kk,{isSelected:n,isDisabled:t,prominence:"low",onPress:()=>{n?i.YR.unwrapNodes(e,{match:e=>"code"===e.type}):i.YR.wrapNodes(e,{type:"code",children:[{text:""}]}),S.F3.focus(e)},children:(0,c.jsx)(y.J,{src:X.z})}),[t,n,e])},{}),(0,c.jsxs)(j.u,{children:[(0,c.jsx)(f.xv,{children:"Code block"}),(0,c.jsx)(f.Tz,{children:"```"})]})]});function iK({attributes:e,children:t,element:n}){var r;let l=(0,S._7)(),o=(0,s.useRef)(null),[a,d]=(0,s.useState)(n.language?null!==(r=M.a.get(n.language))&&void 0!==r?r:n.language:"Plain text"),[u,p]=(0,s.useState)(!1),{documentFeatures:f}=ix(),g=f.formatting.blockTypes.code&&Object.keys(f.formatting.blockTypes.code.schema.fields).length?f.formatting.blockTypes.code.schema:void 0;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(id,{children:(0,c.jsxs)(io,{element:n,children:[(0,c.jsx)("pre",{spellCheck:"false",ref:o,children:(0,c.jsx)("code",{...e,children:t})}),(0,c.jsx)(ia,{children:(0,c.jsxs)(h.kC,{gap:"regular",padding:"regular",children:[(0,c.jsx)(eg.hQ,{"aria-label":"Language",width:"scale.2000",allowsCustomValue:!0,inputValue:a,onInputChange:d,onBlur:()=>{let e=S.F3.findPath(l,n),t=M.b.get(a);if(void 0!==t){if("plain"===t){i.YR.unsetNodes(l,"language",{at:e});return}d(M.c.get(t)),i.YR.setNodes(l,{language:t},{at:e});return}let r=M.d.get(a);if(void 0!==r){if("plain"===r){i.YR.unsetNodes(l,"language",{at:e});return}i.YR.setNodes(l,{language:r},{at:e});return}if(""===a){i.YR.unsetNodes(l,"language",{at:e}),d("Plain text");return}a!==n.language&&i.YR.setNodes(l,{language:a},{at:e})},onSelectionChange:e=>{let t=S.F3.findPath(l,n);if(M.b.has(a)&&(e=M.b.get(a)),null===e)""===a?i.YR.unsetNodes(l,"language",{at:t}):i.YR.setNodes(l,{language:a},{at:t});else if("string"==typeof e){if("plain"===e){i.YR.unsetNodes(l,"language",{at:t}),d("Plain text");return}i.YR.setNodes(l,{language:e},{at:t});let n=M.c.get(e);n&&d(n)}},selectedKey:n.language?M.b.get(n.language):"plain",items:(0,s.useMemo)(()=>"Plain text"===a||M.d.has(a)?M.e:(0,em.Lu)(M.e,a,{keys:["label","value","aliases"]}),[a]),children:e=>(0,c.jsx)(ef.ck,{children:e.label},e.value)}),(0,c.jsx)(iu,{}),void 0!==g&&(0,c.jsx)(iF,{onPress:()=>p(!0)}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{i.YR.removeNodes(l,{at:S.F3.findPath(l,n)})},children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:"Remove"})]})]})})]})}),void 0!==g&&(0,c.jsx)(iY,{element:n,isOpen:u,nodeLabel:"Code block",schema:g,onDismiss:()=>{p(!1)}})]})}let iT=s.createContext({});function iB({path:e}){let t=(0,s.useContext)(iT),n=t[JSON.stringify(e)];return void 0===n?null:n}function iz({componentBlock:e,element:t,onChange:n,children:r,onRemove:i}){let l;let o=(0,s.useMemo)(()=>rg({kind:"object",fields:e.schema},n,e=>(0,c.jsx)(iB,{path:e})),[n,e]),a=o(t.props),d={};r.forEach(e=>{var n;let r=e.props.children.props.element.propPath;void 0===r?l=e:d[JSON.stringify((n=t.props,r.map(e=>{var t,r;if("string"==typeof e)return n=null===(r=n)||void 0===r?void 0:r[e],e;if(!Array.isArray(n))return n=void 0,"";let i=nE(n);return n=null===(t=n)||void 0===t?void 0:t[e],i[e]})))]=e});let u=e.preview;return(0,c.jsxs)(iT.Provider,{value:d,children:[(0,s.useMemo)(()=>(0,c.jsx)(u,{onRemove:i,...a}),[u,i,a]),(0,c.jsx)("span",{className:(0,N.iv)({caretColor:"transparent","& ::selection":{backgroundColor:"transparent"},overflow:"hidden",width:1,height:1,position:"absolute"}),children:l})]})}function iI(e){var t;let n=(0,S.vt)(),r=(0,s.useMemo)(()=>rj({kind:"object",fields:e.componentBlock.schema},e.elementProps,void 0),[e.componentBlock,e.elementProps]),[i,l]=(0,s.useState)(!1),o=(0,s.useCallback)(()=>{l(!1)},[]),a=(0,s.useCallback)(()=>{l(!0)},[]),d=null!==(t=e.componentBlock.toolbar)&&void 0!==t?t:iD;return(0,c.jsx)(iA,{selected:n,...e.attributes,children:(0,c.jsxs)(h.kC,{gap:"medium",direction:"column",children:[(0,c.jsx)(ic,{children:(0,c.jsx)(f.xv,{casing:"uppercase",color:"neutralSecondary",weight:"medium",size:"small",children:e.componentBlock.label})}),i?(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(iW,{isValid:r,props:e.previewProps,onClose:o}),(0,c.jsx)("div",{className:(0,N.iv)({display:"none"}),children:e.children})]}):(0,c.jsxs)(s.Fragment,{children:[e.renderedBlock,(0,c.jsx)(d,{isValid:r,onRemove:e.onRemove,onShowEditMode:a,props:e.previewProps})]})]})})}let iA=(0,s.forwardRef)(function({children:e,selected:t,...n},r){return(0,c.jsx)("div",{...n,ref:r,className:(0,N.iv)(rM,{position:"relative",paddingInlineStart:N.iK.size.space.xlarge,marginBottom:N.iK.size.space.xlarge,"::before":{display:"block",content:'" "',backgroundColor:t?N.iK.color.alias.borderSelected:N.iK.color.alias.borderIdle,borderRadius:4,width:4,position:"absolute",left:0,top:0,bottom:0,zIndex:1}}),children:e})});function iD({onShowEditMode:e,onRemove:t,isValid:n}){let r=(0,w.qb)(M.l);return(0,c.jsx)(ic,{children:(0,c.jsxs)(h.kC,{direction:"column",gap:"medium",children:[(0,c.jsxs)(h.kC,{alignItems:"center",gap:"regular",style:{userSelect:"none"},children:[(0,c.jsx)(m.Kk,{onPress:()=>e(),children:r.format("edit")}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:t,children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:r.format("delete")})]})]}),!n&&(0,c.jsx)(u.nd,{children:"Contains invalid fields. Please edit."})]})})}function iW({onClose:e,props:t,isValid:n}){let[r,i]=(0,s.useState)(!1);return(0,c.jsxs)(h.kC,{direction:"column",gap:"medium",contentEditable:!1,UNSAFE_className:(0,N.iv)({whiteSpace:"initial"}),children:[(0,c.jsx)(rT,{...t,forceValidation:r}),(0,c.jsx)(m.zx,{alignSelf:"start",tone:"accent",onPress:()=>{n?e():i(!0)},children:"Done"})]})}function iq(e){var t;let n=null!==e.componentBlock.toolbar,r=null!==(t=e.componentBlock.toolbar)&&void 0!==t?t:i_;return(0,c.jsx)("div",{...e.attributes,className:rM,children:n?(0,c.jsxs)(io,{element:e.element,children:[(0,c.jsx)("div",{children:e.renderedBlock}),(0,c.jsx)(ia,{children:(0,c.jsx)(r,{onRemove:e.onRemove,props:e.previewProps})})]}):(0,c.jsx)("div",{children:e.renderedBlock})})}function i_({onRemove:e}){return(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{onPress:e,margin:"regular",children:(0,c.jsx)(y.J,{src:ev.y})}),(0,c.jsx)(j.u,{tone:"critical",children:"Remove"})]})}function iH(e,t){let n=function e(t,n,r){switch(n.kind){case"form":return[];case"child":return[{path:r,options:n.options}];case"conditional":return e(t.value,n.values[t.discriminant],r.concat("value"));case"object":{let i=[];return Object.keys(n.fields).forEach(l=>{i.push(...e(t[l],n.fields[l],r.concat(l)))}),i}case"array":{let i=[];return t.forEach((t,l)=>{i.push(...e(t,n.element,r.concat(l)))}),i}}}(e,{kind:"object",fields:t},[]);return n.length?n:[{path:void 0,options:{kind:"inline",placeholder:""}}]}function iJ(e){if(e.selection){let t=i.ML.above(e,{match:e=>rQ(e)&&"paragraph"!==e.type});if(t&&("component-block-prop"===t[0].type||"component-inline-prop"===t[0].type))return{isInside:!0,componentBlock:i.ML.parent(e,t[1]),prop:t}}return{isInside:!1}}let iV=new WeakMap;function iU(e){let t=new Set([e]),n=!1;for(let e of t)if("form"===e.kind);else if("child"===e.kind){if(n)return!1;n=!0}else if("array"===e.kind){if(function(e){let t=new Set([e]);for(let e of t)if("form"===e.kind);else if("child"===e.kind)return!0;else if("array"===e.kind)t.add(e.element);else if("object"===e.kind)for(let n of Object.values(e.fields))t.add(n);else if("conditional"===e.kind)for(let n of Object.values(e.values))t.add(n);else(0,o.vE)(e);return!1}(e.element))return!1}else if("object"===e.kind)for(let n of Object.values(e.fields))t.add(n);else if("conditional"===e.kind)for(let n of Object.values(e.values))t.add(n);else(0,o.vE)(e);return n}function iZ(e){return(0,c.jsx)("span",{...e.attributes,children:e.children})}function iX(e,t,n){let r=function(e,t){let n=nF({kind:"object",fields:t.schema});return{type:"component-block",component:e,props:n,children:iH(n,t.schema).map(e=>({type:`component-${e.options.kind}-prop`,propPath:e.path,children:["block"===e.options.kind?{type:"paragraph",children:[{text:""}]}:{text:""}]}))}}(n,t[n]);rC(e,r);let l=i.ML.above(e,{match:e=>"component-block"===e.type});if(l){let t=i.ML.start(e,l[1]);i.YR.setSelection(e,{anchor:t,focus:t})}}let iG=({attributes:e,children:t,element:n})=>{let r=(0,S._7)(),[l,a]=rS(r,n),d=ix().componentBlocks,u=d[l.component],h=(0,s.useRef)({__elementToGetPath:n,currentElement:l});(0,s.useEffect)(()=>{h.current={__elementToGetPath:n,currentElement:l}});let p=rR(()=>{let e=S.F3.findPath(r,n);i.YR.removeNodes(r,{at:e})}),f=(0,s.useCallback)(e=>{var t,n;let l=h.current.currentElement.props;t=e(l),n=S.F3.findPath(r,h.current.__elementToGetPath),i.ML.withoutNormalizing(r,()=>{a({props:t});let e=function e(t,n,r,i,l,o){switch(r.kind){case"form":return[];case"child":return[{path:i,prevPath:l,options:r.options}];case"conditional":let a=t.discriminant===n.discriminant;return e(t.value,a?n.value:nF(r.values[t.discriminant]),r.values[t.discriminant],i.concat("value"),a?void 0:null==l?void 0:l.concat("value"),a?void 0:null==o?void 0:o.concat("value"));case"object":{let a=[];for(let s of Object.keys(r.fields))a.push(...e(t[s],n[s],r.fields[s],i.concat(s),null==l?void 0:l.concat(s),null==o?void 0:o.concat(s)));return a}case"array":{let a=[],s=nE(n),d=nE(t);for(let[c,u]of t.entries()){let t;let h=d[c],p=s.indexOf(h);t=-1===p?nF(r.element):n[p],a.push(...e(u,t,r.element,i.concat(c),-1===p?void 0:null==l?void 0:l.concat(p),-1===p?void 0:null==o?void 0:o.concat(h)))}return a}}}(t,l,{kind:"object",fields:u.schema},[],[],[]),s=()=>i.NB.get(r,n),d=s();if(0===e.length){let e=d.children.map((e,t)=>t).reverse();for(let t of e)i.YR.removeNodes(r,{at:[...n,t]});i.YR.insertNodes(r,{type:"component-inline-prop",propPath:void 0,children:[{text:""}]},{at:[...n,0]});return}let c=new Map;for(let[e,t]of d.children.entries())(0,o.hu)("component-block-prop"===t.type||"component-inline-prop"===t.type),c.set(void 0===t.propPath?void 0:JSON.stringify(t.propPath),e);let h=new Set(e);for(let t of e){if(void 0===t.prevPath)continue;let e=JSON.stringify(t.prevPath),l=c.get(e);if(void 0!==l){let a=d.children[l];(0,o.hu)(void 0!==a.propPath),nX(t.path,a.propPath)||i.YR.setNodes(r,{propPath:t.path},{at:[...n,l]}),h.delete(t),c.delete(e)}}let p=s().children.length;for(let e of h)i.YR.insertNodes(r,{type:`component-${e.options.kind}-prop`,propPath:e.path,children:["block"===e.options.kind?{type:"paragraph",children:[{text:""}]}:{text:""}]},{at:[...n,p]}),p++;let f=[];for(let[,e]of c)f.push(i.ML.pathRef(r,[...n,e]));for(let e of f){let t=e.unref();(0,o.hu)(null!==t),i.YR.removeNodes(r,{at:t})}let m=new Map;for(let[t,n]of e.entries())m.set(JSON.stringify(n.path),t);e:for(;;){for(let[e,t]of s().children.entries()){(0,o.hu)("component-block-prop"===t.type||"component-inline-prop"===t.type);let l=m.get(JSON.stringify(t.propPath));if((0,o.hu)(void 0!==l),e!==l){i.YR.moveNodes(r,{at:[...n,e],to:[...n,l]});continue e}}break}})},[a,u,r]),m=(0,s.useMemo)(()=>u?rg({kind:"object",fields:u.schema},f,()=>void 0):()=>{throw Error("expected component block to exist when called")},[u,f]);if(!u)return(0,c.jsxs)("div",{style:{border:"red 4px solid",padding:8},children:[(0,c.jsx)("pre",{contentEditable:!1,style:{userSelect:"none"},children:`The block "${l.component}" no longer exists.

Props:

${JSON.stringify(l.props,null,2)}

Content:`}),t]});let g=m(l.props),v=(0,c.jsx)(iz,{children:t,componentBlock:u,element:l,onChange:f,onRemove:p});return u.chromeless?(0,c.jsx)(iq,{element:n,attributes:e,renderedBlock:v,componentBlock:u,onRemove:p,previewProps:g}):(0,c.jsx)(iI,{attributes:e,children:t,componentBlock:u,onRemove:p,previewProps:g,renderedBlock:v,elementProps:l.props})};function iQ(e){rC(e,{type:"divider",children:[{text:""}]}),i.ML.insertNode(e,{type:"paragraph",children:[{text:""}]})}let i0=(0,c.jsxs)(j.a,{delay:200,children:[(0,c.jsx)(()=>{let{editor:e,dividers:{isDisabled:t}}=ig();return(0,s.useMemo)(()=>(0,c.jsx)(m.Kk,{prominence:"low",isDisabled:t,onPress:()=>{iQ(e)},children:(0,c.jsx)(y.J,{src:eb.$})}),[e,t])},{}),(0,c.jsxs)(j.u,{children:[(0,c.jsx)(f.xv,{children:"Divider"}),(0,c.jsx)(f.Tz,{children:"---"})]})]});function i1({attributes:e,children:t}){let n=(0,S.vt)();return(0,c.jsxs)("div",{...e,style:{caretColor:"transparent"},children:[(0,c.jsx)("hr",{style:{backgroundColor:n?N.iK.color.alias.borderSelected:N.iK.color.alias.borderIdle}}),t]})}let i3=({attributes:e,children:t,element:n})=>{let r=(0,S._7)(),l=n.layout,o=ix().documentFeatures.layouts,a=o.findIndex(e=>e.toString()===l.toString());return(0,c.jsx)("div",{className:rM,...e,children:(0,c.jsxs)(io,{element:n,children:[(0,c.jsx)("div",{className:(0,N.iv)({columnGap:N.iK.size.space.regular,display:"grid"}),style:{gridTemplateColumns:l.map(e=>`${e}fr`).join(" ")},children:t}),(0,c.jsx)(ia,{children:(0,c.jsxs)(h.kC,{padding:"regular",gap:"regular",children:[(0,c.jsx)(V.W,{selectionMode:"single",prominence:"low",density:"compact",onAction:e=>{let t=S.F3.findPath(r,n),l=o[e];i.YR.setNodes(r,{type:"layout",layout:l},{at:t}),S.F3.focus(r)},selectedKeys:-1!==a?[a.toString()]:[],children:o.map((e,t)=>(0,c.jsx)(V.c,{children:function(e){let t=(0,c.jsx)("div",{role:"img",className:(0,N.iv)({display:"grid",gridTemplateColumns:e.map(e=>`${e}fr`).join(" "),gap:2,width:16,height:16}),children:e.map((e,t)=>(0,c.jsx)("div",{className:(0,N.iv)({backgroundColor:"currentcolor",borderRadius:1})},t))});return t}(e)},t))}),(0,c.jsx)(iu,{}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{let e=S.F3.findPath(r,n);i.YR.removeNodes(r,{at:e})},children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:"Remove"})]})]})})]})})},i2=({attributes:e,children:t})=>(0,c.jsx)("div",{className:(0,N.iv)({borderColor:N.iK.color.border.neutral,borderRadius:N.iK.size.radius.regular,borderStyle:"dashed",borderWidth:N.iK.size.border.regular,padding:N.iK.size.space.medium}),...e,children:t}),i6=(e,t)=>{rC(e,[{type:"layout",layout:t,children:[{type:"layout-area",children:[{type:"paragraph",children:[{text:""}]}]}]}]);let n=i.ML.above(e,{match:e=>"layout"===e.type});n&&i.YR.select(e,[...n[1],0])},i8=(0,c.jsx)(y.J,{src:ex.b}),i4=({layouts:e})=>{let{editor:t,layouts:{isSelected:n}}=ig();return(0,s.useMemo)(()=>(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",isSelected:n,onPress:()=>{r2(t,"layout")?i.YR.unwrapNodes(t,{match:e=>"layout"===e.type}):i6(t,e[0]),S.F3.focus(t)},children:i8}),(0,c.jsx)(j.u,{children:"Layouts"})]}),[t,n,e])},i9=(e,t)=>{let n=iy(e),r=r2(e,t)&&("none"===n||n===t);i.ML.withoutNormalizing(e,()=>{i.YR.unwrapNodes(e,{match:ip,split:!0,mode:r?"all":"lowest"}),r||i.YR.wrapNodes(e,{type:t,children:[]},{match:e=>"list-item-content"!==e.type&&rQ(e)})})};function i7(e){let{editor:t,lists:n}=ig();return(0,s.useMemo)(()=>{let r=[];n.ordered.isDisabled&&r.push("ordered"),n.unordered.isDisabled&&r.push("unordered");let i=[];return n.ordered.isSelected&&i.push("ordered"),n.unordered.isSelected&&i.push("unordered"),(0,c.jsx)(V.W,{flexShrink:0,"aria-label":"Lists",selectionMode:"single",buttonLabelBehavior:"hide",density:"compact",prominence:"low",summaryIcon:(0,c.jsx)(y.J,{src:ek.U}),selectedKeys:i,disabledKeys:r,onAction:e=>{let n=`${e}-list`;i9(t,n),S.F3.focus(t)},children:[e.lists.unordered&&(0,c.jsxs)(V.c,{textValue:"Bullet List (- )",children:[(0,c.jsx)(y.J,{src:ek.U}),(0,c.jsx)(f.xv,{children:"Bullet List"}),(0,c.jsx)(f.Tz,{children:"-"})]},"unordered"),e.lists.ordered&&(0,c.jsxs)(V.c,{textValue:"Numbered List (1.)",children:[(0,c.jsx)(y.J,{src:ej.P}),(0,c.jsx)(f.xv,{children:"Numbered List"}),(0,c.jsx)(f.Tz,{children:"1."})]},"ordered")].filter(e=>!1!==e)})},[t,n.ordered.isDisabled,n.ordered.isSelected,n.unordered.isDisabled,n.unordered.isSelected,e.lists.ordered,e.lists.unordered])}function i5(e){return new Promise(t=>{let n=document.createElement("input");n.type="file",n.accept=e;let r=!1;n.onchange=()=>{var e;r=!0;let i=null===(e=n.files)||void 0===e?void 0:e[0];i&&i.arrayBuffer().then(e=>{t({content:new Uint8Array(e),filename:i.name})})};let i=()=>{window.removeEventListener("focus",i),setTimeout(()=>{var e;(null===(e=n.files)||void 0===e?void 0:e.length)!==0||r||t(void 0)},500),[...document.body.childNodes].includes(n)&&document.body.removeChild(n)};n.addEventListener("click",()=>{window.addEventListener("focus",i,!0)}),document.body.appendChild(n),n.click()})}function le(){return i5("image/*")}function lt(e){let[t,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(e){let t=URL.createObjectURL(new Blob([e]));return n(t),()=>URL.revokeObjectURL(t)}n(null)},[e]),t}function ln(e){var t;let{value:n}=e,[r,i]=(0,s.useReducer)(()=>!0,!1),l=of(),o=lt(null===n?null:n.data),a=(0,s.useId)(),p=(0,s.useId)();return(0,c.jsxs)(h.kC,{"aria-describedby":e.description?p:void 0,"aria-labelledby":a,direction:"column",gap:"medium",role:"group",children:[(0,c.jsx)(u.Qy,{id:a,elementType:"span",children:e.label}),e.description&&(0,c.jsx)(f.xv,{size:"small",color:"neutralSecondary",id:p,children:e.description}),(0,c.jsxs)(m.hE,{children:[(0,c.jsx)(m.Kk,{onPress:async()=>{let t=await le();if(t){var n;let r=null===(n=t.filename.match(/\.([^.]+$)/))||void 0===n?void 0:n[1];r&&e.onChange({data:t.content,extension:r,filename:t.filename})}},children:"Choose file"}),null!==n&&(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{e.onChange(null),i()},children:"Remove"})]}),o&&(0,c.jsx)(h.xu,{alignSelf:"start",backgroundColor:"canvas",borderRadius:"regular",border:"neutral",padding:"regular",children:(0,c.jsx)("img",{src:o,alt:"",style:{display:"block",maxHeight:N.iK.size.alias.singleLineWidth,maxWidth:"100%"}})}),l&&null!==n&&(0,c.jsx)(d.nv,{label:"Filename",onChange:t=>{e.onChange({...n,filename:t})},value:n.filename}),(e.forceValidation||r)&&(null===(t=e.validation)||void 0===t?void 0:t.isRequired)&&null===n&&(0,c.jsxs)(u.nd,{children:[e.label," is required"]})]})}let lr=({attributes:e,children:t,element:n})=>{let[r,l]=(0,s.useState)(!1),[o,a]=(0,s.useState)(),d=(0,w.qb)(M.l),u=(0,S._7)(),[p,f]=rS(u,n),v=lt(p.src.content),x=ii(),k=x===n;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(id,{attributes:e,children:[t,(0,c.jsxs)(io,{element:n,children:[(0,c.jsx)("div",{style:{alignItems:"center",display:"flex",flexDirection:"column"},children:(0,c.jsx)(ic,{children:(0,c.jsx)("img",{...e,src:v,alt:p.alt,"data-selected":k,onLoad:e=>{let t=e.target;a(t.width/t.height)},className:(0,N.iv)({boxSizing:"border-box",borderRadius:N.iK.size.radius.regular,display:"block",maxHeight:N.iK.size.scale[3600],maxWidth:"100%",transition:(0,N.eR)("box-shadow"),"&[data-selected=true]":{boxShadow:`0 0 0 ${N.iK.size.border.regular} ${N.iK.color.alias.borderSelected}`}})})})}),(0,c.jsx)(ia,{hideArrow:!0,children:(0,c.jsxs)(h.kC,{gap:"regular",padding:"regular",children:[(0,c.jsxs)(h.kC,{gap:"small",children:[(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>l(!0),children:(0,c.jsx)(y.J,{src:q.g})}),(0,c.jsx)(j.u,{children:d.format("edit")})]}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:async()=>{let e=await le();e&&f({src:e})},children:(0,c.jsx)(y.J,{src:ew.Y})}),(0,c.jsx)(j.u,{children:"Choose file"})]})]}),(0,c.jsx)(h.iz,{orientation:"vertical"}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{i.YR.removeNodes(u,{at:S.F3.findPath(u,n)})},children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:"Remove"})]})]})})]},o)]}),(0,c.jsx)(g.TW,{onDismiss:()=>{l(!1),rw(u)},children:r&&(0,c.jsx)(li,{alt:p.alt,title:p.title,filename:p.src.filename,onSubmit:({alt:e,filename:t,title:n})=>{f({alt:e,title:n,src:{content:p.src.content,filename:t}})}})})]})};function li(e){let{images:t}=ix().documentFeatures;if(!t)throw Error("unexpected image rendered when images are disabled");let n=(0,s.useMemo)(()=>tp(t.schema),[t]),[r,i]=(0,s.useState)({alt:e.alt,title:e.title}),l=(0,s.useMemo)(()=>rg(n,i,()=>void 0),[n])(r),[o,a]=function(e){let t=e.lastIndexOf(".");return -1===t?[e,""]:[e.substring(0,t),e.substring(t+1)]}(e.filename),[u,p]=(0,s.useState)(!1),[v,y]=(0,s.useState)(o),[b,x]=(0,s.useState)(!1),{dismiss:j}=(0,g.SN)(),N=(0,w.qb)(M.l);return(0,c.jsx)(g.Vq,{size:"small",children:(0,c.jsxs)("form",{style:{display:"contents"},onSubmit:t=>{t.target===t.currentTarget&&(t.preventDefault(),p(!0),v&&rj(n,r,void 0)&&(j(),e.onSubmit({alt:r.alt,title:r.title,filename:[v,a].join(".")})))},children:[(0,c.jsx)(f.X6,{children:"Image details"}),(0,c.jsx)(k.VY,{children:(0,c.jsxs)(h.kC,{gap:"large",direction:"column",children:[(0,c.jsx)(d.nv,{label:"File name",onChange:y,onBlur:()=>x(!0),value:v,isRequired:!0,errorMessage:(b||u)&&!v?"Please provide a file name.":void 0,endElement:a?(0,c.jsx)(h.kC,{alignItems:"center",justifyContent:"center",paddingEnd:"regular",children:(0,c.jsxs)(f.xv,{color:"neutralTertiary",children:[".",a]})}):null}),(0,c.jsx)(rT,{forceValidation:u,autoFocus:!0,...l})]})}),(0,c.jsxs)(m.hE,{children:[(0,c.jsx)(m.zx,{onPress:j,children:N.format("cancel")}),(0,c.jsx)(m.zx,{prominence:"high",type:"submit",children:N.format("save")})]})]})})}let ll=(0,c.jsx)(y.J,{src:eM.y}),lo=(0,c.jsxs)(j.a,{children:[(0,c.jsx)(function(){let e=(0,S._7)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(m.Kk,{prominence:"low",onPress:async()=>{let t=await le();t&&i.YR.insertNodes(e,{type:"image",src:t,alt:"",title:"",children:[{text:""}]})},children:ll})})},{}),(0,c.jsx)(j.u,{children:(0,c.jsx)(f.xv,{children:"Image"})})]});function la(e,t){return{start:Math.min(e,t),end:Math.max(e,t)}}function ls(e,t){return e?0===t?[0,0]:[1,t-1]:[0,t]}function ld(e){var t,n,r,l;let o=null===(t=i.ML.above(e,{match:r9("table-cell"),at:null===(n=e.selection)||void 0===n?void 0:n.anchor.path}))||void 0===t?void 0:t[1],a=null===(r=i.ML.above(e,{match:r9("table-cell"),at:null===(l=e.selection)||void 0===l?void 0:l.focus.path}))||void 0===r?void 0:r[1],s=i.ML.above(e,{match:r9("table")});if(e.selection&&s&&i.W_.isElement(s[0].children[0])&&o&&a&&i.y$.equals(o.slice(0,-3),a.slice(0,-3))){let[t,n]=i.ML.edges(e,e.selection);return{tablePath:s[1],table:s[0],singleCell:i.y$.equals(o,a)?i.E9.equals(i.ML.start(e,o),t)&&i.E9.equals(i.ML.end(e,o),n)&&!i.E9.equals(t,n)?"selected":"not-selected":"many",row:la(o[o.length-2]+o[o.length-3],a[a.length-2]+a[o.length-3]),column:la(o[o.length-1],a[a.length-1])}}}let lc=e=>({type:"table-cell",...e?{header:!0}:{},children:[{type:"paragraph",children:[{text:""}]}]});function lu(e){return i.xv.isText(e)?{...e}:{...e,children:e.children.map(lu)}}let lh=e=>{i.YR.insertNodes(e,{type:"table",children:[{type:"table-head",children:[{type:"table-row",children:[lc(!0),lc(!0),lc(!0)]}]},{type:"table-body",children:[{type:"table-row",children:[lc(!1),lc(!1),lc(!1)]},{type:"table-row",children:[lc(!1),lc(!1),lc(!1)]}]}]})},lp=(0,s.createContext)(void 0);function lf(e){let t=(0,S.ui)(),n=ld(t);if(n){var r,l;return(0,c.jsx)(lp.Provider,{value:{cells:"not-selected"===n.singleCell?new Set:function(e,t,n){var r;let l=new Set,o="table-head"===e.children[0].type||"table-body"===e.children[0].type?e.children[0]:void 0;if(!o)return l;let a=(null===(r=e.children[1])||void 0===r?void 0:r.type)==="table-body"?e.children[1]:void 0;for(let e=t.start;e<=t.end;e++){let t=a?0===e?o.children[0]:a.children[e-1]:o.children[e];if(i.W_.isElement(t))for(let e=n.start;e<=n.end;e++)l.add(t.children[e])}return l}(n.table,n.row,n.column),table:n.table,focus:null===(r=i.ML.above(t,{match:r9("table-cell"),at:null===(l=t.selection)||void 0===l?void 0:l.focus.path}))||void 0===r?void 0:r[0]},children:e.children})}return(0,c.jsx)(lp.Provider,{value:void 0,children:e.children})}let lm=(0,s.createContext)({top:new Map,left:new Map}),lg=({attributes:e,children:t,element:n})=>{var r;let l=(0,S._7)(),o=(0,s.useContext)(lp),a=(null==o?void 0:o.table)===n?o:void 0,d=(0,s.useMemo)(()=>{let e=n.children[0];if(!i.W_.isElement(e)||!i.W_.isElement(e.children[0]))return{top:new Map,left:new Map};let t=new Map,r=new Map;for(let[r,l]of e.children[0].children.entries())"table-cell"===l.type&&t.set(l,n.children.every(e=>!!i.W_.isElement(e)&&e.children.every(e=>i.W_.isElement(e)&&(null==a?void 0:a.cells.has(e.children[r])))));for(let e of n.children)if("table-head"===e.type||"table-body"===e.type)for(let t of e.children)"table-row"===t.type&&"table-cell"===t.children[0].type&&r.set(t.children[0],t.children.every(e=>null==a?void 0:a.cells.has(e)));return{top:t,left:r}},[n,a]);return(0,c.jsx)(lm.Provider,{value:d,children:(0,c.jsx)(lp.Provider,{value:a,children:(0,c.jsx)(id,{attributes:e,children:(0,c.jsxs)(io,{element:n,children:[(0,c.jsx)("table",{className:(0,N.iv)({width:"100%",tableLayout:"fixed",position:"relative",borderSpacing:0,"& *::selection":null!=a&&a.cells.size?{backgroundColor:"transparent"}:void 0}),children:t}),(0,c.jsx)(ia,{children:(0,c.jsxs)(h.kC,{gap:"regular",padding:"regular",children:[(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",isSelected:(null===(r=n.children[0])||void 0===r?void 0:r.type)==="table-head",onPress:()=>{let e=S.F3.findPath(l,n);i.ML.withoutNormalizing(l,()=>{if("table-head"===n.children[0].type){i.YR.moveNodes(l,{at:[...e,0,0],to:[...e,1,0]}),i.YR.removeNodes(l,{at:[...e,0]});return}i.YR.insertNodes(l,{type:"table-head",children:[]},{at:[...e,0]}),i.YR.moveNodes(l,{at:[...e,1,0],to:[...e,0,0]})})},children:(0,c.jsx)(y.J,{src:eN.x})}),(0,c.jsx)(j.u,{children:"Header row"})]}),(0,c.jsx)(iu,{}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{i.YR.removeNodes(l,{at:S.F3.findPath(l,n)})},children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:"Remove"})]})]})})]})})})})},lv=({attributes:e,children:t})=>(0,c.jsx)("tbody",{...e,children:t}),ly=({attributes:e,children:t})=>(0,c.jsx)("thead",{...e,children:t}),lb=({attributes:e,children:t,element:n})=>{var r,i;let l=null===(r=(0,s.useContext)(lp))||void 0===r?void 0:r.table;return(0,c.jsx)(lx.Provider,{value:null!==(i=null==l?void 0:l.children.indexOf(n))&&void 0!==i?i:-1,children:(0,c.jsx)("tr",{...e,children:t})})},lx=(0,s.createContext)(-1);function lk({attributes:e,children:t,element:n}){let r=(0,S._7)(),l=(0,s.useContext)(lp),o=(0,s.useContext)(lm),a=null==l?void 0:l.cells.has(n),d="calc(100% + 2px)",u=n.header?"th":"td",h=a?N.iK.color.alias.borderSelected:N.iK.color.alias.borderIdle;return(0,c.jsxs)(u,{className:(0,N.iv)({borderInlineEnd:`1px solid ${h}`,borderBottom:`1px solid ${h}`,borderTop:o.top.has(n)?`1px solid ${h}`:void 0,borderInlineStart:o.left.has(n)?`1px solid ${h}`:void 0,backgroundColor:null!=l&&l.cells.has(n)?N.iK.color.alias.backgroundSelected:n.header?N.iK.color.scale.slate3:void 0,position:"relative",margin:0,padding:N.iK.size.space.regular,fontWeight:"inherit",boxSizing:"border-box",textAlign:"start",verticalAlign:"top"}),...e,children:[a&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{contentEditable:!1,className:(0,N.iv)({position:"absolute",top:-1,insetInlineStart:-1,background:N.iK.color.alias.borderSelected,height:d,width:1})}),(0,c.jsx)("div",{contentEditable:!1,className:(0,N.iv)({position:"absolute",top:-1,insetInlineStart:-1,background:N.iK.color.alias.borderSelected,height:1,width:d})})]}),o.top.has(n)&&(0,c.jsx)(lj,{location:"top",selected:!!o.top.get(n),label:"Select Column",onClick:()=>{let e=S.F3.findPath(r,n),t=i.ML.above(r,{match:r9("table"),at:e});if(!t)return;let l=t[0].children.length-1,o=t[0].children[l];if("table-body"!==o.type)return;let a=e[e.length-1],s=[...t[1],t[0].children.length-1,o.children.length-1,a];i.YR.select(r,{anchor:i.ML.start(r,e),focus:i.ML.end(r,s)})}}),o.left.has(n)&&(0,c.jsx)(lj,{location:"left",selected:!!o.left.get(n),label:"Select Row",onClick:()=>{let e=S.F3.findPath(r,n);i.YR.select(r,{anchor:i.ML.start(r,i.y$.parent(e)),focus:i.ML.end(r,i.y$.parent(e))})}}),o.left.has(n)&&o.top.has(n)&&(0,c.jsx)(lj,{location:"top-left",selected:!!(o.top.get(n)&&o.left.get(n)),label:"Select Table",onClick:()=>{let e=S.F3.findPath(r,n),t=i.ML.above(r,{match:r9("table"),at:e});t&&i.YR.select(r,{anchor:i.ML.start(r,t[1]),focus:i.ML.end(r,t[1])})}}),(0,c.jsx)("div",{children:t}),(null==l?void 0:l.focus)===n&&(0,c.jsx)(lM,{cell:n,table:l.table})]})}function lj(e){let t=(0,s.useContext)(lp),n=(0,S._7)(),{location:r,selected:i}=e;return(0,c.jsxs)("div",{contentEditable:!1,children:[(0,c.jsx)("button",{tabIndex:-1,type:"button",...(0,N.a9)({location:r,selected:i}),className:(0,N.iv)({background:N.iK.color.scale.slate3,border:`1px solid ${N.iK.color.alias.borderIdle}`,margin:0,padding:0,position:"absolute",":hover":{background:N.iK.color.scale.slate4},"::before":{content:'""',inset:-1,position:"absolute"},"&[data-location=top]":{top:-9,insetInlineStart:-1,width:"calc(100% + 2px)",height:8},"&[data-location=left]":{top:-1,insetInlineStart:-9,width:8,height:"calc(100% + 2px)"},"&[data-location=top-left]":{top:-9,insetInlineStart:-9,width:8,height:8},"&:not([data-location=top])":{borderInlineEnd:"none"},"&:not([data-location=left])":{borderBottom:"none"},"&[data-selected=true]":{background:N.iK.color.scale.indigo8,borderColor:N.iK.color.alias.borderSelected}}),style:{visibility:null!=t&&t.focus?"visible":"hidden"},"aria-label":e.label,onClick:()=>{S.F3.focus(n),e.onClick()}}),e.selected&&("top"===e.location?(0,c.jsx)("div",{className:(0,N.iv)({position:"absolute",top:-9,insetInlineEnd:-1,background:N.iK.color.alias.borderSelected,height:8,width:1,zIndex:2})}):(0,c.jsx)("div",{className:(0,N.iv)({position:"absolute",bottom:-1,insetInlineStart:-9,background:N.iK.color.alias.borderSelected,height:1,width:8,zIndex:2})}))]})}let lw={deleteRow:{label:"Delete row",action:(e,t)=>{let n=t.slice(0,-3),r=i.NB.get(e,n);if("table"!==r.type)return;let l="table-head"===r.children[0].type,o=i.y$.parent(t);i.YR.removeNodes(e,{at:l&&0===o[t.length-3]?i.y$.parent(o):o})}},deleteColumn:{label:"Delete column",action:(e,t)=>{let n=t[t.length-1],r=t.slice(0,-3),l=i.NB.get(e,r);"table"===l.type&&i.ML.withoutNormalizing(e,()=>{for(let[t,o]of l.children.entries())if("table-head"===o.type||"table-body"===o.type)for(let l of o.children.keys())i.YR.removeNodes(e,{at:[...r,t,l,n]})})}},insertRowBelow:{label:"Insert row below",action:(e,t)=>{let n=i.NB.get(e,i.y$.parent(t)),r=t.slice(0,-3),l=i.NB.get(e,r);if("table-row"!==n.type||"table"!==l.type)return;let o="table-head"===l.children[0].type,a=[...r,o?1:0,o&&0===t[t.length-3]?0:t[t.length-2]+1];i.ML.withoutNormalizing(e,()=>{i.YR.insertNodes(e,{type:"table-row",children:n.children.map(()=>lc(!1))},{at:a}),i.YR.select(e,[...a,t[t.length-1]])})}},insertColumnRight:{label:"Insert column right",action:(e,t)=>{let n=t[t.length-1]+1,r=t.slice(0,-3),l=i.NB.get(e,r);"table"===l.type&&i.ML.withoutNormalizing(e,()=>{for(let[t,o]of l.children.entries())if("table-head"===o.type||"table-body"===o.type)for(let l of o.children.keys())i.YR.insertNodes(e,lc("table-head"===o.type),{at:[...r,t,l,n]});i.YR.select(e,i.ML.start(e,i.y$.next(t)))})}}};function lM(e){let t=(0,S._7)(),n=N.iK.size.space.small;return(0,c.jsx)("div",{contentEditable:!1,className:(0,N.iv)({top:n,insetInlineEnd:n,position:"absolute"}),children:(0,c.jsxs)(j.a,{children:[(0,c.jsxs)(es.bF,{align:"end",children:[(0,c.jsx)(m.Kk,{prominence:"low",UNSAFE_className:(0,N.iv)({borderRadius:N.iK.size.radius.small,height:"auto",minWidth:0,padding:0,"&::before":{content:'""',inset:`calc(${n} * -1)`,position:"absolute"}}),children:(0,c.jsx)(y.J,{src:Z.i})}),(0,c.jsx)(es.v2,{onAction:n=>{n in lw&&lw[n].action(t,S.F3.findPath(t,e.cell))},items:Object.entries(lw).map(([e,t])=>({...t,key:e})),children:e=>(0,c.jsx)(es.ck,{children:e.label},e.key)})]}),(0,c.jsx)(j.u,{children:"Options"})]})})}let lN=(0,c.jsxs)(j.a,{children:[(0,c.jsx)(()=>{let{editor:e,blockquote:{isDisabled:t,isSelected:n}}=ig();return(0,s.useMemo)(()=>(0,c.jsx)(m.Kk,{prominence:"low",isSelected:n,isDisabled:t,onPress:()=>{lh(e),S.F3.focus(e)},children:(0,c.jsx)(y.J,{src:eS.I})}),[e,t,n])},{}),(0,c.jsx)(j.u,{children:(0,c.jsx)(f.xv,{children:"Table"})})]});function lS({documentFeatures:e,viewState:t}){let n=ix().componentBlocks,r=Object.keys(n).length,i=Object.values(e.formatting.inlineMarks).some(e=>e),l=e.formatting.alignment.center||e.formatting.alignment.end,o=e.formatting.listTypes.unordered||e.formatting.listTypes.ordered;return(0,c.jsxs)(lP,{children:[(0,c.jsxs)(lE,{children:[!!e.formatting.headings.levels.length&&(0,c.jsx)(l$,{headingLevels:e.formatting.headings.levels}),i&&(0,c.jsx)(lO,{marks:e.formatting.inlineMarks}),(l||o)&&(0,c.jsxs)(lR,{children:[l&&(0,c.jsx)(iP,{alignment:e.formatting.alignment}),o&&(0,c.jsx)(i7,{lists:e.formatting.listTypes})]}),(e.dividers||e.links||!!e.images||e.formatting.blockTypes.blockquote||e.tables||!!e.layouts.length||e.formatting.blockTypes.code)&&(0,c.jsxs)(lR,{children:[e.dividers&&i0,e.links&&iR,e.images&&lo,e.formatting.blockTypes.blockquote&&iL,!!e.layouts.length&&(0,c.jsx)(i4,{layouts:e.layouts}),e.formatting.blockTypes.code&&iO,e.tables&&lN]}),(0,c.jsx)(h.xu,{flex:!0})]}),(0,s.useMemo)(()=>t&&(0,c.jsxs)(h.kC,{gap:"xsmall",children:[(0,c.jsx)(iu,{}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.zx,{prominence:"low",onPress:()=>{t.toggle()},children:(0,c.jsx)(y.J,{src:t.expanded?ee.Y:Q.M})}),(0,c.jsx)(j.u,{children:t.expanded?"Collapse":"Expand"})]})]}),[t]),!!r&&(0,c.jsx)(lF,{})]})}let lR=({children:e})=>(0,c.jsx)(h.kC,{gap:"regular",children:e}),lC=({children:e})=>"main"===rD()?(0,c.jsx)("div",{className:(0,N.iv)({boxSizing:"border-box",display:"flex",paddingInline:N.iK.size.space.medium,minWidth:0,maxWidth:800,marginInline:"auto",[N.l0.above.mobile]:{paddingInline:N.iK.size.space.xlarge},[N.l0.above.tablet]:{paddingInline:N.iK.size.space.xxlarge}}),children:e}):(0,c.jsx)("div",{className:(0,N.iv)({display:"flex"}),children:e}),lP=({children:e})=>{let t=rD();return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{"data-layout":t,className:(0,N.iv)({backdropFilter:"blur(8px)",backgroundClip:"padding-box",backgroundColor:`color-mix(in srgb, transparent, ${N.iK.color.background.canvas} 90%)`,borderBottom:`${N.iK.size.border.regular} solid color-mix(in srgb, transparent, ${N.iK.color.foreground.neutral} 10%)`,borderStartEndRadius:N.iK.size.radius.medium,borderStartStartRadius:N.iK.size.radius.medium,minWidth:0,position:"sticky",top:0,zIndex:2,'&[data-layout="main"]':{borderRadius:0}}),children:(0,c.jsx)(lC,{children:e})})})},lE=e=>{let t=rD();return(0,c.jsx)(h.kC,{"data-layout":t,paddingY:"regular",paddingX:"medium",gap:"large",flex:!0,minWidth:0,UNSAFE_className:(0,N.iv)({msOverflowStyle:"none",scrollbarWidth:"none",overflowX:"auto","&::-webkit-scrollbar":{display:"none"},'&[data-layout="main"]':{paddingInline:0}}),...e})},lL=new Map([["normal","normal"],["1",1],["2",2],["3",3],["4",4],["5",5],["6",6]]),l$=({headingLevels:e})=>{let{editor:t,textStyles:n}=ig(),r=0===n.allowedHeadingLevels.length,l=(0,s.useMemo)(()=>{let t=[{name:"Paragraph",id:"normal"}];return e.forEach(e=>{t.push({name:`Heading ${e}`,id:e.toString()})}),t},[e]),o=n.selected.toString();return(0,s.useMemo)(()=>(0,c.jsx)(ed.cW,{flexShrink:0,width:"scale.1700",prominence:"low","aria-label":"Text block",items:l,isDisabled:r,selectedKey:o,onSelectionChange:e=>{let n=lL.get(e);"normal"===n?i.ML.withoutNormalizing(t,()=>{i.YR.unsetNodes(t,"level",{match:e=>"heading"===e.type}),i.YR.setNodes(t,{type:"paragraph"},{match:e=>"heading"===e.type})}):n&&i.YR.setNodes(t,{type:"heading",level:n},{match:e=>"paragraph"===e.type||"heading"===e.type}),S.F3.focus(t)},children:e=>(0,c.jsx)(V.c,{children:e.name},e.id)}),[t,r,l,o])};function lF(){let e=rD(),t=(0,S._7)(),n=ix().componentBlocks;return(0,c.jsxs)(es.bF,{align:"end",children:[(0,c.jsxs)(j.a,{children:[(0,c.jsxs)(m.Kk,{marginY:"regular",marginEnd:"main"===e?void 0:"medium",children:[(0,c.jsx)(y.J,{src:et.R}),(0,c.jsx)(y.J,{src:Z.i})]}),(0,c.jsxs)(j.u,{children:[(0,c.jsx)(f.xv,{children:"Insert"}),(0,c.jsx)(f.Tz,{children:"/"})]})]}),(0,c.jsx)(es.v2,{onAction:e=>{iX(t,n,e)},items:Object.entries(n),children:([e,t])=>(0,c.jsx)(V.c,{children:t.label},e)})]})}let lY=[{key:"bold",label:"Bold",icon:U.r,shortcut:"B"},{key:"italic",label:"Italic",icon:G.Z,shortcut:"I"},{key:"underline",label:"Underline",icon:ea.Q,shortcut:"U"},{key:"strikethrough",label:"Strikethrough",icon:er.U},{key:"code",label:"Code",icon:X.z},{key:"superscript",label:"Superscript",icon:el.Y},{key:"subscript",label:"Subscript",icon:ei.N},{key:"clearFormatting",label:"Clear formatting",icon:en.v}];function lO({marks:e}){let{editor:t,clearFormatting:{isDisabled:n},marks:r}=ig(),l=lK(e),o=lK(Object.keys(r).filter(e=>r[e].isSelected)),a=lK(Object.keys(r).filter(e=>r[e].isDisabled).concat(n?"clearFormatting":[]));return(0,s.useMemo)(()=>{let e=lY.filter(e=>"clearFormatting"===e.key||l[e.key]);return(0,c.jsx)(V.W,{UNSAFE_className:(0,N.iv)({minWidth:`calc(${N.iK.size.element.medium} * 4)`}),prominence:"low",density:"compact",buttonLabelBehavior:"hide",overflowMode:"collapse",summaryIcon:(0,c.jsx)(y.J,{src:eo.R}),items:e,selectionMode:"multiple",selectedKeys:o,disabledKeys:a,onAction:e=>{if("clearFormatting"===e)r6(t);else{var n;null!==(n=i.ML.marks(t))&&void 0!==n&&n[e]?i.ML.removeMark(t,e):i.ML.addMark(t,e,!0)}S.F3.focus(t)},children:e=>(0,c.jsxs)(V.c,{textValue:e.label,children:[(0,c.jsx)(f.xv,{children:e.label}),"shortcut"in e&&(0,c.jsx)(f.Tz,{meta:!0,children:e.shortcut}),(0,c.jsx)(y.J,{src:e.icon})]},e.key)})},[a,t,l,o])}function lK(e){return(0,s.useMemo)(()=>e,[JSON.stringify(e)])}let lT=({attributes:e,children:t,element:n})=>{let r=`h${n.level}`,l=(0,S._7)(),{documentFeatures:o}=ix(),[a,d]=(0,s.useState)(!1);return 0===Object.keys(o.formatting.headings.schema.fields).length?(0,c.jsx)(r,{...e,style:{textAlign:n.textAlign},children:t}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r,{style:{textAlign:n.textAlign},children:(0,c.jsxs)(io,{element:n,children:[(0,c.jsx)("div",{children:t}),(0,c.jsx)(ia,{children:(0,c.jsxs)(h.kC,{gap:"regular",padding:"regular",children:[(0,c.jsx)(iF,{onPress:()=>d(!0)}),(0,c.jsxs)(j.a,{children:[(0,c.jsx)(m.Kk,{prominence:"low",onPress:()=>{i.YR.removeNodes(l,{at:S.F3.findPath(l,n)})},children:(0,c.jsx)(y.J,{src:b.S})}),(0,c.jsx)(j.u,{tone:"critical",children:"Remove"})]})]})})]})}),(0,c.jsx)(iY,{element:n,schema:o.formatting.headings.schema,isOpen:a,nodeLabel:"Heading",onDismiss:()=>d(!1)})]})},lB=e=>{switch(e.element.type){case"layout":return(0,c.jsx)(i3,{attributes:e.attributes,children:e.children,element:e.element});case"layout-area":return(0,c.jsx)(i2,{...e});case"code":return(0,c.jsx)(iK,{attributes:e.attributes,children:e.children,element:e.element});case"component-block":return(0,c.jsx)(iG,{attributes:e.attributes,children:e.children,element:e.element});case"component-inline-prop":case"component-block-prop":return(0,c.jsx)(iZ,{...e});case"heading":return(0,c.jsx)(lT,{attributes:e.attributes,children:e.children,element:e.element});case"link":return(0,c.jsx)(iM,{attributes:e.attributes,children:e.children,element:e.element});case"ordered-list":return(0,c.jsx)("ol",{...e.attributes,children:e.children});case"unordered-list":return(0,c.jsx)("ul",{...e.attributes,children:e.children});case"list-item":return(0,c.jsx)("li",{...e.attributes,children:e.children});case"list-item-content":return(0,c.jsx)("span",{...e.attributes,children:e.children});case"blockquote":return(0,c.jsx)("blockquote",{...e.attributes,children:e.children});case"divider":return(0,c.jsx)(i1,{...e});case"image":return(0,c.jsx)(lr,{attributes:e.attributes,children:e.children,element:e.element});case"table":return(0,c.jsx)(lg,{attributes:e.attributes,children:e.children,element:e.element});case"table-head":return(0,c.jsx)(ly,{attributes:e.attributes,children:e.children,element:e.element});case"table-body":return(0,c.jsx)(lv,{attributes:e.attributes,children:e.children,element:e.element});case"table-row":return(0,c.jsx)(lb,{attributes:e.attributes,children:e.children,element:e.element});case"table-cell":return(0,c.jsx)(lk,{attributes:e.attributes,children:e.children,element:e.element});default:let{textAlign:t}=e.element;return(0,c.jsx)("p",{style:{textAlign:t},...e.attributes,children:e.children})}};function lz(e,t,n){let r=S.F3.findPath(e,t);i.YR.delete(e,{at:{focus:i.ML.start(e,r),anchor:i.ML.end(e,r)}}),n.insert(e)}function lI({children:e,text:t}){let n=ig(),{editor:r}=n,{componentBlocks:l}=ix(),o=(0,em.Lu)(function(e,t){let n=[...Object.keys(t).map(e=>({label:t[e].label,insert:n=>{iX(n,t,e)}})),...e.textStyles.allowedHeadingLevels.filter(t=>e.editorDocumentFeatures.formatting.headings.levels.includes(t)).map(e=>({label:`Heading ${e}`,insert(t){rC(t,{type:"heading",level:e,children:[{text:""}]})}})),!e.blockquote.isDisabled&&e.editorDocumentFeatures.formatting.blockTypes.blockquote&&{label:"Blockquote",insert(e){rC(e,{type:"blockquote",children:[{text:""}]})}},!e.code.isDisabled&&e.editorDocumentFeatures.formatting.blockTypes.code&&{label:"Code block",insert(e){rC(e,{type:"code",children:[{text:""}]})}},!!e.editorDocumentFeatures.images&&{label:"Image",async insert(e){let t=await le();t&&rC(e,{type:"image",src:t,alt:"",title:"",children:[{text:""}]})}},!!e.editorDocumentFeatures.tables&&{label:"Table",insert:lh},!e.dividers.isDisabled&&e.editorDocumentFeatures.dividers&&{label:"Divider",insert(e){rC(e,{type:"divider",children:[{text:""}]})}},!!e.editorDocumentFeatures.layouts.length&&{label:"Layout",insert(t){i6(t,e.editorDocumentFeatures.layouts[0])}},!e.lists.ordered.isDisabled&&e.editorDocumentFeatures.formatting.listTypes.ordered&&{label:"Numbered List",keywords:["ordered list"],insert(e){rC(e,{type:"ordered-list",children:[{text:""}]})}},!e.lists.unordered.isDisabled&&e.editorDocumentFeatures.formatting.listTypes.unordered&&{label:"Bullet List",keywords:["unordered list"],insert(e){rC(e,{type:"unordered-list",children:[{text:""}]})}}];return n.filter(e=>"boolean"!=typeof e)}(n,l),t.text.slice(1),{keys:["label","keywords"]}).map((e,t)=>({...e,index:t})),a=(0,s.useRef)({options:o,text:t});(0,s.useEffect)(()=>{a.current={options:o,text:t}});let d=(0,s.useRef)(e=>{});(0,s.useEffect)(()=>{d.current=e=>{if(!e.defaultPrevented)switch(e.key){case"ArrowDown":a.current.options.length&&(e.preventDefault(),g.selectionManager.setFocused(!0),g.selectionManager.setFocusedKey((Number(g.selectionManager.focusedKey)===a.current.options.length-1?0:Number(g.selectionManager.focusedKey)+1).toString()));return;case"ArrowUp":a.current.options.length&&(e.preventDefault(),g.selectionManager.setFocused(!0),g.selectionManager.setFocusedKey(("0"===g.selectionManager.focusedKey?a.current.options.length-1:Number(g.selectionManager.focusedKey)-1).toString()));return;case"Enter":{let t=a.current.options[Number(g.selectionManager.focusedKey)];t&&(lz(r,a.current.text,t),e.preventDefault());return}case"Escape":{let t=S.F3.findPath(r,a.current.text);i.YR.unsetNodes(r,"insertMenu",{at:t}),e.preventDefault();return}}}}),(0,s.useEffect)(()=>{let e=S.F3.toDOMNode(r,r),t=e=>d.current(e);return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}},[r]);let u=(0,s.useRef)(null),h=(0,F.d)({isOpen:!0}),{triggerProps:{onPress:p,...f},overlayProps:m}=(0,L.IB)({type:"listbox"},h,u),g=(0,eC.n_)({items:o,children:e=>(0,c.jsx)(eP.ck,{children:e.label},e.index)});(0,s.useEffect)(()=>{!g.selectionManager.isFocused&&g.collection.size&&(g.selectionManager.setFocused(!0),g.selectionManager.setFocusedKey("0"))},[g]);let v=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;let t=null===(e=v.current)||void 0===e||null===(e=e.querySelector('[role="listbox"] [role="presentation"]'))||void 0===e?void 0:e.children[g.selectionManager.focusedKey];t&&(0,eR.Z)(t,{scrollMode:"if-needed",boundary:v.current,block:"nearest"})},[g.selectionManager.focusedKey]);let y=(0,s.useRef)(null),b=(0,eP.vG)(g);return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)("span",{...f,role:"button",className:(0,N.iv)({color:N.iK.color.foreground.accent,fontWeight:N.iK.typography.fontWeight.medium}),ref:u,children:e}),(0,c.jsx)(O.J2,{width:"alias.singleLineWidth",placement:"bottom start",isNonModal:!0,hideArrow:!0,...m,state:h,triggerRef:u,children:(0,c.jsx)("div",{className:(0,N.iv)({overflow:"scroll",maxHeight:300}),ref:v,children:(0,c.jsx)(eP.W5,{"aria-label":"Insert block",state:g,shouldUseVirtualFocus:!0,layout:b,ref:y,onAction:e=>{lz(r,t,o[e])}})})})]})}let lA=new WeakSet,lD=new WeakSet;function lW(e){var t;let n=function e(t,n){if(i.xv.isText(t))return t.insertMenu?n:void 0;if(!lA.has(t.children)){for(let[r,i]of t.children.entries()){if(lD.has(i))continue;let t=e(i,[...n,r]);if(t)return t;lD.add(i)}lA.add(t.children)}}(e,[]);return!(!n||null!==(t=i.ML.marks(e))&&void 0!==t&&t.insertMenu||e.selection&&i.y$.equals(e.selection.anchor.path,n)&&i.y$.equals(e.selection.focus.path,n))&&(i.YR.unsetNodes(e,"insertMenu",{at:n}),!0)}function lq({placeholder:e,children:t}){let[n,r]=(0,s.useState)(0);return(0,c.jsxs)("span",{className:(0,N.iv)({position:"relative",display:"inline-block",width:n}),children:[(0,c.jsx)("span",{contentEditable:!1,className:(0,N.iv)({position:"absolute",pointerEvents:"none",display:"inline-block",left:0,top:0,maxWidth:"100%",whiteSpace:"nowrap",opacity:"0.5",userSelect:"none",fontStyle:"normal",fontWeight:"normal",textDecoration:"none",textAlign:"left"}),children:(0,c.jsx)("span",{ref:e=>{if(e){let t=e.offsetWidth;t!==n&&r(t)}},children:e})}),t]})}let l_=({leaf:e,text:t,children:n,attributes:r})=>{let{underline:i,strikethrough:l,bold:o,italic:a,code:s,keyboard:d,superscript:u,subscript:h,placeholder:p,insertMenu:f,...m}=e;void 0!==p&&(n=(0,c.jsx)(lq,{placeholder:p,children:n})),f&&(n=(0,c.jsx)(lI,{text:t,children:n})),s&&(n=(0,c.jsx)("code",{children:n})),o&&(n=(0,c.jsx)("strong",{children:n})),l&&(n=(0,c.jsx)("s",{children:n})),a&&(n=(0,c.jsx)("em",{children:n})),d&&(n=(0,c.jsx)("kbd",{children:n})),u&&(n=(0,c.jsx)("sup",{children:n})),h&&(n=(0,c.jsx)("sub",{children:n})),i&&(n=(0,c.jsx)("u",{children:n}));let g=Object.keys(m).filter(e=>e.startsWith("prism_")).map(e=>lJ.get(e.replace("prism_","")));if(g.length){let e=g.join(" ");n=(0,c.jsx)("span",{className:e,children:n})}return(0,c.jsx)("span",{...r,children:n})},lH=e=>(0,c.jsx)(l_,{...e}),lJ=new Map([{types:["comment","prolog","doctype","cdata"],style:{color:N.iK.color.foreground.neutralTertiary,fontStyle:"italic"}},{types:["atrule","attr-name","class-name","selector"],style:{color:N.iK.color.scale.amber11}},{types:["boolean","constant","inserted-sign","entity","inserted","number","regex","symbol","variable"],style:{color:N.iK.color.scale.green11}},{types:["attr-value","builtin","char","constant","generics","url"],style:{color:N.iK.color.scale.pink11}},{types:["string"],style:{color:N.iK.color.scale.indigo9}},{types:["annotation","deleted","deleted-sign","decorator","important","tag"],style:{color:N.iK.color.scale.red11}},{types:["function","function-variable","operator"],style:{color:N.iK.color.scale.purple11}},{types:["tag","selector","keyword"],style:{color:N.iK.color.scale.indigo11}},{types:["punctuation"],style:{color:N.iK.color.foreground.neutralSecondary}}].flatMap(e=>{let t=(0,N.iv)(e.style);return e.types.map(e=>[e,t])})),lV=/^```(\w+)? ?$/,lU=()=>({type:"paragraph",children:[{text:""}]}),lZ=/(^|\s)\[(.+?)\]\((\S+)\)$/;function lX(e,t,n){return function(e){let{normalizeNode:t}=e;return e.normalizeNode=([n,r])=>{if(!i.xv.isText(n)&&"link"!==n.type){let t=i.ML.isEditor(n)?"editor":n.type;if("string"!=typeof t||void 0===rZ[t]){i.YR.unwrapNodes(e,{at:r});return}let l=rZ[t];if("blocks"===l.kind&&0!==n.children.length&&n.children.every(e=>!rQ(e))){i.YR.wrapNodes(e,{type:l.blockToWrapInlinesIn,children:[]},{at:r,match:e=>!rQ(e)});return}let o=!1;for(let[t,a]of[...n.children.entries()].reverse()){let n=[...r,t];if("inlines"===l.kind){if(!i.xv.isText(a)&&rQ(a)){lG(e,[a,n],r),o=!0;continue}}else{if(!rQ(a)){i.YR.wrapNodes(e,{type:l.blockToWrapInlinesIn,children:[]},{at:n}),o=!0;continue}if(!l.allowedChildren.has(a.type)){lG(e,[a,n],r),o=!0;continue}}}if(o)return}t([n,r])},e}(function(e){let{normalizeNode:t}=e;return e.normalizeNode=n=>{let[r,l]=n;if(i.ML.isEditor(r)){let t=r.children[r.children.length-1];if((null==t?void 0:t.type)!=="paragraph"){i.YR.insertNodes(e,lU(),{at:[...l,r.children.length]});return}}t(n)},e}(function(e,t,n){let{insertText:r,isInline:l,normalizeNode:o}=n;return n.isInline=e=>"link"===e.type||l(e),e.links&&(n.insertText=l=>{if(r(l),")"!==l||!n.selection)return;let o=i.ML.start(n,i.ML.above(n,{match:rQ})[1]),a=i.ML.string(n,{anchor:n.selection.anchor,focus:o}),s=lZ.exec(a);if(!s)return;let d=r7(n,e,t);if((null==d?void 0:d.documentFeatures.links)===!1)return;let[,c,u,h]=s;n.history.undos.push({operations:[],selectionBefore:n.selection});let p=0===s.index?o:r4(n,o,{distance:s.index}),f=r4(n,p,{distance:""===c?1:2}),m=r4(n,f,{distance:u.length});i.YR.delete(n,{at:{anchor:m,focus:n.selection.anchor}}),i.YR.delete(n,{at:{anchor:p,focus:f}}),i.YR.wrapNodes(n,{type:"link",href:h,children:[]},{at:{anchor:n.selection.anchor,focus:p},split:!0});let g=i.ML.next(n);g&&i.YR.select(n,g[1])}),n.normalizeNode=([e,t])=>{var r;if("link"===e.type){if(""===i.NB.string(e)){i.YR.unwrapNodes(n,{at:t});return}for(let[r,l]of e.children.entries())if("link"===l.type){i.YR.unwrapNodes(n,{at:[...t,r]});return}}if(void 0!==e.type&&rX.has(e.type)){let l=null;for(let[o,a]of e.children.entries()){if("link"===a.type&&a.href===(null===(r=l)||void 0===r?void 0:r.node.href)){let e=[...t,l.index],r=[...t,o],s=[...e,l.node.children.length];for(let e=a.children.length-1;e>=0;e--){let t=[...r,e];i.YR.moveNodes(n,{at:t,to:s})}i.YR.removeNodes(n,{at:r});return}i.xv.isText(a)&&""===a.text||(l=null),"link"===a.type&&(l={index:o,node:a})}}o([e,t])},n}(t,n,function(e){let{insertBreak:t,normalizeNode:n,deleteBackward:r}=e;return e.deleteBackward=t=>{if(e.selection){let t=function(e){if(e.selection){let t=i.ML.above(e,{match:r9("list-item")}),n=i.ML.above(e,{match:ip});if(t&&n)return{isInside:!0,listItem:t,list:n}}return{isInside:!1}}(e);if(t.isInside&&i.e6.isCollapsed(e.selection)&&i.ML.isStart(e,e.selection.anchor,t.list[1])){i.YR.unwrapNodes(e,{match:ip,split:!0});return}}r(t)},e.insertBreak=()=>{let[n]=i.ML.nodes(e,{match:e=>"list-item"===e.type,mode:"lowest"});if(n&&""===i.NB.string(n[0])){i.YR.unwrapNodes(e,{match:ip,split:!0});return}t()},e.normalizeNode=t=>{let[r,l]=t;if(i.W_.isElement(r)||i.ML.isEditor(r)){let t=ip(r);for(let[n,a]of i.NB.children(e,l)){let s=a[a.length-1];if(ip(n)){var o;if((null===(o=r.children[a[a.length-1]+1])||void 0===o?void 0:o.type)===n.type){let t=i.y$.next(a);r8(e,t,[...a,n.children.length]),i.YR.removeNodes(e,{at:t});return}if(t){let t=r.children[s-1];i.W_.isElement(t)?i.YR.moveNodes(e,{at:a,to:[...i.y$.previous(a),t.children.length-1]}):i.YR.unwrapNodes(e,{at:a});return}}if("list-item"===r.type&&"list-item-content"!==n.type&&0===s&&rQ(n)){if(0!==l[l.length-1]){let t=i.NB.get(e,i.y$.previous(l));if(i.W_.isElement(t)){i.YR.moveNodes(e,{at:l,to:[...i.y$.previous(l),t.children.length]});return}}i.YR.unwrapNodes(e,{at:a});return}if("list-item"===r.type&&"list-item-content"===n.type&&0!==s){i.YR.splitNodes(e,{at:a});return}}}n(t)},e}(function(e){let{deleteFragment:t,normalizeNode:n,getFragment:r,insertFragment:l,deleteBackward:o}=e;return e.insertFragment=t=>{let n=ld(e);if(!n||1!==t.length||"table"!==t[0].type){l(t);return}let r=t[0].children.flatMap(e=>"table-head"===e.type||"table-body"===e.type?e.children:[]);if(!r.every(r9("table-row"))){l(t);return}let{row:o,column:a,tablePath:s,table:d}=n,c=n.table.children[1===n.table.children.length?0:1];if("table-row"!==r[0].type||"table-body"!==c.type||"table-row"!==c.children[0].type){l(t);return}let u="table-head"===d.children[0].type;"many"!==n.singleCell&&(o={start:o.start,end:Math.min(o.start+r.length-1,c.children.length-1+(u?1:0))},a={start:a.start,end:Math.min(a.start+r[0].children.length-1,c.children[0].children.length-1)}),i.ML.withoutNormalizing(e,()=>{for(let t=o.start;t<=o.end;t++){let n=r[(t-o.start)%r.length];for(let r=a.start;r<=a.end;r++){let l=[...ls(u,t),r],o=i.NB.get(d,l),c=n.children[(r-a.start)%n.children.length];if("table-cell"!==o.type||"table-cell"!==c.type)continue;let h=[...s,...l];for(let t of[...o.children.keys()].reverse())i.YR.removeNodes(e,{at:[...h,t]});i.YR.insertNodes(e,c.children.map(lu),{at:[...h,0]})}}i.YR.setSelection(e,{anchor:i.ML.start(e,[...s,...ls(u,o.start),a.start]),focus:i.ML.end(e,[...s,...ls(u,o.end),a.end])})})},e.deleteBackward=t=>{if(e.selection&&i.e6.isCollapsed(e.selection)&&0===e.selection.anchor.offset){let t=i.ML.above(e,{match:r9("table-cell")});if(t&&"paragraph"===t[0].children[0].type&&void 0===t[0].children[0].children[0].type&&i.y$.equals(e.selection.anchor.path,[...t[1],0,0]))return}o(t)},e.getFragment=()=>{let t=ld(e);if(t&&"not-selected"!==t.singleCell){var n;let{table:e}=t,i="table-head"===e.children[0].type||"table-body"===e.children[0].type?e.children[0]:void 0;if(!i)return r();let l=(null===(n=e.children[1])||void 0===n?void 0:n.type)==="table-body"?e.children[1]:void 0,o=l||i,a="table-head"===i.type,s=0===t.row.start&&!!l,d=t.column.end-t.column.start+1;return[{type:"table",children:[...s?[{type:"table-head",children:[{type:"table-row",children:Array.from({length:d}).map((e,n)=>i.children[0].children[n+t.column.start])}]}]:[],{type:"table-body",children:Array.from({length:t.row.end-t.row.start+(s?0:1)}).map((e,n)=>({type:"table-row",children:Array.from({length:d}).map((e,r)=>o.children[n+t.row.start-(a&&!s?1:0)].children[r+t.column.start])}))}]}]}return r()},e.deleteFragment=n=>{if(!e.selection||i.e6.isCollapsed(e.selection)){t(n);return}let r=ld(e);if(!r||"not-selected"===r.singleCell){t(n);return}let l=r.table.children[0];if(!i.W_.isElement(l)||!i.W_.isElement(l.children[0])){t(n);return}let o=r.table.children.reduce((e,t)=>e+("table-head"===t.type||"table-body"===t.type?t.children.length:0),0)-1,{row:a,column:s,tablePath:d}=r,c=0===a.start&&a.end===o,u=0===s.start&&s.end===l.children[0].children.length-1;if(c&&u){i.YR.removeNodes(e,{at:d});return}let h="table-head"===l.type;if(u){i.ML.withoutNormalizing(e,()=>{for(let t=a.end;t>=a.start;t--){if(h){if(0===t){i.YR.removeNodes(e,{at:[...d,0]});continue}i.YR.removeNodes(e,{at:[...d,1,t-1]});continue}i.YR.removeNodes(e,{at:[...d,0,t]})}});return}if(c){i.ML.withoutNormalizing(e,()=>{for(let t=s.end;t>=s.start;t--)for(let n=0;n<=o;n++)i.YR.removeNodes(e,{at:[...d,...ls(h,n),t]});let t=[...d,0,0,s.start],n=i.ML.start(e,0===s.start?t:i.y$.previous(t));i.YR.select(e,n)});return}let p=i.ML.start(e,e.selection).path;i.ML.withoutNormalizing(e,()=>{for(let t=a.start;t<=a.end;t++)for(let n=s.start;n<=s.end;n++){let l=[...ls(h,t),n],o=i.NB.get(r.table,l);if(!i.W_.isElement(o))continue;let a=[...d,...l];for(let t of(i.YR.insertNodes(e,{type:"paragraph",children:[{text:""}]},{at:[...a,0]}),[...o.children.keys()].reverse()))i.YR.removeNodes(e,{at:[...a,t+1]})}i.YR.select(e,p)})},e.normalizeNode=t=>{let[r,l]=t;if("table-head"===r.type&&r.children.length>1){r8(e,l,i.y$.next(l),(e,t)=>0!==t);return}let o=!1;for(let t of["table-body","table-head"])if(r.type===t){for(let[n,a]of r.children.entries())if("table-row"===a.type){for(let[r,s]of a.children.entries())if("table-cell"===s.type){let a=[...l,n,r];s.header&&"table-body"===t&&(i.YR.unsetNodes(e,"header",{at:a}),o=!0),s.header||"table-head"!==t||(i.YR.setNodes(e,{header:!0},{at:a}),o=!0)}}}if(!o){if("table"===r.type){let t=r.children.reduce((e,t)=>"table-head"===t.type||"table-body"===t.type?t.children.reduce((e,t)=>"table-row"===t.type?Math.max(e,t.children.length):e,e):e,0),n=!1;for(let[o,a]of r.children.entries())if("table-body"===a.type||"table-head"===a.type)for(let[r,s]of a.children.entries())"table-row"===s.type&&s.children.length!==t&&(i.YR.insertNodes(e,Array.from({length:t-s.children.length},()=>lc("table-head"===a.type)),{at:[...l,o,r,s.children.length]}),n=!0);if(n)return;if(1===r.children.length&&"table-head"===r.children[0].type){i.YR.insertNodes(e,{type:"table-body",children:Array.from({length:r.children[0].children.length},()=>lc(!1))},{at:[...l,1]});return}if(2===r.children.length&&"table-head"===r.children[1].type){i.YR.moveNodes(e,{at:[...l,1],to:[...l,0]});return}if(r.children.length>2){r8(e,l,i.y$.next(l),(e,t)=>0!==t&&1!==t);return}}n(t)}},e}(function(e,t,n){let r=(0,ey.Z)(e=>r0(t,e)),{normalizeNode:a,deleteBackward:s,insertBreak:d}=n;return n.deleteBackward=e=>{if(n.selection){let e=iJ(n);if(e.isInside&&i.e6.isCollapsed(n.selection)&&i.ML.isStart(n,n.selection.anchor,e.prop[1])&&0===e.prop[1][e.prop[1].length-1]){i.YR.unwrapNodes(n,{at:e.componentBlock[1]});return}}s(e)},n.insertBreak=()=>{let t=iJ(n);if(n.selection&&t.isInside){let{prop:[r,l],componentBlock:[a,s]}=t,c=l[l.length-1]===a.children.length-1;if("component-block-prop"===r.type){let[[e,l]]=i.ML.nodes(n,{match:e=>"paragraph"===e.type}),o=l[l.length-1]===r.children.length-1;if(""===i.NB.string(e)&&o){c?i.YR.moveNodes(n,{at:l,to:i.y$.next(t.componentBlock[1])}):(i.YR.move(n,{distance:1,unit:"line"}),i.YR.removeNodes(n,{at:l}));return}}if("component-inline-prop"===r.type){i.ML.withoutNormalizing(n,()=>{let t=e[a.component];if(void 0!==r.propPath&&void 0!==t){let e={kind:"object",fields:t.schema},u=function(e,t,n){let r=[],i=[...t],l=e,a=n;for(;i.length;){r.push(l);let e=i.shift();if("array"===l.kind)l=l.element,a=a[e];else if("conditional"===l.kind)l=l.values[n.discriminant],a=a.value;else if("object"===l.kind)a=a[e],l=l.fields[e];else if("child"===l.kind||"form"===l.kind)throw Error(`unexpected prop "${e}"`);else(0,o.vE)(l)}return r}(e,r.propPath,a.props),h=[...u].reverse().findIndex(e=>"array"===e.kind);if(-1!==h){let e=u.length-1-h,t=u[e];(0,o.hu)("array"===t.kind);let p=nK(a.props,r.propPath.slice(0,e));if(iU(t.element)){""===i.NB.string(r)&&p.length-1===r.propPath[e]?(i.YR.removeNodes(n,{at:l}),c?(i.YR.insertNodes(n,{type:"paragraph",children:[{text:""}]},{at:i.y$.next(s)}),i.YR.select(n,i.y$.next(s))):i.YR.move(n,{distance:1,unit:"line"})):d();return}}}i.YR.splitNodes(n,{always:!0});let u=i.y$.next(l);c?i.YR.moveNodes(n,{at:u,to:i.y$.next(s)}):(r8(n,u,[...i.y$.next(u),0]),i.YR.removeNodes(n,{at:u}))});return}}d()},n.normalizeNode=t=>{let[s,d]=t;if("component-inline-prop"===s.type&&!s.propPath&&(1!==s.children.length||!i.xv.isText(s.children[0])||""!==s.children[0].text)){i.YR.removeNodes(n,{at:d});return}if("component-block"===s.type){let t=e[s.component];if(t){let a={kind:"object",fields:t.schema},c=function e(t,n){if("child"===n.kind||"form"===n.kind)return t;if("conditional"===n.kind){let r=e(t.value,n.values[t.discriminant.toString()]);return r===t.value?t:{discriminant:t.discriminant,value:r}}if("array"===n.kind){let r=t.map(t=>e(t,n.element));return nX(t,r)?t:r}if("object"===n.kind){let r=!1,i={};for(let[l,o]of Object.entries(n.fields)){let n=t[l];if(void 0===n){r=!0,i[l]=nF(o);continue}let a=e(n,o);a!==n&&(r=!0),i[l]=a}return r?i:t}(0,o.vE)(n)}(s.props,a);if(c!==s.props){i.YR.setNodes(n,{props:c},{at:d});return}for(let[e,t]of function(e,t){let n=[];return function e(t,n,r,i=[]){if("form"===t.kind||"child"===t.kind){r(t,n,i);return}if("object"===t.kind){for(let[l,o]of Object.entries(t.fields))e(o,n[l],r,[...i,l]);r(t,n,i);return}if("array"===t.kind){for(let[l,o]of n.entries())e(t.element,o,r,i.concat(l));return r(t,n,i)}if("conditional"===t.kind){let l=n.discriminant;r(t,l,i.concat("discriminant")),e(t.values[l.toString()],n.value,r,i.concat("value")),r(t,n,i);return}(0,l.vE)(t)}(e,t,(e,t,r)=>{"array"===e.kind&&iU(e.element)&&n.push([r,e])}),n}(a,s.props)){if(1===s.children.length&&"component-inline-prop"===s.children[0].type&&void 0===s.children[0].propPath)break;let r=[];for(let[t,n]of s.children.entries())if(("component-block-prop"===n.type||"component-inline-prop"===n.type)&&void 0!==n.propPath){let i=n.propPath.concat();for(;i.length&&"number"!=typeof i.pop(););nX(e,i)&&r.push([t,n])}let c=nK(s.props,e),u=nE(c),h=new Set(u),p=new Set,f=[],m=[],g=()=>{let e=n$();for(;h.has(e);)e=n$();return e};for(let[,n]of r){let r=n.propPath[e.length];(0,o.hu)("number"==typeof r),c.length<=r||p.has(r)&&function(e){let t=e.children[0];return 1===e.children.length&&("component-inline-prop"===e.type&&void 0===t.type&&""===t.text||"component-block-prop"===e.type&&"paragraph"===t.type&&1===t.children.length&&void 0===t.children[0].type&&""===t.children[0].text)}(n)?(f.push(nF(t.element)),m.push(g())):(p.add(r),f.push(c[r]),m.push(p.has(r)?g():u[r]))}if(nL(f,m),!nX(c,f)){let t=function e(t,n,r,i){if(0===i.length)return r;let[o,...a]=i;if("object"===t.kind)return{...n,[o]:e(t.fields[o],n[o],r,a)};if("conditional"===t.kind)return(0,l.hu)("value"===o),{discriminant:n.discriminant,value:e(t.values[o],n.value,r,a)};if("array"===t.kind){let i=[...n];return nL(i,nE(n)),i[o]=e(t.element,i[o],r,a),i}(0,l.hu)("form"!==t.kind&&"child"!==t.kind),(0,l.vE)(t)}(a,s.props,f,e);for(let[l,[o,a]]of(i.YR.setNodes(n,{props:t},{at:d}),r.entries())){let t=[...a.propPath];t[e.length]=l,i.YR.setNodes(n,{propPath:t},{at:[...d,o]})}return}}let u=new Map(iH(s.props,t.schema).map(e=>[JSON.stringify(e.path),e.options.kind]));if(s.children.forEach(e=>{(0,o.hu)("component-block-prop"===e.type||"component-inline-prop"===e.type),u.delete(JSON.stringify(e.propPath))}),u.size){i.YR.insertNodes(n,[...u].map(([e,t])=>({type:`component-${t}-prop`,propPath:e?JSON.parse(e):e,children:[{text:""}]})),{at:[...d,s.children.length]});return}let h=new Set,p={};for(let[t,l]of(iH(s.props,e[s.component].schema).forEach((e,t)=>{p[JSON.stringify(e.path)]={options:e.options,index:t}}),s.children.entries())){if("component-inline-prop"!==l.type&&"component-block-prop"!==l.type)continue;let e=[...d,t],o=JSON.stringify(l.propPath);if(void 0===p[o]||h.has(o)){i.YR.removeNodes(n,{at:e});return}h.add(o);let a=p[o],s=a.index;if(t!==s){i.YR.moveNodes(n,{at:e,to:[...d,s]});return}let c=`component-${a.options.kind}-prop`;if(l.type!==c){i.YR.setNodes(n,{type:c},{at:e});return}let u=r(a.options);if(function e([t,n],r,l){let o=iV.get(l);if(o||(o=new WeakSet,iV.set(l,o)),o.has(t))return!1;let a=!1;if("inherit"!==l.inlineMarks&&i.xv.isText(t)&&(a=nG([t,n],r,l.inlineMarks,l.softBreaks)),i.W_.isElement(t)){let o=t.children.map((t,i)=>e([t,[...n,i]],r,l)).some(e=>e);"block"===l.kind?"component-block"===t.type?l.componentBlocks||(i.YR.unwrapNodes(r,{at:n}),a=!0):a=n0([t,n],r,l.documentFeatures)||o:a=nQ([t,n],r,l.documentFeatures.links)}return!1===a&&o.add(t),a}([l,e],n,u))return}}}a(t)},n}(n,t,function(e){let{isVoid:t}=e;return e.isVoid=e=>"divider"===e.type||"image"===e.type||t(e),e}(function(e){let{normalizeNode:t,deleteBackward:n}=e;return e.deleteBackward=t=>{if(e.selection&&i.e6.isCollapsed(e.selection)&&0===e.selection.anchor.offset){let[t,n]=i.ML.above(e,{match:e=>"layout-area"===e.type})||[e,[]];if("layout-area"===t.type&&i.E9.equals(i.ML.start(e,n),e.selection.anchor))return}n(t)},e.normalizeNode=n=>{let[r,l]=n;if(i.W_.isElement(r)&&"layout"===r.type){if(void 0===r.layout){i.YR.unwrapNodes(e,{at:l});return}if(r.children.length<r.layout.length){i.YR.insertNodes(e,Array.from({length:r.layout.length-r.children.length}).map(()=>({type:"layout-area",children:[lU()]})),{at:[...l,r.children.length]});return}if(r.children.length>r.layout.length){Array.from({length:r.children.length-r.layout.length}).map((e,t)=>t).reverse().forEach(t=>{let n=[...l,t+r.layout.length],o=r.children[t+r.layout.length];r8(e,n,[...l,r.layout.length-1,r.children[r.layout.length-1].children.length],e=>"paragraph"!==e.type||""!==i.NB.string(o)),i.YR.removeNodes(e,{at:n})});return}}t(n)},e}(function(e,t,n){let{insertBreak:r,normalizeNode:l,insertText:o}=n;function a(r){var l;if((null==r?void 0:r[0].type)!=="paragraph"||1!==r[0].children.length||void 0!==r[0].children[0].type)return!1;let o=lV.exec(r[0].children[0].text);if(!o)return!1;let a=r7(n,e,t);return(!a||"inline"!==a.kind&&!!a.documentFeatures.formatting.blockTypes.code)&&(n.history.undos.push({operations:[],selectionBefore:n.selection}),i.YR.select(n,r[1]),i.YR.delete(n),i.YR.wrapNodes(n,{type:"code",...o[1]?{language:null!==(l=M.b.get(o[1].toLowerCase()))&&void 0!==l?l:o[1]}:{},children:[]},{match:e=>"paragraph"===e.type}),!0)}return n.insertBreak=()=>{let e=i.ML.above(n,{match:rQ});if((null==e?void 0:e[0].type)==="code"&&i.xv.isText(e[0].children[0])){let t=e[0].children[0].text;if("\n"===t[t.length-1]&&n.selection&&i.e6.isCollapsed(n.selection)&&i.E9.equals(i.ML.end(n,e[1]),n.selection.anchor)){r(),i.YR.setNodes(n,{type:"paragraph",children:[]}),i.YR.delete(n,{distance:1,at:{path:[...e[1],0],offset:t.length-1}});return}n.insertText("\n");return}n.selection&&i.e6.isCollapsed(n.selection)&&a(e)||r()},n.insertText=e=>{o(e)," "===e&&n.selection&&i.e6.isCollapsed(n.selection)&&a(i.ML.above(n,{match:rQ}))},n.normalizeNode=([e,t])=>{if("code"===e.type&&i.W_.isElement(e))for(let[r,l]of e.children.entries()){if(!i.xv.isText(l)){n.isVoid(l)?i.YR.removeNodes(n,{at:[...t,r]}):i.YR.unwrapNodes(n,{at:[...t,r]});return}let e=Object.keys(l).filter(e=>"text"!==e);if(e.length){i.YR.unsetNodes(n,e,{at:[...t,r]});return}}l([e,t])},n}(t,n,function(e,t){let{normalizeNode:n}=t;return t.normalizeNode=([r,l])=>{i.xv.isText(r)?nG([r,l],t,e.formatting.inlineMarks,e.formatting.softBreaks):i.W_.isElement(r)&&n0([r,l],t,e),n([r,l])},t}(t,e))))))))))}function lG(e,[t,n],r){let l=t.type,o=rZ[l],a=i.NB.get(e,r),s=i.ML.isEditor(a)?"editor":a.type,d=rZ[s];if(!o||"unwrap"===o.invalidPositionHandleMode){if("blocks"===d.kind&&d.blockToWrapInlinesIn){i.YR.setNodes(e,{type:d.blockToWrapInlinesIn,...Object.fromEntries(Object.keys(t).filter(e=>"type"!==e&&"children"!==e).map(e=>[e,null]))},{at:n});return}i.YR.unwrapNodes(e,{at:n});return}let c=rZ[a.type||"editor"];if((null==c?void 0:c.kind)==="blocks"&&c.allowedChildren.has(l)){0===r.length?i.YR.moveNodes(e,{at:n,to:[n[0]+1]}):i.YR.moveNodes(e,{at:n,to:i.y$.next(r)});return}if(i.ML.isEditor(a)){i.YR.moveNodes(e,{at:n,to:[n[0]+1]}),i.YR.unwrapNodes(e,{at:[n[0]+1]});return}lG(e,[t,n],r.slice(0,-1))}function lQ(e){if(!e.selection)return{isInside:!1};let[,t]=i.ML.parent(e,e.selection);if(!t.length)return{isInside:!1};let[n,r]=i.ML.parent(e,t),l="blockquote"===n.type;return l?{isInside:!0,path:r}:{isInside:!1}}let l0={bold:["**","__"],italic:["*","_"],strikethrough:["~~"],code:["`"]};function l1(e){let t=e.parentElement,n=null==t?void 0:t.getAttribute("data-align");if("center"===n||"end"===n)return n;if(e instanceof HTMLElement){let t=e.style.textAlign;if("center"===t)return"center";if("right"===t||"end"===t)return"end"}}let l3={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6},l2={CODE:"code",DEL:"strikethrough",S:"strikethrough",STRIKE:"strikethrough",EM:"italic",I:"italic",STRONG:"bold",U:"underline",SUP:"superscript",SUB:"subscript",KBD:"keyboard"};function l6(e){if(!e.length)return[{text:""}];if(e.some(rQ)){let t=[],n=[],r=()=>{n.length&&(t.push({type:"paragraph",children:n}),n=[])};for(let l of e){if(rQ(l)){r(),t.push(l);continue}""!==i.NB.string(l).trim()&&n.push(l)}return r(),t}return e}let l8={mdastExtensions:[eF,eO],extensions:[eY,eT()()]};function l4(e){let t=e$()(e,l8),n=t.children;return 1===n.length&&"paragraph"===n[0].type&&(n=n[0].children),function e(t,n){let r=[];for(let i of t){let t=function(t,n){switch(t.type){case"blockquote":return[{type:"blockquote",children:e(t.children,n)}];case"link":return nD(t.url,()=>e(t.children,n));case"code":return[{type:"code",children:[{text:t.value}]}];case"paragraph":return[{type:"paragraph",children:e(t.children,n)}];case"heading":return[{type:"heading",level:t.depth,children:e(t.children,n)}];case"list":return[{type:t.ordered?"ordered-list":"unordered-list",children:e(t.children,n)}];case"listItem":return[{type:"list-item",children:e(t.children,n)}];case"thematicBreak":return[{type:"divider",children:[{text:""}]}];case"break":return nq("\n");case"delete":return nA("strikethrough",()=>e(t.children,n));case"strong":return nA("bold",()=>e(t.children,n));case"emphasis":return nA("italic",()=>e(t.children,n));case"inlineCode":return nA("code",()=>nq(t.value));case"text":return nq(t.value)}return nq(n.slice(t.position.start.offset,t.position.end.offset))}(i,n);t.length&&r.push(...t)}return r.length||r.push({text:""}),r}(n,e)}let l9=/https?:\/\//;function l7(e,t){rQ(t[0])?rC(e,t):i.YR.insertFragment(e,t)}let l5="x-keystatic-fragment",oe=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView||null,ot=e=>{let t=oe(e);return!!t&&e instanceof t.Node},on=e=>ot(e)&&3===e.nodeType,or=e=>ot(e)&&1===e.nodeType,oi=e=>{let t="";if(on(e)&&e.nodeValue)return e.nodeValue;if(or(e)){for(let n of Array.from(e.childNodes))t+=oi(n);let n=getComputedStyle(e).getPropertyValue("display");("block"===n||"list"===n||"BR"===e.tagName)&&(t+="\n")}return t},ol=/data-keystatic-fragment="(.+?)"/m,oo=e=>{let t=e.getData("text/html"),[,n]=t.match(ol)||[];return n},oa="$$keystaticUint8Array$$",os={"...":"","-->":"","->":"","<-":"","<--":"","--":""},od={"mod+b":"bold","mod+i":"italic","mod+u":"underline"},oc=new Map([["ArrowUp","up"],["ArrowDown","down"],["ArrowLeft","left"],["ArrowRight","right"]]),ou=(e,t)=>n=>{if(n.defaultPrevented)return;for(let r in od)if(t.formatting.inlineMarks[od[r]]&&(0,W.ZP)(r,n.nativeEvent)){n.preventDefault();let t=od[r],l=function(e,t){let n=i.ML.marks(e);if(null!=n&&n[t])return!0;for(let n of i.ML.nodes(e,{match:i.xv.isText}))if(n[0][t])return!0;return!1}(e,t);l?i.ML.removeMark(e,t):i.ML.addMark(e,t,!0);return}if((0,W.ZP)("mod+\\",n.nativeEvent)){r6(e);return}if(t.links&&(0,W.ZP)("mod+k",n.nativeEvent)){n.preventDefault(),iw(e,"");return}if("Tab"===n.key){let t=n.shiftKey?function(e){let t=i.ML.above(e,{match:rQ});return!!t&&"list-item-content"===t[0].type&&(i.YR.unwrapNodes(e,{match:ip,split:!0}),!0)}(e):function(e){let t=i.ML.above(e,{match:rQ});if(!t||"list-item-content"!==t[0].type)return!1;let n=i.y$.parent(t[1]);if(0===n[n.length-1])return!1;let r=i.y$.previous(n),l=i.NB.get(e,r);if(1!==l.children.length)return i.YR.moveNodes(e,{at:n,to:[...r,l.children.length-1,l.children[l.children.length-1].children.length]}),!0;let o=i.ML.parent(e,i.y$.parent(t[1]))[0].type;return i.ML.withoutNormalizing(e,()=>{i.YR.wrapNodes(e,{type:o,children:[]},{at:n}),i.YR.moveNodes(e,{to:[...r,l.children.length],at:n})}),!0}(e);if(t){n.preventDefault();return}}if("Tab"===n.key&&e.selection){let t=i.ML.above(e,{match:e=>"layout-area"===e.type||"table-cell"===e.type});if(t){let r=n.shiftKey?i.ML.before(e,t[1],{unit:"block"}):i.ML.after(e,t[1],{unit:"block"});i.YR.setSelection(e,{anchor:r,focus:r}),n.preventDefault()}}if((0,W.ZP)("mod+a",n)){let t=i.ML.above(e,{match:r9("table")});if(t){i.YR.select(e,t[1]),n.preventDefault();return}}let r=oc.get(n.key),{selection:l}=e;if(r&&l){let t=ld(e);if(t){var o,a;let s=null===(o=i.ML.above(e,{match:r9("table-cell"),at:l.focus.path}))||void 0===o?void 0:o[1],d=null===(a=i.ML.above(e,{match:r9("table-cell"),at:l.anchor.path}))||void 0===a?void 0:a[1];if(!s||!d)return;let c=function(e,t,n){if("left"===n||"right"===n){let r=i.ML.above(e,{match:r9("table-row"),at:t});if(!r)return;let l=t[t.length-1],o=l+("left"===n?-1:1),a=r[0].children[o];if(!a)return;return[...r[1],o]}let r=i.ML.above(e,{match:r9("table"),at:t});if(!r)return;let l=t[t.length-3]+t[t.length-2],o=ls("table-head"===r[0].children[0].type,l+("up"===n?-1:1));if(i.NB.has(r[0],o))return[...r[1],...o,t[t.length-1]]}(e,s,r);if(c){if("not-selected"===t.singleCell){if("up"!==r&&"down"!==r)return;let[t,o]=S.F3.toDOMPoint(e,l.focus),a=i.ML.above(e,{match:rQ,at:l.focus.path});if(!a||"up"===r&&a[1].slice(s.length).some(e=>0!==e))return;if("down"===r){let[t]=i.ML.parent(e,a[1]);if(t.children.length-1!==a[1][a[1].length-1])return;for(let[t,n]of i.NB.ancestors(e,a[1],{reverse:!0})){if("table-cell"===t.type)break;let[r]=i.ML.parent(e,n);if(r.children.length-1!==n[n.length-1])return}}let d=S.F3.toDOMNode(e,a[0]),u=document.createRange();u.selectNodeContents(d);let h=Array.from(u.getClientRects()),p=document.createRange();p.setStart(t,o),p.setEnd(t,o);let f=Array.from(p.getClientRects()),m=f[f.length-1],g="up"===r?"top":"bottom",v="top"===g?Math.min(...h.map(e=>e.top)):Math.max(...h.map(e=>e.bottom));if(m[g]===v){let t=i.ML["up"===r?"end":"start"](e,c);i.YR.select(e,{focus:t,anchor:n.shiftKey?l.anchor:t}),n.preventDefault()}return}if(!n.shiftKey)return;i.y$.equals(c,d)?i.YR.select(e,c):i.YR.select(e,{anchor:l.anchor,focus:i.ML.start(e,c)}),n.preventDefault()}}}};function oh({onChange:e,value:t,componentBlocks:n,documentFeatures:r,...l}){let o=rD(),d=(0,s.useMemo)(()=>{var e;return function(e){let{insertTextData:t}=e;return e.setFragmentData=t=>{!function(e,t){let{selection:n}=e;if(!n)return;let[r,l]=i.e6.edges(n),o=i.ML.void(e,{at:r.path}),s=i.ML.void(e,{at:l.path});if(i.e6.isCollapsed(n)&&!o)return;let d=S.F3.toDOMRange(e,n),c=d.cloneContents(),u=c.childNodes[0];if(c.childNodes.forEach(e=>{e.textContent&&""!==e.textContent.trim()&&(u=e)}),s){let[t]=s,n=d.cloneRange(),r=S.F3.toDOMNode(e,t);n.setEndAfter(r),c=n.cloneContents()}if(o&&(u=c.querySelector("[data-slate-spacer]")),Array.from(c.querySelectorAll("[data-slate-zero-width]")).forEach(e=>{let t="n"===e.getAttribute("data-slate-zero-width");e.textContent=t?"\n":""}),on(u)){let e=u.ownerDocument.createElement("span");e.style.whiteSpace="pre",e.appendChild(u),c.appendChild(e),u=e}let h=e.getFragment(),p=JSON.stringify(h,(e,t)=>t instanceof Uint8Array?{[oa]:(0,a.kZ)(t)}:t),f=window.btoa(encodeURIComponent(p));u.setAttribute("data-keystatic-fragment",f),t.setData(`application/${l5}`,f);let m=c.ownerDocument.createElement("div");m.appendChild(c),m.setAttribute("hidden","true"),c.ownerDocument.body.appendChild(m),t.setData("text/html",m.innerHTML),t.setData("text/plain",oi(m)),c.ownerDocument.body.removeChild(m)}(e,t)},e.insertFragmentData=t=>{let n=t.getData(`application/${l5}`)||oo(t);if(n){let t=decodeURIComponent(window.atob(n)),r=JSON.parse(t,(e,t)=>"object"==typeof t&&null!==t&&oa in t&&"string"==typeof t[oa]?(0,a._f)(t[oa]):t);return e.insertFragment(r),!0}return!1},e.insertTextData=n=>{let r=i.ML.above(e,{match:rQ});if((null==r?void 0:r[0].type)==="code"){let t=n.getData("text/plain");return e.insertText(t),!0}let l=n.getData("vscode-editor-data");if(l)try{let t=JSON.parse(l);if((null==t?void 0:t.mode)==="markdown"||(null==t?void 0:t.mode)==="mdx"){let t=n.getData("text/plain");if(t){let n=l4(t);return l7(e,n),!0}}}catch(e){console.log(e)}let o=n.getData("text/plain");if(l9.test(o)&&(0,M.i)(o)&&e.selection&&!i.e6.isCollapsed(e.selection)&&i.ML.above(e,{match:e=>rQ(e)&&!rQ(e.children[0])})&&i.ML.nodes(e,{match:e=>"link"===e.type}).next().done)return i.YR.wrapNodes(e,{type:"link",href:o,children:[]},{split:!0}),!0;let a=n.getData("text/html");if(a){let t=function(e){let t=new DOMParser().parseFromString(e,"text/html");return l6(function e(t){let n=[];for(let r of t)n.push(...function(t){if(!(t instanceof globalThis.HTMLElement)){let e=t.textContent;return e?nq(e):[]}if("BR"===t.nodeName)return nq("\n");if("IMG"===t.nodeName){let e=t.getAttribute("alt");return nq(null!=e?e:"")}if("HR"===t.nodeName)return[{type:"divider",children:[{text:""}]}];let n=function(e){let t=new Set,n=e.style,{nodeName:r}=e,i=l2[r];i&&t.add(i);let{fontWeight:l,textDecoration:o,verticalAlign:a}=n;return"underline"===o?t.add("underline"):"line-through"===o&&t.add("strikethrough"),"SPAN"===r&&e.classList.contains("code")&&t.add("code"),"B"===r&&"normal"!==l?t.add("bold"):"string"==typeof l&&("bold"===l||"bolder"===l||"1000"===l||/^[5-9]\d{2}$/.test(l))&&t.add("bold"),"italic"===n.fontStyle&&t.add("italic"),"super"===a?t.add("superscript"):"sub"===a&&t.add("subscript"),t}(t);return t.classList.contains("listtype-quote")?(n.delete("italic"),nW(n,()=>[{type:"blockquote",children:l6(e(t.childNodes))}])):nW(n,()=>{let{nodeName:n}=t;if("A"===n){let n=t.getAttribute("href");if(n)return nD(n,()=>(function(e,t){let n=nz.has(e);nz.add(e);try{return t()}finally{n||nz.delete(e)}})("underline",()=>e(t.childNodes)))}if("PRE"===n&&t.textContent)return[{type:"code",children:[{text:t.textContent||""}]}];let r=e(t.childNodes),i=l6(r);if("LI"===n){let e;let t={type:"list-item-content",children:i.filter(t=>void 0!==e||"ordered-list"!==t.type&&"unordered-list"!==t.type||(e=t,!1))},n=e?[t,e]:[t];return[{type:"list-item",children:n}]}if("P"===n)return[{type:"paragraph",textAlign:l1(t),children:i}];let l=l3[n];return"number"==typeof l?[{type:"heading",level:l,textAlign:l1(t),children:i}]:"BLOCKQUOTE"===n?[{type:"blockquote",children:i}]:"OL"===n?[{type:"ordered-list",children:i}]:"UL"===n?[{type:"unordered-list",children:i}]:"DIV"!==n||rQ(i[0])?r:[{type:"paragraph",children:i}]})}(r));return n}(t.body.childNodes))}(a);return l7(e,t),!0}if(o){let t=l4(o);return l7(e,t),!0}return t(n)},e}(function(e){let{insertData:t}=e;return e.insertData=n=>{let r=Array.from(n.files).filter(e=>e.type.startsWith("image/"));if(r.length){Promise.all(r.map(async e=>({name:e.name,data:new Uint8Array(await e.arrayBuffer())}))).then(t=>{rC(e,{type:"image",src:{content:t[0].data,filename:t[0].name},alt:"",title:"",children:[{text:""}]})});return}t(n)},e}(((e=function(e){let{normalizeNode:t,apply:n,insertText:r}=e;return e.normalizeNode=([n,r])=>{if(i.xv.isText(n)&&n.insertMenu){if("/"!==n.text[0]){i.YR.unsetNodes(e,"insertMenu",{at:r});return}let t=/\s/.exec(n.text);if(t){i.YR.unsetNodes(e,"insertMenu",{at:{anchor:{path:r,offset:t.index},focus:i.ML.end(e,r)},match:i.xv.isText,split:!0});return}}i.ML.isEditor(e)&&lW(e)||t([n,r])},e.apply=t=>{n(t),"set_selection"===t.type&&lW(e)},e.insertText=t=>{if(r(t),e.selection&&"/"===t){let t=i.ML.start(e,i.ML.above(e,{match:rQ})[1]),n=i.ML.before(e,e.selection.anchor,{unit:"character"});n&&(i.E9.equals(t,n)||0!==n.offset&&/\s/.test(i.NB.get(e,n.path).text[n.offset-1]))&&i.YR.setNodes(e,{insertMenu:!0},{at:{anchor:n,focus:e.selection.anchor},match:i.xv.isText,split:!0})}},e}(function(e){let{insertText:t}=e;return e.insertText=n=>{if(t(n)," "===n&&e.selection&&i.e6.isCollapsed(e.selection)){let t=e.selection.anchor,n=i.ML.above(e,{match:rQ});n&&Object.keys(os).forEach(r=>{let l=i.ML.before(e,t,{unit:"character",distance:r.length+1});if(l&&i.y$.isDescendant(l.path,n[1])){let n={anchor:t,focus:l},o=i.ML.string(e,n);o.slice(0,r.length)===r&&(e.history.undos.push({operations:[],selectionBefore:e.selection}),i.YR.select(e,n),e.insertText(os[r]+" "))}})}},e}(function(e){let{insertBreak:t}=e;return e.insertBreak=()=>{t();let n=i.ML.above(e,{match:e=>"heading"===e.type});if(!n||!e.selection||!i.e6.isCollapsed(e.selection))return;let r=n[1];if(i.E9.equals(i.ML.end(e,r),e.selection.anchor)){i.YR.unwrapNodes(e,{at:r});return}if(!i.y$.hasPrevious(r))return;let l=i.y$.previous(r),o=i.NB.get(e,l);"heading"===o.type&&1===o.children.length&&i.xv.isText(o.children[0])&&""===o.children[0].text&&i.YR.unwrapNodes(e,{at:l})},e}(function(e){let{insertBreak:t,deleteBackward:n}=e;return e.deleteBackward=t=>{if(e.selection){let t=lQ(e);if(t.isInside&&i.e6.isCollapsed(e.selection)&&0===e.selection.anchor.offset&&0===e.selection.anchor.path[e.selection.anchor.path.length-2]){i.YR.unwrapNodes(e,{match:e=>"blockquote"===e.type,split:!0});return}}n(t)},e.insertBreak=()=>{let n=lQ(e);if(e.selection&&n.isInside){let[t,r]=i.ML.node(e,e.selection);if(i.y$.isDescendant(r,n.path)&&""===i.NB.string(t)){i.YR.unwrapNodes(e,{match:e=>"blockquote"===e.type,split:!0});return}}t()},e}(function(e,t,n){let{insertText:r,insertBreak:l}=n;n.insertBreak=()=>{l();let e=i.ML.marks(n);if(!e||!n.selection)return;let t=i.ML.above(n,{match:rQ});if(!t)return;let r=r4(n,n.selection.anchor),o=Object.keys(e);if(!r||!i.y$.isDescendant(r.path,t[1])){for(let e of o)n.removeMark(e);return}let a=i.NB.get(n,r.path);for(let e of o)a[e]||n.removeMark(e)};let o={},a=e.formatting.inlineMarks;return Object.keys(l0).forEach(e=>{a[e]&&(o[e]=l0[e])}),0===Object.keys(o).length||(n.insertText=l=>{if(r(l),n.selection&&i.e6.isCollapsed(n.selection)){for(let[r,a]of Object.entries(o))for(let o of a)if(l===o[o.length-1]){let l=i.ML.start(n,i.ML.above(n,{match:rQ})[1]),a=i.ML.string(n,{anchor:n.selection.anchor,focus:l}),s=/\s/.test(a.slice(-o.length-1,-o.length)),d=o===a.slice(-o.length);if(s||!d)continue;let c=a.slice(0,-o.length-1);for(let[a]of[...c].reverse().entries()){let s=c.slice(a,a+o.length);if(s!==o)continue;let d=0===a?l:r4(n,l,{distance:a}),u=i.ML.after(n,d,{distance:o.length});if(0!==a&&!/\s/.test(i.ML.string(n,{anchor:i.ML.before(n,d,{unit:"character"}),focus:d})))continue;let h=i.ML.string(n,{anchor:u,focus:n.selection.anchor}).slice(0,-o.length);if(""===h||/\s/.test(h[0])||"italic"===r&&("_"===h[0]||"*"===h[0])||"code"===r&&"`"===h)continue;let p=r7(n,e,t);if(!p||"inherit"===p.inlineMarks||!1!==p.inlineMarks[r]){!function(e,t,n,r){e.history.undos.push({operations:[],selectionBefore:e.selection});let l=i.ML.pointRef(e,r);i.YR.delete(e,{at:e.selection.anchor,distance:n.length,reverse:!0}),i.YR.delete(e,{at:r,distance:n.length}),i.YR.setNodes(e,{[t]:!0},{match:i.xv.isText,split:!0,at:{anchor:l.unref(),focus:e.selection.anchor}}),e.removeMark(t)}(n,r,o,d);return}}}}}),n}(r,n,function(e,t,n){let{insertText:r}=n,l=Object.create(null),o={...e},a=(e,t,n,r="paragraph")=>{if(!n(o))return;let i=e[e.length-1];l[i]||(l[i]=Object.create(null)),l[i][e]={insert:t,type:r,shouldBeEnabledInComponentBlock:n}};return a("1. ",()=>{i.YR.wrapNodes(n,{type:"ordered-list",children:[]},{match:rQ})},e=>e.formatting.listTypes.ordered),a("- ",()=>{i.YR.wrapNodes(n,{type:"unordered-list",children:[]},{match:rQ})},e=>e.formatting.listTypes.unordered),a("* ",()=>{i.YR.wrapNodes(n,{type:"unordered-list",children:[]},{match:rQ})},e=>e.formatting.listTypes.unordered),e.formatting.headings.levels.forEach(e=>{a("#".repeat(e)+" ",()=>{i.YR.setNodes(n,{type:"heading",level:e},{match:e=>"paragraph"===e.type||"heading"===e.type})},t=>t.formatting.headings.levels.includes(e),"heading-or-paragraph")}),a("> ",()=>{i.YR.wrapNodes(n,{type:"blockquote",children:[]},{match:e=>"paragraph"===e.type})},e=>e.formatting.blockTypes.blockquote),a("---",()=>{iQ(n)},e=>e.dividers),n.insertText=o=>{r(o);let a=l[o];if(a&&n.selection&&i.e6.isCollapsed(n.selection)){let{anchor:r}=n.selection,l=i.ML.above(n,{match:rQ});if(!l||"paragraph"!==l[0].type&&"heading"!==l[0].type)return;let o=i.ML.start(n,l[1]),s={anchor:r,focus:o},d=i.ML.string(n,s),c=a[d];if(!c||"paragraph"===c.type&&"paragraph"!==l[0].type)return;let u=r7(n,e,t);if(u&&("inline"===u.kind||!c.shouldBeEnabledInComponentBlock(u.documentFeatures)))return;n.history.undos.push({operations:[],selectionBefore:n.selection}),i.YR.select(n,s),i.YR.delete(n),c.insert()}},n}(r,n,lX((0,eE.VC)((0,S.BU)((0,i.Jh)())),r,n)))))))).insertSoftBreak=()=>{i.YR.insertText(e,"\n")},e)))},[r,n]);return(0,c.jsx)("div",{"data-layout":o,className:(0,N.AK)((0,N.iv)({backgroundColor:N.iK.color.background.canvas,minWidth:0,'&[data-layout="main"]':{flex:1,display:"flex",flexDirection:"column"},'&:not([data-layout="main"])':{border:`${N.iK.size.border.regular} solid ${N.iK.color.border.neutral}`,borderRadius:N.iK.size.radius.medium}}),"keystar-document-editor"),children:(0,c.jsxs)(om,{componentBlocks:n,documentFeatures:r,editor:d,value:t,onChange:t=>{null==e||e(t);let n=window.getSelection();if(n&&!S.F3.isFocused(d)){let e=S.F3.toDOMNode(d,d);n.anchorNode===e&&S.F3.focus(d)}},children:[(0,s.useMemo)(()=>void 0!==e&&(0,c.jsx)(lS,{documentFeatures:r}),[r,e]),(0,c.jsx)(og,{...l,readOnly:void 0===e}),!1]})})}let op=(0,s.createContext)(!1);function of(){return(0,s.useContext)(op)}function om({children:e,editor:t,onChange:n,value:r,componentBlocks:i,documentFeatures:l}){let o=(0,s.useMemo)(()=>Math.random().toString(36),[t]);return(0,c.jsx)(op.Provider,{value:!0,children:(0,c.jsx)(S.mH,{editor:t,value:r,onChange:e=>{n(e);let r=window.getSelection();if(r&&!S.F3.isFocused(t)){let e=S.F3.toDOMNode(t,t);r.anchorNode===e&&S.F3.focus(t)}},children:(0,c.jsx)(lf,{children:(0,c.jsx)(ik,{componentBlocks:i,editorDocumentFeatures:l,children:e})})},o)})}function og(e){let t=nc(),n=rD(),r=(0,S.ui)(),{componentBlocks:l,documentFeatures:o}=ix(),a=(0,s.useMemo)(()=>ou(r,o),[r,o]);return(0,c.jsx)(il,{editor:r,children:(0,c.jsx)(f.Mr,{size:"main"===n?"medium":"regular",children:(0,c.jsx)(S.CX,{placeholder:'Start writing or press "/" for commands...',decorate:(0,s.useCallback)(([e,t])=>{let n=[];if("component-block"===e.type){if(1===e.children.length&&i.W_.isElement(e.children[0])&&"component-inline-prop"===e.children[0].type&&void 0===e.children[0].propPath)return n;e.children.forEach((o,a)=>{if(""===i.NB.string(o)&&i.W_.isElement(o)&&("component-block-prop"===o.type||"component-inline-prop"===o.type)&&void 0!==o.propPath){let s=i.ML.start(r,[...t,a]),d=function(e,t,n){let r=r1(e,n,t);return(null==r?void 0:r.kind)==="child"?r.options.placeholder:""}(o.propPath,l[e.component].schema,e.props);d&&n.push({placeholder:d,anchor:s,focus:s})}})}if("code"===e.type&&1===e.children.length&&void 0===e.children[0].type&&e.language&&e.language in M.P.languages){let r=[...t,0],i=M.P.tokenize(e.children[0].text,M.P.languages[e.language]);!function e(t,i){for(let l of i){let i=function e(t){return"string"==typeof t?t.length:Array.isArray(t.content)?t.content.reduce((t,n)=>t+e(n),0):e(t.content)}(l),o=t+i;"string"!=typeof l&&(n.push({["prism_"+l.type]:!0,anchor:{path:r,offset:t},focus:{path:r,offset:o}}),e(t,Array.isArray(l.content)?l.content:[l.content])),t=o}}(0,i)}return n},[r,l]),onKeyDown:a,renderElement:lB,renderLeaf:lH,...e,...(0,N.a9)({container:t,layout:n}),className:(0,N.AK)(oy,e.className)})})})}let ov={flex:1,height:"auto",minHeight:N.iK.size.scale[2e3],minWidth:0,padding:N.iK.size.space.medium,'&[data-layout="main"]':{boxSizing:"border-box",height:"100%",padding:0,paddingTop:N.iK.size.space.medium,minHeight:0,minWidth:0,maxWidth:800,marginInline:"auto",[N.l0.above.mobile]:{padding:N.iK.size.space.xlarge},[N.l0.above.tablet]:{padding:N.iK.size.space.xxlarge},'&[data-container="wide"]':{padding:N.iK.size.scale[600]}}},oy=(0,N.iv)({...ov,a:{color:N.iK.color.foreground.accent}}),ob=0;function ox(e){let t=rD(),[n,r]=(0,s.useState)(()=>({key:ob++,value:e.value}));n.value!==e.value&&r({key:ob++,value:e.value});let i={label:e.label,description:e.description};return"main"===t&&(i={"aria-label":e.label}),(0,c.jsx)(u.gN,{height:"main"===t?"100%":void 0,...i,children:t=>(0,s.createElement)(oh,{...t,key:n.key,componentBlocks:e.componentBlocks,documentFeatures:e.documentFeatures,onChange:t=>{r(e=>({key:e.key,value:t})),e.onChange(t)},value:n.value})})}let ok=new TextEncoder,oj=new TextDecoder,ow=ra({label:"Alt text",description:"This text will be used by screen readers and search engines."}),oM=nR({Input:()=>null,defaultValue:()=>"",parse(e){if(void 0===e)return"";if("string"!=typeof e)throw new nN("Must be string");return e},validate:e=>e,serialize:e=>({value:e})});function oN({label:e,componentBlocks:t={},description:n,...l}){let o=function(e){var t,n,r,i,l,o,a,s,d,c,u,h,p,f,m,g,v,y;let b=!0===e.formatting?{blockTypes:!0,headingLevels:!0,inlineMarks:!0,listTypes:!0,softBreaks:!0}:null!==(t=e.formatting)&&void 0!==t?t:{},x=!0===e.images?{}:e.images;return{formatting:{alignment:!0===b.alignment?{center:!0,end:!0}:{center:!!(null!==(n=b.alignment)&&void 0!==n&&n.center),end:!!(null!==(r=b.alignment)&&void 0!==r&&r.end)},blockTypes:(null==b?void 0:b.blockTypes)===!0?{blockquote:!0,code:{schema:tp({})}}:{blockquote:!!(null!==(i=b.blockTypes)&&void 0!==i&&i.blockquote),code:(e=>{if((null===(e=b.blockTypes)||void 0===e?void 0:e.code)===void 0)return!1;if(!0===b.blockTypes.code||!b.blockTypes.code.schema)return{schema:tp({})};for(let e of["type","children","language"])if(e in b.blockTypes.code.schema)throw Error(`"${e}" cannot be a key in the schema for code blocks`);return{schema:tp(b.blockTypes.code.schema)}})()},headings:(e=>{let t=null==b?void 0:b.headingLevels,n="object"==typeof t&&"levels"in t?t:{levels:t,schema:void 0};if(n.schema){for(let e of["type","children","level","textAlign"])if(e in n.schema)throw Error(`"${e}" cannot be a key in the schema for headings`)}return{levels:[...new Set(!0===n.levels?[1,2,3,4,5,6]:n.levels)],schema:tp(null!==(e=n.schema)&&void 0!==e?e:{})}})(),inlineMarks:!0===b.inlineMarks?{bold:!0,code:!0,italic:!0,keyboard:!1,strikethrough:!0,subscript:!1,superscript:!1,underline:!1}:{bold:!!(null!==(l=b.inlineMarks)&&void 0!==l&&l.bold),code:!!(null!==(o=b.inlineMarks)&&void 0!==o&&o.code),italic:!!(null!==(a=b.inlineMarks)&&void 0!==a&&a.italic),strikethrough:!!(null!==(s=b.inlineMarks)&&void 0!==s&&s.strikethrough),underline:!!(null!==(d=b.inlineMarks)&&void 0!==d&&d.underline),keyboard:!!(null!==(c=b.inlineMarks)&&void 0!==c&&c.keyboard),subscript:!!(null!==(u=b.inlineMarks)&&void 0!==u&&u.subscript),superscript:!!(null!==(h=b.inlineMarks)&&void 0!==h&&h.superscript)},listTypes:!0===b.listTypes?{ordered:!0,unordered:!0}:{ordered:!!(null!==(p=b.listTypes)&&void 0!==p&&p.ordered),unordered:!!(null!==(f=b.listTypes)&&void 0!==f&&f.unordered)},softBreaks:!!b.softBreaks},links:!!e.links,layouts:[...new Set((e.layouts||[]).map(e=>JSON.stringify(e)))].map(e=>JSON.parse(e)),dividers:!!e.dividers,images:void 0!==x&&{...x,schema:{alt:null!==(m=null===(g=x.schema)||void 0===g?void 0:g.alt)&&void 0!==m?m:ow,title:null!==(v=null===(y=x.schema)||void 0===y?void 0:y.title)&&void 0!==v?v:oM}},tables:!!e.tables}}(l),a=e=>(n,l)=>{let a=oj.decode(l.content),s=function(e,t){let n=e.children.flatMap(e=>(function e(t,n){var r,i;if("blockquote"===t.type)return{type:"blockquote",children:t.children.flatMap(t=>e(t,n))};if("fence"===t.type){let{language:e,content:n,...r}=t.attributes;return{type:"code",children:[{text:n.replace(/\n$/,"")}],..."string"==typeof e?{language:e}:{},...r}}if("heading"===t.type)return{...t.attributes,level:t.attributes.level,type:"heading",children:nZ(t.children)};if("list"===t.type)return{type:t.attributes.ordered?"ordered-list":"unordered-list",children:t.children.flatMap(t=>e(t,n))};if("item"===t.type){let i=[{type:"list-item-content",children:nZ([t.children[0]])}];if((null===(r=t.children[1])||void 0===r?void 0:r.type)==="list"){let r=t.children[1];i.push({type:r.attributes.ordered?"ordered-list":"unordered-list",children:r.children.flatMap(t=>e(t,n))})}return{type:"list-item",children:i}}if("paragraph"===t.type){if(1===t.children.length&&"inline"===t.children[0].type&&1===t.children[0].children.length&&"image"===t.children[0].children[0].type){let e=t.children[0].children[0];return{type:"image",src:decodeURI(e.attributes.src),alt:e.attributes.alt,title:null!==(i=e.attributes.title)&&void 0!==i?i:"",children:[{text:""}]}}let e=nZ(t.children);return 1===e.length&&"component-inline-prop"===e[0].type?e[0]:{type:"paragraph",children:e,textAlign:t.attributes.textAlign}}if("hr"===t.type)return{type:"divider",children:[{text:""}]};if("table"===t.type)return{type:"table",children:t.children.flatMap(t=>e(t,n))};if("tbody"===t.type)return{type:"table-body",children:t.children.flatMap(t=>e(t,n))};if("thead"===t.type)return t.children.length?{type:"table-head",children:t.children.flatMap(t=>e(t,n))}:[];if("tr"===t.type)return{type:"table-row",children:t.children.flatMap(t=>e(t,n))};if("td"===t.type)return{type:"table-cell",children:t.children.flatMap(t=>e(t,n))};if("th"===t.type)return{type:"table-cell",header:!0,children:t.children.flatMap(t=>e(t,n))};if("tag"===t.type){if("table"===t.tag)return e(t.children[0],n);if("layout"===t.tag)return{type:"layout",layout:t.attributes.layout,children:t.children.flatMap(t=>e(t,n))};if("layout-area"===t.tag)return{type:"layout-area",children:t.children.flatMap(t=>e(t,n))};if("component-block"===t.tag)return{type:"component-block",component:t.attributes.component,props:t.attributes.props,children:0===t.children.length?[{type:"component-inline-prop",children:[{text:""}]}]:t.children.flatMap(t=>e(t,n))};if("component-block-prop"===t.tag&&Array.isArray(t.attributes.propPath)&&t.attributes.propPath.every(e=>"string"==typeof e||"number"==typeof e))return{type:"component-block-prop",children:t.children.flatMap(t=>e(t,n)),propPath:t.attributes.propPath};if(t.tag){let r=n[t.tag];if(r){let i=nH({kind:"object",fields:r.schema});if(i){let r=JSON.parse(JSON.stringify(t.attributes)),l=[];return function t(n,r,i,l,o,a){if("child"===l.kind){let t=n.flatMap(t=>e(t,a));r.push({type:`component-${l.options.kind}-prop`,propPath:[...o,...l.relativePath],children:t})}if("array"===l.kind){let e=[];for(let[i,s]of n.entries()){if("paragraph"===s.type&&(s=s.children[0].children[0]),"tag"!==s.type)throw Error(`expected tag ${l.asChildTag}, found type: ${s.type}`);if(s.tag!==l.asChildTag)throw Error(`expected tag ${l.asChildTag}, found tag: ${s.tag}`);let n=JSON.parse(JSON.stringify(s.attributes));l.child&&t(s.children,r,n,l.child,[...o,...l.relativePath,i],a),e.push(n)}let s=l.relativePath[l.relativePath.length-1],d=nK(i,l.relativePath.slice(0,-1));d[s]=e}}(t.children,l,r,i,[],n),{type:"component-block",component:t.tag,props:r,children:l}}return{type:"component-block",component:t.tag,props:t.attributes,children:0===t.children.length?[{type:"component-inline-prop",children:[{text:""}]}]:t.children.flatMap(t=>e(t,n))}}}throw Error(`Unknown tag: ${t.tag}`)}return nV(t)})(e,t));return 0===n.length?[{type:"paragraph",children:[{text:""}]}]:("paragraph"!==n[n.length-1].type&&n.push({type:"paragraph",children:[{text:""}]}),n)}(r.ZP.parse(a),t),d=lX((0,i.Jh)(),o,t);return d.children=s,i.ML.normalize(d,{force:!0}),function e(t,n,r,i,l,o,a){return t.map(t=>{var s;if("component-block"===t.type){let e=n[t.component];if(!e)return t;let o=tp(e.schema);return{...t,props:nT(o,t.props,{form:(e,t)=>{if("asset"===e.formKind){var n;if("read"===l)return e.reader.parse(t);let o=e.filename(t,{slug:a,suggestedFilenamePrefix:void 0});return e.parse(t,{asset:o?e.directory?null===(n=i.get(e.directory))||void 0===n?void 0:n.get(o):r.get(o):void 0,slug:a})}if("content"===e.formKind)throw Error("Not implemented");return"read"===l?e.reader.parse(t):e.parse(t,void 0)}})}}if("image"===t.type&&"string"==typeof t.src&&"edit"===l){let e=n3(o,a),n=t.src.slice(e.length),l=null===(s="object"==typeof o.images&&"string"==typeof o.images.directory?i.get(eA(o.images.directory)):r)||void 0===s?void 0:s.get(n);return l?{type:"image",src:{filename:n,content:l},alt:t.alt,title:t.title,children:[{text:""}]}:{type:"paragraph",children:[{text:`Missing image ${n}`}]}}if("string"==typeof t.type){let s=e(t.children,n,r,i,l,o,a);return{...t,children:s}}return t})}(d.children,t,l.other,l.external||new Map,e,o,l.slug)};return{kind:"form",formKind:"content",defaultValue:()=>[{type:"paragraph",children:[{text:""}]}],Input:r=>(0,c.jsx)(ox,{componentBlocks:t,description:n,label:e,documentFeatures:o,...r}),parse:a("edit"),contentExtension:".mdoc",validate:e=>e,directories:[...td(tp(Object.fromEntries(Object.entries(t).map(([e,t])=>[e,tp(t.schema)])))),..."object"==typeof o.images&&"string"==typeof o.images.directory?[o.images.directory]:[]],serialize(e,n){let{extraFiles:i,node:l}=function(e,t){let n=[],i={...t,extraFiles:n},l=new r.wS.Node("document",{},e.flatMap(e=>(function e(t,n){if("paragraph"===t.type){let e=new r.wS.Node("paragraph",t.textAlign?{textAlign:t.textAlign}:{},[n8(t.children)]);return t.textAlign&&e.annotations.push({name:"textAlign",value:t.textAlign,type:"attribute"}),e}if("image"===t.type)return n.extraFiles.push({contents:t.src.content,path:t.src.filename,parent:"object"==typeof n.documentFeatures.images&&"string"==typeof n.documentFeatures.images.directory?eA(n.documentFeatures.images.directory):void 0}),new r.wS.Node("paragraph",{},[new r.wS.Node("inline",{},[new r.wS.Node("image",{src:encodeURI(`${n3(n.documentFeatures,n.slug)}${t.src.filename}`),alt:t.alt,title:t.title})])]);if("code"===t.type){let e={},{children:i,language:l,type:o,...a}=t,s="object"==typeof n.documentFeatures.formatting.blockTypes.code?n.documentFeatures.formatting.blockTypes.code.schema:void 0;if(s&&Object.keys(s.fields).length>0){let t=n2(nY(s,a),s,void 0,n.slug,!1);Object.assign(e,t.value),n.extraFiles.push(...t.extraFiles)}let d=i[0].text+"\n",c=new r.wS.Node("fence",{content:d,language:l,...e},[new r.wS.Node("text",{content:d})]);for(let[t,n]of Object.entries(e))c.annotations.push({name:t,value:n,type:"attribute"});return c}let i=t=>e(t,n);if("blockquote"===t.type)return new r.wS.Node("blockquote",{},t.children.map(i));if("divider"===t.type)return new r.wS.Node("hr");if("table"===t.type){let e=t.children.find(e=>"table-head"===e.type);return new r.wS.Node("tag",{},[new r.wS.Node("table",{},[new r.wS.Node("thead",{},e?e.children.map(i):[]),i(t.children.find(e=>"table-body"===e.type))])],"table")}if("table-body"===t.type)return new r.wS.Node("tbody",{},t.children.map(i));if("table-row"===t.type)return new r.wS.Node("tr",{},t.children.map(i));if("table-cell"===t.type)return new r.wS.Node(t.header?"th":"td",{},t.children.map(i));if("heading"===t.type){let e={};t.textAlign&&(e.textAlign=t.textAlign);let{children:i,level:l,textAlign:o,type:a,...s}=t,d=n.documentFeatures.formatting.headings.schema;Object.keys(d.fields).length>0&&Object.assign(e,n2(nY(d,s),d,void 0,n.slug,!1).value);let c=new r.wS.Node("heading",{level:t.level,...e},[n8(t.children)]);for(let[t,n]of Object.entries(e))c.annotations.push({name:t,value:n,type:"attribute"});return c}if("ordered-list"===t.type)return new r.wS.Node("list",{ordered:!0},t.children.map(i));if("unordered-list"===t.type)return new r.wS.Node("list",{ordered:!1},t.children.map(i));if("layout"===t.type)return new r.wS.Node("tag",{layout:t.layout},t.children.map(i),"layout");if("layout-area"===t.type)return new r.wS.Node("tag",{},t.children.flatMap(i),"layout-area");if("component-block"===t.type){let e=1===t.children.length&&"component-inline-prop"===t.children[0].type&&void 0===t.children[0].propPath,l=n.componentBlocks[t.component],o=[];for(let e of t.children)("component-block-prop"===e.type||"component-inline-prop"===e.type)&&void 0!==e.propPath&&o.push({type:e.type,propPath:e.propPath,children:"component-block-prop"===e.type?e.children.flatMap(i):[n8(e.children)]});let a=t.props;if(l){let e=n2(t.props,{kind:"object",fields:l.schema},void 0,n.slug,!1);a=e.value,n.extraFiles.push(...e.extraFiles);let i=nH({kind:"object",fields:l.schema});if(i){let e=[];return!function e(t,n,i,l){if("child"===l.kind){let e=t.find(e=>nX(e.propPath,l.relativePath));e&&n.push(...e.children);return}if("array"===l.kind){let o=l.relativePath[l.relativePath.length-1],a=nK(i,l.relativePath.slice(0,-1)),s=a[o];delete a[o];let d=new Map;for(let e of t){let t=e.propPath.slice(l.relativePath.length+1),n=e.propPath[l.relativePath.length];void 0===d.get(n)&&d.set(n,[]),d.get(n).push({children:e.children,propPath:t})}n.push(...s.map((t,n)=>{var i;let o=null!==(i=d.get(n))&&void 0!==i?i:[],a=[];return e(o,a,t,l.child),new r.wS.Node("tag",t,a,l.asChildTag)}))}}(o,e,a,i),new r.wS.Node("tag",a,e,t.component)}}let s=e?[]:o.map(e=>new r.wS.Node("tag",{propPath:e.propPath},e.children,e.type));return new r.wS.Node("tag",a,s,t.component)}if("component-block-prop"===t.type||"component-inline-prop"===t.type)return new r.wS.Node("tag",{propPath:t.propPath},"component-inline-prop"===t.type?[n8(t.children)]:t.children.flatMap(i),t.type);if("list-item"===t.type){let i=t.children[0];if("list-item-content"!==i.type)throw Error("list item content must contain a list-item-content");let l=n8(i.children),o=[l],a=t.children[1];return a&&o.push(e(a,n)),new r.wS.Node("item",{},o)}if("list-item-content"===t.type)throw Error("list-item-content in unexpected position");throw Error(`unexpected node type: ${t.type}`)})(e,i)));return{node:l,extraFiles:n}}(e,{componentBlocks:t,documentFeatures:o,slug:n.slug}),a=new Map,s=new Map;for(let e of i){if(void 0===e.parent){a.set(e.path,e.contents);continue}s.has(e.parent)||s.set(e.parent,new Map),s.get(e.parent).set(e.path,e.contents)}return{content:ok.encode(r.ZP.format(r.ZP.parse(r.ZP.format(l)))),other:a,external:s,value:void 0}},reader:{parse:a("read")}}}}}]);